{"version":3,"sources":["webpack:///webpack/bootstrap c2e42c7c6abad7c58cd6","webpack:///./config/config.js","webpack:///./component/WSManager.js","webpack:///./style/style.js","webpack:///./component/SheetEventHandler.js","webpack:///./component/Cell.js","webpack:///./component/SheetRender.js","webpack:///./component/ToolEventBinder.js","webpack:///./app.js","webpack:///./component/CellRender.js","webpack:///./component/Sheet.js","webpack:///./component/SheetEventBinder.js","webpack:///./component/SliderBarRender.js","webpack:///./component/Tool.js","webpack:///./component/ToolEventHandler.js","webpack:///./component/ToolRender.js","webpack:///./component/UndoStack.js","webpack:///./component/WSRender.js","webpack:///./component/Workspace.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC5MA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oC;;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB,UAAU;AACV,SAAS;AACT,aAAa;AACb,cAAc;;AAEd;AACA,qBAAqB;AACrB,SAAS;AACT,UAAU;AACV,cAAc;AACd;;AAEA,yCAAyC;;AAEzC;AACA,wBAAwB;AACxB,cAAc;AACd,cAAc;AACd,iBAAiB;AACjB,eAAe;AACf;;AAEA;AACA,wBAAwB;AACxB,qBAAqB;AACrB,WAAW;AACX,SAAS;AACT,WAAW;AACX,eAAe;AACf,yBAAyB;AACzB,4BAA4B;;AAE5B,oCAAoC;AACpC,mCAAmC;;AAEnC;AACA,kBAAkB;AAClB,eAAe;AACf,yBAAyB;AACzB,cAAc;AACd,eAAe;AACf,sBAAsB;AACtB,eAAe;AACf,oBAAoB;AACpB,qBAAqB;AACrB,eAAe;AACf,oBAAoB;AACpB,kBAAkB;AAClB,4BAA4B;;AAE5B;AACA,kBAAkB;AAClB,eAAe;AACf,0BAA0B;AAC1B,cAAc;AACd,eAAe;AACf,sBAAsB;AACtB,cAAc;AACd,oBAAoB;AACpB,qBAAqB;AACrB,eAAe;AACf,oBAAoB;AACpB,kBAAkB;AAClB,4BAA4B;;AAE5B;AACA,qBAAqB;AACrB,eAAe;AACf,yBAAyB;AACzB,0BAA0B;;AAE1B;AACA,gBAAgB;AAChB;;AAEA;AACA,eAAe;AACf,oBAAoB;AACpB,aAAa;AACb,YAAY;AACZ,YAAY;AACZ,0BAA0B;;AAE1B;AACA;;AAEA;;AAEA;AACA,aAAa;AACb,cAAc;AACd,oBAAoB;AACpB;;AAEA;AACA,wBAAwB;AACxB,eAAe;AACf,sBAAsB;AACtB,oBAAoB;AACpB,kBAAkB;AAClB;AACA,gCAAgC;AAChC,sBAAsB;;AAEtB;AACA,wBAAwB;AACxB,eAAe;AACf,uBAAuB;AACvB,qBAAqB;AACrB,kBAAkB;AAClB,uBAAuB;AACvB,yBAAyB;AACzB,gCAAgC;;AAEhC;AACA,cAAc;AACd,cAAc;AACd,yBAAyB;AACzB;AACA,mBAAmB;;AAEnB;AACA,wBAAwB;AACxB,eAAe;AACf,kBAAkB;AAClB,uBAAuB;AACvB,cAAc;AACd,oBAAoB;AACpB,oBAAoB;AACpB;;AAEA;AACA,wBAAwB;AACxB,eAAe;AACf,kBAAkB;AAClB,uBAAuB;AACvB,cAAc;AACd,oBAAoB;AACpB,oBAAoB;AACpB;;AAEA;;AAEA;AACA,kBAAkB;AAClB,oBAAoB;AACpB,qBAAqB;AACrB,kBAAkB;AAClB,eAAe;AACf,cAAc;AACd,eAAe;AACf,yBAAyB;;AAEzB;AACA,kBAAkB;AAClB,oBAAoB;AACpB,qBAAqB;AACrB,kBAAkB;AAClB,eAAe;AACf,cAAc;AACd,eAAe;AACf,yBAAyB;;AAEzB;AACA,gBAAgB;AAChB,qBAAqB;AACrB,eAAe;AACf,yBAAyB;AACzB,0BAA0B;AAC1B,eAAe;;AAEf;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,8C;;;;;;ACzOA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wBAAwB;AAChE,4CAA4C,wBAAwB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,wBAAwB;AAC5E;AACA,wDAAwD,wBAAwB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,cAAc;AACjD;AACA,uCAAuC,eAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,wBAAwB;AAC5E;AACA,wDAAwD,wBAAwB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,oD;;;;;;ACveA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,0B;;;;;;AClDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA,cAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,oBAAoB,wBAAwB;AACpF;AACA;AACA;;AAEA;AACA,0CAA0C,WAAW,UAAU,aAAa;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA,wC;;;;;;AC7LA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,gD;;;;;;AClLA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0B;;;;;;ACvBA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sC;;;;;;ACrKA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,wBAAwB;AAC5E,wDAAwD,wBAAwB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,wBAAwB;AAC5E,wDAAwD,wBAAwB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAkC,WAAW;AAC7C,sCAAsC,WAAW;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,wBAAwB;AACxE,oDAAoD,wBAAwB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,wBAAwB;AACxE,oDAAoD,wBAAwB;AAC5E;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA,gDAAgD,wBAAwB;AACxE,oDAAoD,wBAAwB;AAC5E;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,wBAAwB;AAC5D,wCAAwC,wBAAwB;AAChE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,4B;;;;;;ACnZA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kD;;;;;;AC1DA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;;AAGA,gD;;;;;;AChGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,0B;;;;;;ACZA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,sBAAsB;AAClF;AACA;AACA;AACA;AACA,8DAA8D,aAAa;AAC3E;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA,oDAAoD,kCAAkC,EAAE,OAAO;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wBAAwB;AACpE,gDAAgD,wBAAwB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wBAAwB;AACpE,gDAAgD,wBAAwB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wBAAwB;AACpE,gDAAgD,wBAAwB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wBAAwB;AACpE,gDAAgD,wBAAwB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,kD;;;;;;AC7oBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,gCAAgC;AAC7C,YAAY,+BAA+B;AAC3C,YAAY;AACZ;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA,iBAAiB,sBAAsB;;AAEvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,EAAE;;AAEF,iBAAiB,qBAAqB;;AAEtC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF,iBAAiB,qBAAqB;;AAEtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,YAAY,uBAAuB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,YAAY,yBAAyB;AACrC;AACA,kBAAkB,yBAAyB;AAC3C;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,YAAY,sBAAsB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,YAAY,wBAAwB;AACpC;AACA,kBAAkB,wBAAwB;AAC1C;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAkB,UAAU;AAC5B;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,sC;;;;;;ACzZA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kC;;;;;;ACnDA;AACA;AACA,UAAU;AACV;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c2e42c7c6abad7c58cd6","/**\r\n * 配置文件，主要是个各类属性默认值\r\n * 整张表命名为：WorkSpace\r\n * 表格上半部分叫做：Tool\r\n * 表格叫做：Sheet\r\n *\r\n */\r\n\r\n/**\r\n * 整张表-WorkSpace的属性默认值\r\n *\r\n */\r\nvar WSConfig = {\r\n    isInit: true\r\n}\r\n\r\n/**\r\n * 表头-Tool的属性默认值\r\n *\r\n */\r\nvar ToolConfig = {\r\n    height: '12%',\r\n    width: '100%',\r\n\r\n    cmdCodeMap: {\r\n        borderAll: '&#xe228', borderBottom: '&#xe229', borderClear: '&#xe22a',\r\n        borderLeft: '&#xe22e', borderOuter: '&#xe22f', borderRight: '&#xe230',\r\n        borderTop: \"&#xe232\", mergeCell: '&#xe252', splitCell: '&#xe0b6',\r\n        copy: '&#xe14d', cut: '&#xe14e', paste: '&#xe14f', find: '&#xe881',\r\n        font: '&#xe167', alignCenter: '&#xe234', alignLeft: '&#xe236', alignRight: '&#xe237',\r\n        bold: '&#xe238', italic: '&#xe23f', fillColor: '&#xe23a', textColor: '&#xe23c',\r\n        brush: '&#xe243', underline: '&#xe249', sigma: '&#xe24a', func: '&#xe940',\r\n        preview: '&#xe8f4', sort: '&#xe164', wrapText: '&#xe25b', undo: '&#xe967', redo: '&#xe968',\r\n        cleanText: '清除文字', cleanStyle: '清除格式', cleanAll: '清除文字和格式', multiLine: '多行输入',\r\n        addCol: '插列', addRow: '插列', menu: '&#xe3c7', close: '&#xe5cd'\r\n    },\r\n    styleHtml: ['font', 'bold', 'italic', 'textColor', 'fillColor', 'align', 'border', 'brush', 'cleanText',\r\n        'cleanStyle', 'cleanAll'],\r\n    toolHtml: ['copy', 'paste', 'cut', 'sort', 'find', 'wrapText', 'func', 'sigma', 'mergeCell', 'splitCell',\r\n        'multiLine', 'addCol','addRow'],\r\n    dataHtml: ['数据源', '数据集', 'Init'],\r\n    defaultHtml: ['undo', 'redo', 'preview'],\r\n    borderHtml: ['borderAll', 'borderBottom', 'borderTop', 'borderClear', 'borderLeft', 'borderOuter', 'borderRight'],\r\n    alignHtml: ['alignLeft', 'alignCenter', 'alignRight'],\r\n    previewHtml: ['Edit', 'Down'],\r\n    fontBorderOption: {\r\n        borderLeft: 'left',\r\n        borderTop: 'top',\r\n        borderRight: 'right',\r\n        borderBottom: 'bottom',\r\n        borderClear: 'clear',\r\n        borderOuter: 'outer',\r\n        borderAll: 'all'\r\n    },\r\n    alignOption: {\r\n        alignLeft: 'left',\r\n        alignCenter: 'center',\r\n        alignRight: 'right'\r\n    },\r\n\r\n    menu: ['样式', '工具', '数据']\r\n}\r\n\r\n/**\r\n * 侧边栏-sliderBar的常量\r\n *\r\n * */\r\nvar SlideBarConfig = {\r\n    toggleOpenIcon: 'open',\r\n    toggleCloseIcon: 'close',\r\n\r\n    iconHtmlMap: {\r\n\t\topen: '&#xe3c7',\r\n        close: '&#xe5cd'\r\n    }\r\n}\r\n\r\n/**\r\n * 表单-Cell的属性默认值\r\n *\r\n */\r\nvar CellConfig = {\r\n    height: 20,\r\n    width: 100\r\n}\r\n\r\n/**\r\n * 表单-Sheet的属性默认值\r\n *\r\n */\r\nvar SheetConfig = {\r\n    headWidth: 30,\r\n    headHeight: 25,\r\n\r\n    rowNum: 100,\r\n    colNum: 25\r\n}\r\n\r\nvar CellPropConfig = {\r\n    id: 'cellProp'\r\n}\r\n\r\nvar InputConfig = {\r\n    id: 'input'\r\n}\r\n\r\nvar ClipBoardConfig = {\r\n    id: 'ta',\r\n    value: ''\r\n}\r\nvar keyboardTables = {\r\n\r\n    specialKeysCommon: {\r\n        8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n        35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n        46: \"[del]\", 113: \"[f2]\"\r\n    },\r\n\r\n    specialKeysIE: {\r\n        8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n        35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n        46: \"[del]\", 113: \"[f2]\"\r\n    },\r\n\r\n    controlKeysIE: {\r\n        67: \"[ctrl-c]\",\r\n        83: \"[ctrl-s]\",\r\n        86: \"[ctrl-v]\",\r\n        88: \"[ctrl-x]\",\r\n        90: \"[ctrl-z]\"\r\n    },\r\n\r\n    specialKeysOpera: {\r\n        8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n        35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n        45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n        46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n        113: \"[f2]\"\r\n    },\r\n\r\n    controlKeysOpera: {\r\n        67: \"[ctrl-c]\",\r\n        83: \"[ctrl-s]\",\r\n        86: \"[ctrl-v]\",\r\n        88: \"[ctrl-x]\",\r\n        90: \"[ctrl-z]\"\r\n    },\r\n\r\n    specialKeysSafari: {\r\n        8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n        63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n        63277: \"[pgdn]\", 63237: \"[f2]\"\r\n    },\r\n\r\n    controlKeysSafari: {\r\n        99: \"[ctrl-c]\",\r\n        115: \"[ctrl-s]\",\r\n        118: \"[ctrl-v]\",\r\n        120: \"[ctrl-x]\",\r\n        122: \"[ctrl-z]\"\r\n    },\r\n\r\n    ignoreKeysSafari: {\r\n        63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n        63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n    },\r\n\r\n    specialKeysFirefox: {\r\n        8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n        35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n        46: \"[del]\", 113: \"[f2]\"\r\n    },\r\n\r\n    controlKeysFirefox: {\r\n        99: \"[ctrl-c]\",\r\n        115: \"[ctrl-s]\",\r\n        118: \"[ctrl-v]\",\r\n        120: \"[ctrl-x]\",\r\n        122: \"[ctrl-z]\"\r\n    },\r\n\r\n    ignoreKeysFirefox: {\r\n        16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n        91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n        117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n        144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n    }\r\n}\r\n/**\r\n * 公式类型\r\n * @type {[*]}\r\n */\r\n// var function_classlist= [\"all\", \"stat\", \"lookup\", \"datetime\", \"financial\", \"test\", \"math\", \"text\"]\r\n/**\r\n * 输出模块\r\n *\r\n */\r\nmodule.exports.WSConfig = WSConfig\r\nmodule.exports.ToolConfig = ToolConfig\r\nmodule.exports.SheetConfig = SheetConfig\r\nmodule.exports.CellConfig = CellConfig\r\nmodule.exports.CellPropConfig = CellPropConfig\r\nmodule.exports.InputConfig = InputConfig\r\nmodule.exports.ClipBoardConfig = ClipBoardConfig\r\nmodule.exports.SlideBarConfig = SlideBarConfig\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/config.js\n// module id = 0\n// module chunks = 0","/**\r\n * 整体工作管理对象\r\n * @constructor\r\n */\r\nvar config = require('config')\r\nvar WSManager = function () {\r\n}\r\n\r\nWSManager.prototype.init = function (parentNode) {\r\n\r\n\t//实例化初始化Tool对象\r\n\tvar ToolModule = require('Tool')\r\n\tvar Tool = ToolModule.Tool\r\n\tvar tool = new Tool()\r\n\r\n\t//实例化初始化UndoStack对象\r\n\tvar UndoStackModule = require('UndoStack')\r\n\tvar UndoStack = UndoStackModule.UndoStack\r\n\tvar undoStack = new UndoStack()\r\n\r\n\t//实例化初始化Sheet对象\r\n\tvar SheetModule = require('Sheet')\r\n\tvar Sheet = SheetModule.Sheet\r\n\tvar sheet = new Sheet(undoStack)\r\n\r\n\t//实例化初始化SliderBar对象\r\n\t// var SliderBarModule = require('SliderBar')\r\n\r\n\t//实例化初始化Workspace对象\r\n\tvar WorkspaceModule = require('Workspace')\r\n\tvar Workspace = WorkspaceModule.Workspace\r\n\tthis.workspace = new Workspace(tool, sheet)\r\n\r\n\t//实例化初始化WSRender对象\r\n\tvar WSRenderModule = require('WSRender')\r\n\tvar WSRender = WSRenderModule.WSRender\r\n\tvar wsRender = new WSRender(this, parentNode)\r\n\r\n\twsRender.init()\r\n\r\n\tif (config.WSConfig.isInit && parentNode.getAttribute(\"url\")) {\r\n\t\tdocument.getElementById(\"Init\").onclick()\r\n\t\tconfig.WSConfig.isInit = false\r\n\t}\r\n}\r\n\r\nmodule.exports.WSManager = WSManager\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSManager.js\n// module id = 1\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/8.\r\n */\r\n/**\r\n * 样式常量类\r\n *\r\n * 存储各种默认样式\r\n * 以及后续要添加的主题样式\r\n *\r\n * 注意，大多数宽与高，是成员属性，写在config里面\r\n */\r\n\r\nvar config = require('config')\r\nvar WSConfig = config.WSConfig\r\nvar SheetConfig = config.SheetConfig\r\nvar ToolConfig = config.ToolConfig\r\n\r\nvar WSStyle =\r\n\t'position: absolute;' +\r\n\t'left: 0;' +\r\n\t'top: 0;' +\r\n\t'width:100%;' +\r\n\t'height:100%;'\r\n\r\nvar SheetDivStyle =\r\n\t'position: relative;' +\r\n\t'top: 0;' +\r\n\t'left: 0;' +\r\n\t'width: 100%;' +\r\n\t'height: 87%'\r\n\r\nvar SheetTableStyle = 'user-select: none;'\r\n\r\nvar SheetTableDivStyle =\r\n\t'display: inline-block;' +\r\n\t'height:100%;' +\r\n\t'width: 100%;' +\r\n\t'overflow: auto;' +\r\n\t'border: none;' +\r\n\t'transition: all 0.5s ease'\r\n\r\nvar SliderBarStyle =\r\n\t'display: inline-block;' +\r\n\t'position: relative;' +\r\n\t'right :0;' +\r\n\t'top: 0;' +\r\n\t'width: 0;' +\r\n\t'height: 100%;' +\r\n\t'background-color: gray;' +\r\n\t'transition: all 0.5s ease;'\r\n\r\nvar ToggleDivCloseLeft = 'left: 95%;'\r\nvar ToggleDivOpenLeft = 'left: 76%;'\r\n\r\nvar ToggleDivStyle =\r\n\t'position: fixed;' +\r\n\t'bottom: 20px;' +\r\n\t'background-color: gray;' +\r\n\t'width: 40px;' +\r\n\t'height: 40px;' +\r\n\t'border-radius: 20px;' +\r\n\t'color: white;' +\r\n\t'line-height: 40px;' +\r\n\t'text-align: center;' +\r\n\t'z-index: 100;' +\r\n\t'user-select: none;' +\r\n\t'cursor: pointer;' +\r\n\t'transition: all 0.5s ease;'\r\n\r\nvar ToggleDivHoverStyle =\r\n\t'position: fixed;' +\r\n\t'bottom: 20px;' +\r\n\t'background-color: white;' +\r\n\t'width: 40px;' +\r\n\t'height: 40px;' +\r\n\t'border-radius: 20px;' +\r\n\t'color: gray;' +\r\n\t'line-height: 40px;' +\r\n\t'text-align: center;' +\r\n\t'z-index: 100;' +\r\n\t'user-select: none;' +\r\n\t'cursor: pointer;' +\r\n\t'transition: all 0.5s ease;'\r\n\r\nvar CellPropDivStyle =\r\n\t'position: absolute;' +\r\n\t'z-index: 100;' +\r\n\t'background-color: #fff;' +\r\n\t'border: 1px solid black;'\r\n\r\nvar InputStyle =\r\n\t'display: none;' +\r\n\t'position: absolute'\r\n\r\nvar ClipBoardStyle =\r\n\t'display:none;' +\r\n\t'position:absolute;' +\r\n\t'height:1px;' +\r\n\t'width:1px;' +\r\n\t'opacity:0;' +\r\n\t'filter:alpha(opacity=0);'\r\n\r\nvar SpanStyle =\r\n\t''\r\n\r\nvar ToolStyle = ''\r\n\r\nvar MenuDivStyle =\r\n\t'height:37%; ' +\r\n\t'width: 100%;' +\r\n\t'line-height: 30px;' +\r\n\t'min-height: 28px'\r\n\r\nvar MenuBoxStyle =\r\n\t'display: inline-block; ' +\r\n\t'height: 100%; ' +\r\n\t'letter-spacing: 7px; ' +\r\n\t'padding-left: 7px; ' +\r\n\t'cursor: pointer; ' +\r\n\t'transition: all 0.1s'+\r\n\t'background-color: transparent; ' +\r\n\t'border-bottom: none;'\r\n\r\nvar MenuBoxSelectedStyle =\r\n\t'display: inline-block; ' +\r\n\t'height: 100%; ' +\r\n\t'letter-spacing: 10px; ' +\r\n\t'padding-left: 10px; ' +\r\n\t'cursor: pointer; ' +\r\n\t'transition: all 0.1s; ' +\r\n\t'background-color: #ddd; ' +\r\n\t'border-bottom: solid 2px grey;'\r\n\r\nvar ButtonBoxStyle =\r\n\t'height: 63%;' +\r\n\t'width: 100%;' +\r\n\t'background-color: #ddd;' +\r\n\t'line-height: 50px' +\r\n\t'min-height: 50px;'\r\n\r\nvar ButtonDivStyle =\r\n\t'display: inline-block;' +\r\n\t'height: 50px;' +\r\n\t'cursor: pointer;' +\r\n\t'transition: all 0.1s;' +\r\n\t'color: #333;' +\r\n\t'line-height: 50px;' +\r\n\t'margin-left: 20px;' +\r\n\t'font-size: 20px'\r\n\r\nvar ButtonDivSelectedStyle =\r\n\t'display: inline-block;' +\r\n\t'height: 50px;' +\r\n\t'cursor: pointer;' +\r\n\t'transition: all 0.1s;' +\r\n\t'color: #fff;' +\r\n\t'line-height: 50px;' +\r\n\t'margin-left: 20px;' +\r\n\t'font-size: 20px'\r\n\r\nvar CellStyle = ''\r\n\r\nvar ColorDivStyle =\r\n\t'display: inline; ' +\r\n\t'margin-left: 10px; ' +\r\n\t'padding-left: 15px; ' +\r\n\t'cursor: pointer; ' +\r\n\t'border: none; ' +\r\n\t'width: 15px; ' +\r\n\t'height: 15px; ' +\r\n\t'background-color: #fff;'\r\n\r\nvar backgroundColorDivStyle =\r\n\t'display: inline; ' +\r\n\t'margin-left: 10px; ' +\r\n\t'padding-left: 15px; ' +\r\n\t'cursor: pointer; ' +\r\n\t'border: none; ' +\r\n\t'width: 15px; ' +\r\n\t'height: 15px; ' +\r\n\t'background-color: #fff;'\r\n\r\nvar ColorSelectDivStyle =\r\n\t'display: none;' +\r\n\t'position: absolute;' +\r\n\t'z-index: 100;' +\r\n\t'background-color: #fff;' +\r\n\t'border: 1px solid black;' +\r\n\t'width: 106px;'\r\n\r\nmodule.exports.WSStyle = WSStyle\r\n\r\nmodule.exports.SheetDivStyle = SheetDivStyle\r\n\r\nmodule.exports.SheetTableStyle = SheetTableStyle\r\n\r\nmodule.exports.SheetTableDivStyle = SheetTableDivStyle\r\n\r\nmodule.exports.ToggleDivOpenLeft = ToggleDivOpenLeft\r\nmodule.exports.ToggleDivCloseLeft = ToggleDivCloseLeft\r\nmodule.exports.ToggleDivStyle =  ToggleDivStyle\r\nmodule.exports.ToggleDivHoverStyle = ToggleDivHoverStyle\r\n\r\nmodule.exports.CellPropDivStyle = CellPropDivStyle\r\n\r\nmodule.exports.InputStyle = InputStyle\r\n\r\nmodule.exports.ToolStyle = ToolStyle\r\n\r\nmodule.exports.MeunDivStyle = MenuDivStyle\r\n\r\nmodule.exports.MeunBoxStyle = MenuBoxStyle\r\n\r\nmodule.exports.MeunBoxSelectedStyle = MenuBoxSelectedStyle\r\n\r\nmodule.exports.CellStyle = CellStyle\r\n\r\nmodule.exports.ClipBoardStyle = ClipBoardStyle\r\n\r\nmodule.exports.ButtonBoxStyle = ButtonBoxStyle\r\n\r\nmodule.exports.ButtonDivStyle = ButtonDivStyle\r\n\r\nmodule.exports.ButtonDivSelectedStyle = ButtonDivSelectedStyle\r\n\r\nmodule.exports.SpanStyle = SpanStyle\r\n\r\nmodule.exports.ColorDivStyle = ColorDivStyle\r\n\r\nmodule.exports.backgroundColorDivStyle = backgroundColorDivStyle\r\n\r\nmodule.exports.ColorSelectDivStyle = ColorSelectDivStyle\r\n\r\nmodule.exports.SliderBarStyle = SliderBarStyle\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/style.js\n// module id = 2\n// module chunks = 0","//鼠标和键盘事件\r\n\r\n// var UtilModule=require('Util')\r\n// var Util=UtilModule.Util\r\n// var util=new Util()\r\n\r\nvar SheetRenderModule = require('SheetRender')\r\nvar SheetRender = SheetRenderModule.SheetRender\r\n\r\nvar SheetEventHandler = function (sheet) {\r\n\r\n    this.sheet = sheet\r\n    this.sheetRender = new SheetRender(sheet)\r\n}\r\n/**\r\n * 鼠标按下事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseDown = function (elementid) {\r\n    //var cellPropDiv=document.getElementById(\"cellProp\")\r\n    //cellPropDiv.style.display='none'\r\n    //cellPropDiv.innerHTML=''\r\n    if (!this.sheet.isEditing) {\r\n        //if (!this.sheet.firstCellid) {\r\n        this.sheet.firstCellid = elementid\r\n        this.sheet.lastCellid = this.sheet.firstCellid\r\n    }\r\n\r\n        this.setCellBackgroundColor('#fff')\r\n        if (elementid) {\r\n            //setCellProp(element,this.sheet.cells[element.id])\r\n            this.sheet.firstCellid = elementid\r\n        }\r\n    document.getElementById('dragBar').style.display = 'none'\r\n    this.sheet.isMouseDown = true\r\n}\r\nSheetEventHandler.prototype.dragBarMouseDown = function () {\r\n    this.setCellBackgroundColor('#fff')\r\n    this.sheet.firstCellid = this.sheet.lastCellid\r\n    this.sheet.isDraging = true\r\n}\r\n/**\r\n * 鼠标移动事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseMove = function (elementid) {\r\n    this.setCellBackgroundColor('#fff')\r\n    if (elementid) {\r\n        //var cellPropDiv=document.getElementById(\"cellProp\")\r\n        //cellPropDiv.style.display='none'\r\n        //cellPropDiv.innerHTML=''\r\n        this.sheet.lastCellid = elementid\r\n        this.sheet.editCells = this.sheet.getColAndRow()\r\n        if(this.sheet.isDraging) this.setCellBackgroundColor('#f69')\r\n        else this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\n/**\r\n * 鼠标抬起事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseUp = function (element) {\r\n    if(this.sheet.isDraging){\r\n        if(!this.sheet.cells[this.sheet.firstCellid]){\r\n            this.sheet.setAttr('content','')\r\n        }else{\r\n            this.sheet.setAttr('content',this.sheet.cells[this.sheet.firstCellid].content)\r\n        }\r\n\r\n        this.sheet.render()\r\n    }\r\n    if (this.sheet.isMouseDown || this.sheet.isDraging) {\r\n        if (element.id) {\r\n            var dragBar = document.getElementById('dragBar')\r\n            dragBar.style.left = getLeft(element) +  element.offsetWidth -8+ 'px'\r\n            dragBar.style.top = getTop(element) +element.offsetHeight-8+ 'px'\r\n            dragBar.style.display = 'block'\r\n            this.sheet.lastCellid = element.id\r\n            this.sheet.editCells = this.sheet.getColAndRow()\r\n            this.setCellBackgroundColor('#69f')\r\n\r\n        }\r\n    }\r\n    this.sheet.isMouseDown = false\r\n    this.sheet.isDraging = false\r\n}\r\nSheetEventHandler.prototype.dragBarMouseUp = function () {\r\n    this.setCellBackgroundColor('#69f')\r\n    this.sheet.isMouseDown = false\r\n    this.sheet.isDraging = false\r\n}\r\n/**\r\n * 鼠标双击事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.dblclick = function (element) {\r\n    if (element.id) {\r\n        var input = document.getElementById('input')\r\n        input.style.display = 'block'\r\n        input.style.backgroundColor = '#efe'\r\n        input.style.left = getLeft(element) + 'px'\r\n        input.style.top = getTop(element) + 'px'\r\n        input.style.height = element.offsetHeight + 'px'\r\n        input.style.width = element.offsetWidth + 'px'\r\n        if (this.sheet.cells[element.id]) {\r\n            input.value = this.sheet.cells[element.id].content\r\n        }\r\n        else {\r\n            input.value = ''\r\n        }\r\n        input.focus()\r\n        this.sheet.isEditing = true\r\n        this.sheet.isMouseDown = false\r\n    }\r\n}\r\nSheetEventHandler.prototype.inputBlur = function () {\r\n    this.sheet.isEditing = false\r\n    var input = document.getElementById('input')\r\n    input.blur()\r\n    input.style.display = 'none'\r\n    //var ele = this.sheet.lastCell\r\n    if (input.value) {\r\n        this.sheet.setAttr('content', input.value)\r\n        this.sheet.render()\r\n        // var sp = document.getElementById('sp')\r\n        // sp.value = input.value\r\n        // sp.style.font = ele.firstChild.style.font\r\n        // sp.style.fontSize = ele.firstChild.style.fontSize\r\n        // this.sheet.cells[ele.id].viewWidth = sp.offsetWidth\r\n        // if(this.sheet.cells[ele.id].autoLF){\r\n        //     ele.width = this.sheet.cells[ele.id].width\r\n        // }else{\r\n        //     ele.width = this.sheet.cells[ele.id].viewWidth\r\n        // }\r\n    }\r\n    this.sheet.isEditing = false\r\n}\r\nSheetEventHandler.prototype.inputFocus = function () {\r\n    this.sheet.isEditing = true\r\n    var input = document.getElementById('input')\r\n    input.focus()\r\n}\r\n// //鼠标失去焦点事件\r\n// SheetEventHandler.prototype.mouseBlur=function(element){\r\n//     element.style.color='transparent'\r\n//     element.style.background='transparent'\r\n//     if(config.WSConfig.isKeyDown){\r\n//         var value=element.value\r\n//         if(element.nextSibling.innerHTML==''&&value!=''){\r\n//             var command = 'set '+ element.id + ' ' + value\r\n//             var type = 'set'\r\n//             this.sheet.UndoStack.pushCommand(command,type)\r\n//         }\r\n//         element.nextSibling.innerHTML=value\r\n//     }\r\n//     config.WSConfig.isKeyDown=true\r\n//     element.parentNode.style.backgroundColor = 'transparent'\r\n// }\r\n/**\r\n * 设置单元格背景颜色\r\n * @param backgroundColor\r\n */\r\nSheetEventHandler.prototype.setCellBackgroundColor = function (backgroundColor) {\r\n    var cells = this.sheet.editCells\r\n    if (cells != null) {\r\n        for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n            for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                var ele = document.getElementById(String.fromCharCode(i) + '_' + j)\r\n                if (ele) {\r\n                    if (backgroundColor == '#fff'\r\n                        && this.sheet.cells[ele.id] != undefined\r\n                        && this.sheet.cells[ele.id].backgroundColor != undefined) {\r\n                        ele.style.backgroundColor = this.sheet.cells[ele.id].backgroundColor\r\n                    } else {\r\n                        ele.style.backgroundColor = backgroundColor\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 键盘按下事件\r\n * @param element\r\n * @param event\r\n */\r\nSheetEventHandler.prototype.keyDown = function (event) {\r\n    if (!this.sheet.isMultiLineEditing) {\r\n        var col = this.sheet.editCells.lastCellCol//element.id.split('_')[0].charCodeAt(0)\r\n        var row = this.sheet.editCells.lastCellRow//parseInt(element.id.split('_')[1])\r\n        //console.log(event.which)\r\n        switch (event.which) {\r\n            case 37://左键\r\n                do {\r\n                    col = col - 1\r\n                } while (this.sheet.cells[String.fromCharCode(col) + '_' + row] && !this.sheet.cells[String.fromCharCode(col) + '_' + row].show)\r\n                if (!this.sheet.isEditing && col > 64) {\r\n                    var cellid = String.fromCharCode(col) + '_' + row\r\n\r\n                    this.mouseDown(cellid)\r\n                    this.mouseUp(document.getElementById(cellid))\r\n\r\n                }\r\n                return false\r\n            case 38://上键\r\n                do {\r\n                    row = row - 1\r\n                } while (this.sheet.cells[String.fromCharCode(col) + '_' + row] && !this.sheet.cells[String.fromCharCode(col) + '_' + row].show)\r\n                var cellid = String.fromCharCode(col) + '_' + row\r\n\r\n                if (this.sheet.isEditing) {\r\n                    this.sheet.isEditing = false\r\n                    document.getElementById('input').blur()\r\n                }\r\n                if(row > 0){\r\n                    this.mouseDown(cellid)\r\n                    this.mouseUp(document.getElementById(cellid))\r\n                }\r\n                return false\r\n            case 39://右键\r\n                do {\r\n                    col = col + 1\r\n                } while (this.sheet.cells[String.fromCharCode(col) + '_' + row] && !this.sheet.cells[String.fromCharCode(col) + '_' + row].show)\r\n                if (!this.sheet.isEditing) {\r\n                    var cellid = String.fromCharCode(col) + '_' + row\r\n                    if (document.getElementById(cellid)) {\r\n                        this.mouseDown(cellid)\r\n                        this.mouseUp(document.getElementById(cellid))\r\n                    }\r\n                }\r\n                return false\r\n            case 40://下键\r\n                do {\r\n                    row = row + 1\r\n                } while (this.sheet.cells[String.fromCharCode(col) + '_' + row] && !this.sheet.cells[String.fromCharCode(col) + '_' + row].show)\r\n                var cellid = String.fromCharCode(col) + '_' + row\r\n                if (document.getElementById(cellid)) {\r\n                    if (this.sheet.isEditing) {\r\n                        this.sheet.isEditing = false\r\n                        document.getElementById('input').blur()\r\n                    }\r\n                    this.mouseDown(cellid)\r\n                    this.mouseUp(document.getElementById(cellid))\r\n                }\r\n                return false\r\n            case 17://ctrl\r\n                break\r\n            case 18://alt\r\n                break\r\n            case 67://ctrl+c\r\n                var ta = document.getElementById('ta')\r\n                var text = ''\r\n                //var firstCell=this.sheet.firstCell\r\n                //var lastCell=this.sheet.lastCell\r\n                var cells = this.sheet.getColAndRow()\r\n                if (cells != null) {\r\n                    var rowCount = 0\r\n                    for (var i = cells.firstCellRow; i <= cells.lastCellRow; i++) {\r\n                        var colCount = 0\r\n                        for (var j = cells.firstCellCol; j <= cells.lastCellCol; j++) {\r\n                            var eleOld = document.getElementById(\r\n                                String.fromCharCode(j)\r\n                                + '_' + i)\r\n                            text += eleOld.firstChild.innerHTML + '\\t'\r\n                            colCount++\r\n                        }\r\n                        text = text.substr(0, text.length - 1)\r\n                        text += '\\n'\r\n                        rowCount++\r\n                    }\r\n                    text = text.substr(0, text.length - 1)\r\n                }\r\n                ta.value = text\r\n                ta.style.display = 'block'\r\n                ta.focus()\r\n                ta.select()\r\n\r\n                window.setTimeout(function () {\r\n                    ta.style.display = 'none'\r\n                    var cell = document.getElementById(col + '_' + row)\r\n                    //cell.focus()\r\n                }, 200)\r\n\r\n                break\r\n            case 86://ctrl+v\r\n                var ta = document.getElementById('ta')\r\n                ta.style.display = 'block'\r\n                ta.focus()\r\n                ta.select()\r\n                var sheet = this.sheet\r\n                window.setTimeout(function () {\r\n                    ta.blur()\r\n                    var v = ta.value\r\n                    ta.style.display = 'none'\r\n                    v = v.split('\\n')\r\n                    for (var i = 0; i < v.length; i++) {\r\n                        var vv = v[i].split('\\t')\r\n                        for (var j = 0; j < vv.length; j++) {\r\n                            var cvCol = col + j\r\n                            var cvRow = row + i\r\n                            var cells = {}\r\n                            cells.firstCellCol = cvCol\r\n                            cells.firstCellRow = cvRow\r\n                            cells.lastCellCol = cvCol\r\n                            cells.lastCellRow = cvRow\r\n                            sheet.setAttr('content', vv[j], cells)\r\n                        }\r\n                    }\r\n                    var cell = document.getElementById(String.fromCharCode(col) + '_' + row)\r\n                    cell.focus()\r\n                    sheet.render()\r\n                }, 200)\r\n\r\n                this.sheet.isKeyDown = false\r\n                break\r\n            case 88://ctrl+x\r\n                var ta = document.getElementById('ta')\r\n                var text = ''\r\n                //var firstCell=this.sheet.firstCell\r\n                //var lastCell=this.sheet.lastCell\r\n                var cells = this.sheet.getColAndRow()\r\n                if (cells != null) {\r\n                    var rowCount = 0\r\n                    for (var i = cells.firstCellRow; i <= cells.lastCellRow; i++) {\r\n                        var colCount = 0\r\n                        for (var j = cells.firstCellCol; j <= cells.lastCellCol; j++) {\r\n                            var eleOld = document.getElementById(\r\n                                String.fromCharCode(j)\r\n                                + '_' + i)\r\n                            text += eleOld.firstChild.innerHTML + '\\t'\r\n                            colCount++\r\n                        }\r\n                        text = text.substr(0, text.length - 1)\r\n                        text += '\\n'\r\n                        rowCount++\r\n                    }\r\n                    text = text.substr(0, text.length - 1)\r\n                }\r\n                ta.value = text\r\n                ta.style.display = 'block'\r\n                ta.focus()\r\n                ta.select()\r\n\r\n                window.setTimeout(function () {\r\n                    ta.style.display = 'none'\r\n                    var cell = document.getElementById(String.fromCharCode(col) + '_' + row)\r\n                    cell.focus()\r\n                }, 200)\r\n\r\n                this.sheet.setAttr('content', '')\r\n                this.sheet.render()\r\n                break\r\n            case 8://backspace\r\n                this.sheet.setAttr('content', '')\r\n                this.sheet.render()\r\n                break\r\n            case 46://delete\r\n                var sheet = this.sheet\r\n                sheet.cellAttrs.forEach(function (attr) {\r\n                    sheet.setAttr(attr[0], attr[1])\r\n                })\r\n                sheet.render()\r\n                break\r\n            default:\r\n                if (!this.sheet.isEditing) {\r\n                    if (this.sheet.lastCellid) this.dblclick(document.getElementById(this.sheet.lastCellid))\r\n                }\r\n        }\r\n    }\r\n}\r\n\r\nSheetEventHandler.prototype.multiLineBlur = function (text) {\r\n    this.sheet.setAttr('content', text)\r\n    this.sheet.setAttr('wrapText', true)\r\n    this.sheet.render()\r\n    this.sheet.isMultiLineEditing = false\r\n}\r\n// SheetEventHandler.prototype.setCellProp=function(element,e){\r\n//     if(e){\r\n//         var cellPropDiv=document.getElementById(\"cellProp\")\r\n//         cellPropDiv.style.display='block'\r\n//         var left=element.offsetLeft\r\n//         var top=element.offsetTop\r\n//         cellPropDiv.style.top=top+element.offsetHeight+26+'px'\r\n//         cellPropDiv.style.left=left+element.offsetWidth+9+'px'\r\n//         var cellPropTable=document.createElement('table')\r\n//         cellPropDiv.appendChild(cellPropTable)\r\n//         var tr=document.createElement('tr')\r\n//         cellPropTable.appendChild(tr)\r\n//         var th=document.createElement('th')\r\n//         th.innerHTML='属性名称'\r\n//         tr.appendChild(th)\r\n//         th=document.createElement('th')\r\n//         th.innerHTML='属性值'\r\n//         tr.appendChild(th)\r\n//         for (var key in e) {\r\n//             if(e[key]!=''){\r\n//                 var tr=document.createElement('tr')\r\n//                 cellPropTable.appendChild(tr)\r\n//                 var td=document.createElement('td')\r\n//                 td.innerHTML=key\r\n//                 tr.appendChild(td)\r\n//                 var td=document.createElement('td')\r\n//                 td.innerHTML=e[key]\r\n//                 tr.appendChild(td)\r\n//             }\r\n//         }\r\n//         this.addProp(element,cellPropTable)\r\n//     }\r\n// }\r\n// SheetEventHandler.prototype.addProp=function(ele,cellPropTable){\r\n//     var SheetEventHandler=this\r\n//     var tr=document.createElement('tr')\r\n//     cellPropTable.appendChild(tr)\r\n//     var td=document.createElement('td')\r\n//     var inputTd1=document.createElement('input')\r\n//     inputTd1.setAttribute('list','prop')\r\n//     td.appendChild(inputTd1)\r\n//     var datalist=document.createElement('datalist')\r\n//     datalist.id='prop'\r\n//     td.appendChild(datalist)\r\n//     var option=document.createElement('option')\r\n//     option.value='foregroundColor'\r\n//     datalist.appendChild(option)\r\n//     option=document.createElement('option')\r\n//     option.value='bold'\r\n//     datalist.appendChild(option)\r\n//     option=document.createElement('option')\r\n//     option.value='backgroundColor'\r\n//     datalist.appendChild(option)\r\n//     option=document.createElement('option')\r\n//     option.value='italic'\r\n//     datalist.appendChild(option)\r\n//     option=document.createElement('option')\r\n//     option.value='fontSize'\r\n//     datalist.appendChild(option)\r\n//     tr.appendChild(td)\r\n//     var td=document.createElement('td')\r\n//     var inputTd2=document.createElement('input')\r\n//     td.appendChild(inputTd2)\r\n//     tr.appendChild(td)\r\n//     inputTd1.onclick=function(){\r\n//         SheetEventHandler.firstCell=this\r\n//     }\r\n//     inputTd2.onclick=function(){\r\n//         SheetEventHandler.firstCell=this\r\n//     }\r\n//     inputTd1.onblur=function(){\r\n//         SheetEventHandler.firstCell=ele\r\n//         var input2=this.parentNode.nextSibling.firstChild\r\n//         if(inputTd1.value!=null &&inputTd1.value !=''\r\n//             &&input2.value!=null &&input2.value !=''){\r\n//             cellRender.renderCell(ele.id,inputTd1.value,input2.value)\r\n//             if(!this.parentNode.parentNode.nextSibling){\r\n//                 SheetEventHandler.addProp(ele,cellPropTable)\r\n//             }\r\n//         }\r\n//\r\n//     }\r\n//     inputTd2.onblur=function(){\r\n//         SheetEventHandler.firstCell=ele\r\n//         var input1=this.parentNode.previousSibling.firstChild\r\n//         if(input1.value!=null &&input1.value !=''\r\n//             &&inputTd2.value!=null &&inputTd2.value !=''){\r\n//             cellRender.renderCell(ele.id,input1.value,inputTd2.value)\r\n//             if(!this.parentNode.parentNode.nextSibling){\r\n//                 SheetEventHandler.addProp(ele,cellPropTable)\r\n//             }\r\n//         }\r\n//     }\r\n// }\r\n\r\n//获取元素的纵坐标\r\nfunction getTop(e) {\r\n    var offset = e.offsetTop;\r\n    if (e.offsetParent != null) offset += getTop(e.offsetParent);\r\n    return offset;\r\n}\r\n\r\n//获取元素的横坐标\r\nfunction getLeft(e) {\r\n    var offset = e.offsetLeft\r\n    if (e.offsetParent != null) offset += getLeft(e.offsetParent)\r\n    return offset\r\n}\r\n\r\nmodule.exports.SheetEventHandler = SheetEventHandler\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetEventHandler.js\n// module id = 3\n// module chunks = 0","/**\r\n * 单元格对象\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar cellConfig = configModule.CellConfig\r\n\r\nvar Cell = function (coord) {\r\n\r\n\t//成员属性\r\n\t//设置默认值\r\n\t//this.autoLF = false\r\n\r\n\t//this.viewWidth = 0\r\n\r\n\tthis.height = cellConfig.height\r\n\tthis.width = cellConfig.width\r\n\r\n\tthis.foregroundColor = ''\r\n\tthis.backgroundColor = ''\r\n\r\n\tthis.font = ''\r\n\tthis.fontSize = ''\r\n\t// // this.fontWeight = false\r\n\t// // this.fontStyle = false\r\n\r\n\tthis.topFrame = false\r\n\tthis.bottomFrame = false\r\n\tthis.leftFrame = false\r\n\tthis.rightFrame = false\r\n\r\n\tthis.alignment = 'left'\r\n\tthis.wrapText = false\r\n\r\n\tthis.coord = coord\r\n\r\n\tthis.content = ''\r\n\tthis.value = null\r\n\r\n\tthis.show = true\r\n\tthis.area = [1,1]\r\n\r\n\tthis.bold = false\r\n\tthis.italic = false\r\n\r\n\t//this.colSpan = 1\r\n\t//this.rowSpan = 1\r\n}\r\n\r\nmodule.exports.Cell = Cell\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Cell.js\n// module id = 4\n// module chunks = 0","/**\r\n * 渲染表格\r\n */\r\n\r\nvar config = require('config')\r\nvar style = require('style')\r\nvar SliderBarRender = require('SliderBarRender').SliderBarRender\r\n// config.CellConfig\r\nvar SheetRender = function (sheet) {\r\n\tthis.sheet=sheet\r\n}\r\n\r\nSheetRender.prototype.init = function (sheetDiv) {\r\n\r\n\tsheetDiv.style = style.SheetDivStyle\r\n\r\n\tvar sheetTableDiv = document.createElement('div')\r\n\tsheetTableDiv.style = style.SheetTableDivStyle\r\n\r\n\tvar sheetTable = document.createElement('table')\r\n    sheetTable.style = style.SheetTableStyle\r\n\tsheetTable.cellSpacing = '10px'\r\n\r\n\tvar sliderBarDiv = document.createElement('div')\r\n\tvar sliderBarRender = new SliderBarRender(this.sheet, sheetDiv)\r\n\tsliderBarRender.init(sliderBarDiv, sheetTableDiv)\r\n\r\n    sheetTableDiv.appendChild(sheetTable)\r\n\r\n\tsheetDiv.appendChild(sheetTableDiv)\r\n\tsheetDiv.appendChild(sliderBarDiv)\r\n\r\n    // var cellPropDiv = document.createElement(\"div\")\r\n    // cellPropDiv.id = config.CellPropConfig.id\r\n\t//\r\n\r\n    // cellPropDiv.style = style.CellPropDivStyle\r\n\r\n    // sheetDiv.appendChild(cellPropDiv)\r\n\r\n\t//表格的具体渲染\r\n\trenderSheet(this.sheet, sheetTable)\r\n}\r\n\r\nSheetRender.prototype.reRender = function() {\r\n\twhile(this.sheet.undostackCache !== []){\r\n\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * 构建表格的数据模型\r\n * 一个存放表头的二维数组\r\n * @param rowNum\r\n * @param colNum\r\n */\r\nfunction createHeader(rowNum, colNum) {\r\n\tvar gridHeader =  []\r\n\tfor(var a=0;a<rowNum+1;a++){\r\n        gridHeader[a] = []\r\n\r\n\t\tfor(var b=0;b<colNum+1;b++){\r\n            gridHeader[a][b] = null\r\n\t\t}\r\n\t}\r\n\tvar startString = \"A\"\r\n\r\n\tfor(var i=1; i<colNum+1; i++){\r\n        gridHeader[0][i] = String.fromCharCode(startString.charCodeAt(0) + i - 1)\r\n\t}\r\n\r\n\tfor(var j=1; j<rowNum+1; j++){\r\n        gridHeader[j][0] = j\r\n\t}\r\n\r\n\treturn gridHeader\r\n}\r\n/**\r\n * 表格渲染\r\n * @param sheet\r\n * @param sheetTable\r\n */\r\nfunction renderSheet(sheet, sheetTable) {\r\n\tvar gridHeader = createHeader(sheet.rowNum,  sheet.colNum)\r\n\r\n\tvar rowNum = gridHeader.length\r\n\tvar colNum = gridHeader[0].length\r\n\r\n\tvar rowHead = document.createElement('tr')\r\n\tsheetTable.appendChild(rowHead)\r\n\t//渲染第一行表头\r\n\tfor(var i=0;i<colNum;i++){\r\n\t\tvar rowHeadTH  = document.createElement('th')\r\n\t\t// rowHeadTH.style.height = '20px'\r\n\t\trowHeadTH.id = gridHeader[0][i]+'_0'\r\n\t\trowHead.appendChild(rowHeadTH)\r\n\r\n\t\tvar rowHeadDiv = document.createElement('div')\r\n\t\trowHeadTH.appendChild(rowHeadDiv)\r\n\t\t// 第一行第一列特殊处理\r\n\t\tif(i === 0){\r\n            //rowHeadTH.style.width = '29px'\r\n\t\t}else{\r\n\t\t\trowHeadDiv.innerHTML = gridHeader[0][i]\r\n            rowHeadDiv.style.width = config.CellConfig.width + 'px'\r\n\t\t}\r\n\t}\r\n\r\n    var SheetEventBinderModule = require('SheetEventBinder')\r\n    var SheetEventBinder=SheetEventBinderModule.SheetEventBinder\r\n    var sheetEventBinder=new SheetEventBinder(sheet)\r\n\r\n\t//渲染除第一行外单元格\r\n\tfor(var j = 1;j<rowNum;j++){\r\n\t\tvar rowTR = document.createElement('tr')\r\n\t\tsheetTable.appendChild(rowTR)\r\n\r\n\t\tfor(var k=0; k<colNum;k++){\r\n\t\t\t//表格第一列特殊处理\r\n\t\t\tif(k === 0){\r\n\t\t\t\tvar rowTH = document.createElement('th')\r\n\t\t\t\trowTH.id = '@_' + gridHeader[j][0]\r\n\t\t\t\trowTR.appendChild(rowTH)\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n\t\t\t\trowTH.appendChild(rowDiv)\r\n                rowDiv.innerHTML = gridHeader[j][k]\r\n\t\t\t}else {\r\n\t\t\t\tvar rowTD = document.createElement('td')\r\n                rowTD.id = gridHeader[0][k]+\"_\"+j\r\n                rowTR.appendChild(rowTD)\r\n                if(!config.WSConfig.isPreview){\r\n                    sheetEventBinder.initRowTD(rowTD)\r\n                }\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n\t\t\t\trowTD.className = \"noWrap\"\r\n                rowTD.appendChild(rowDiv)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar input = document.createElement('input')\r\n\tinput.style = style.InputStyle\r\n\tinput.id = config.InputConfig.id\r\n    if(!config.WSConfig.isPreview){\r\n        sheetEventBinder.initInput(input)\r\n    }\r\n\r\n\tsheetTable.appendChild(input)\r\n\r\n    var clipBoard = document.createElement('textarea') // used for ctrl-c/ctrl-v where an invisible text area is needed\r\n\tclipBoard.style = style.ClipBoardStyle\r\n\tclipBoard.value = config.ClipBoardConfig.value;\r\n\tclipBoard.id = config.ClipBoardConfig.id;\r\n    sheetTable.appendChild(clipBoard)\r\n\r\n    // var span = document.createElement('span') // 用于获得字符串的显示长度\r\n    // span.style = 'visibility: hidden;white-space: nowrap;filter:alpha(opacity=0);'\r\n    // span.value = '';\r\n    // span.id = 'sp'\r\n    // sheetTable.appendChild(span)\r\n\r\n    var multiLine = document.createElement('textarea')\r\n    multiLine.style = 'position: absolute;left: 30px;top: 20px;display:none;'\r\n\tmultiLine.style.left = screen.width/2 -150+ 'px'\r\n    multiLine.style.top = screen.height/2 -300+ 'px'\r\n    multiLine.style.width = 400 + 'px'\r\n    multiLine.style.height = 400 + 'px'\r\n    multiLine.value = '';\r\n    multiLine.id = 'multiLine1'\r\n    if(!config.WSConfig.isPreview){\r\n        sheetEventBinder.initMultiLine(multiLine)\r\n    }\r\n\tsheetTable.appendChild(multiLine)\r\n    var dragBar = document.createElement('div')\r\n    dragBar.style = 'position: absolute;'\r\n    dragBar.style.backgroundColor = 'yellow'\r\n    dragBar.style.width = 8 + 'px'\r\n    dragBar.style.height = 8 + 'px'\r\n    dragBar.style.display = 'none'\r\n\tdragBar.id = 'dragBar'\r\n\tdragBar.webkitUserDrag = 'true'\r\n    if(!config.WSConfig.isPreview){\r\n        sheetEventBinder.initDragBar(dragBar)\r\n    }\r\n\tsheetTable.appendChild(dragBar)\r\n}\r\n\r\n\r\n\r\nmodule.exports.SheetRender = SheetRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetRender.js\n// module id = 5\n// module chunks = 0","/**\r\n 工具栏绑定事件\r\n */\r\n\r\nvar ToolEventHandlerModule = require('ToolEventHandler')\r\nvar ToolEventHandler = ToolEventHandlerModule.ToolEventHandler\r\nvar toolEventHandler = null\r\n\r\nvar SheetEventHandlerModule = require('SheetEventHandler')\r\nvar SheetEventHandler = SheetEventHandlerModule.SheetEventHandler\r\nvar sheetEventHandler = null\r\n\r\n\r\nvar ToolEventBinder = function (sheet) {\r\n    this.sheet = sheet\r\n    sheetEventHandler = new SheetEventHandler(sheet)\r\n    this.sheet.colorOrBackgroudcolor = null\r\n    toolEventHandler = new ToolEventHandler(sheet)\r\n}\r\nToolEventBinder.prototype.buttonClick = function (action) {\r\n    toolEventHandler.buttonClick(action)\r\n}\r\nToolEventBinder.prototype.initFontFamily = function (fontFamilySelect) {\r\n    var toolEventBinder = this\r\n    fontFamilySelect.onchange = function () {\r\n        toolEventBinder.sheet.setAttr('font', fontFamilySelect.value)\r\n        toolEventBinder.sheet.render()\r\n        fontFamilySelect.value = 'fontFamily'\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontSize = function (fontSizeSelect) {\r\n    var toolEventBinder = this\r\n    fontSizeSelect.onchange = function () {\r\n        //todo\r\n        //switch\r\n        toolEventBinder.sheet.setAttr('fontSize', fontSizeSelect.value)\r\n        toolEventBinder.sheet.render()\r\n        fontSizeSelect.value = 'fontSize'\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontWeight = function (fontWeightDiv) {\r\n    var toolEventBinder = this\r\n    fontWeightDiv.onclick = function () {\r\n        var lastCellId = toolEventBinder.sheet.lastCellid\r\n        if (!toolEventBinder.sheet.cells[lastCellId]) {\r\n            toolEventBinder.sheet.setAttr('bold', true)\r\n        }\r\n        toolEventBinder.sheet.setAttr('bold', !toolEventBinder.sheet.cells[lastCellId].bold)\r\n        toolEventBinder.sheet.render()\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontStyle = function (fontStyleDiv) {\r\n    var toolEventBinder = this\r\n    fontStyleDiv.onclick = function () {\r\n        var lastCellId = toolEventBinder.sheet.lastCellid\r\n        if (!toolEventBinder.sheet.cells[lastCellId]) {\r\n            toolEventBinder.sheet.setAttr('italic', true)\r\n        }\r\n        toolEventBinder.sheet.setAttr('italic', !toolEventBinder.sheet.cells[lastCellId].italic)\r\n        toolEventBinder.sheet.render()\r\n    }\r\n}\r\nToolEventBinder.prototype.initColor = function (colorDiv) {\r\n    var toolEventBinder = this\r\n    colorDiv.onclick = function () {\r\n        var colorSelectDiv = document.getElementById('colorSelect')\r\n        if (colorSelectDiv.style.display === 'none' || toolEventBinder.fontType === 'backgroundColor') {\r\n            toolEventBinder.colorOrBackgroudcolor = 'foregroundColor'\r\n            colorSelectDiv.style.display = 'block'\r\n            var left = this.offsetLeft\r\n            var top = this.offsetTop\r\n            colorSelectDiv.style.top = top + 18 + 'px'\r\n            colorSelectDiv.style.left = left + 'px'\r\n        } else {\r\n            colorSelectDiv.style.display = 'none'\r\n        }\r\n\r\n    }\r\n}\r\nToolEventBinder.prototype.initBackgroundColor = function (backgroundColorDiv) {\r\n    var toolEventBinder = this\r\n    backgroundColorDiv.onclick = function () {\r\n        var colorSelectDiv = document.getElementById('colorSelect')\r\n        if (colorSelectDiv.style.display === 'none' || toolEventBinder.fontType === 'foregroundColor') {\r\n            toolEventBinder.colorOrBackgroudcolor = 'backgroundColor'\r\n            colorSelectDiv.style.display = 'block'\r\n            var left = this.offsetLeft\r\n            var top = this.offsetTop\r\n            colorSelectDiv.style.top = top + 18 + 'px'\r\n            colorSelectDiv.style.left = left + 'px'\r\n        } else {\r\n            colorSelectDiv.style.display = 'none'\r\n        }\r\n    }\r\n}\r\nToolEventBinder.prototype.initColorSelect = function (td) {\r\n    var toolEventBinder = this\r\n    td.onclick = function () {\r\n        document.getElementById('colorSelect').style.display = 'none'\r\n        toolEventBinder.sheet.setAttr(toolEventBinder.colorOrBackgroudcolor, this.style.backgroundColor)\r\n        toolEventBinder.sheet.render()\r\n\r\n    }\r\n}\r\nToolEventBinder.prototype.initMerge = function (mergeDiv, value) {\r\n    var toolEventBinder = this\r\n    mergeDiv.onclick = function () {\r\n        sheetEventHandler.setCellBackgroundColor('#fff')\r\n        toolEventBinder.sheet.setAttr('merge', value)\r\n        toolEventBinder.sheet.render()\r\n        sheetEventHandler.mouseDown(toolEventBinder.sheet.firstCellid)\r\n        sheetEventHandler.mouseUp(document.getElementById(toolEventBinder.sheet.lastCellid))\r\n    }\r\n}\r\n\r\nToolEventBinder.prototype.initFontBorder = function (value) {\r\n    var toolEventBinder = this\r\n    switch (value) {\r\n        case 'left':\r\n            toolEventBinder.sheet.setAttr('leftFrame', true)\r\n\r\n            break\r\n        case 'top':\r\n            toolEventBinder.sheet.setAttr('topFrame', true)\r\n            break\r\n        case 'right':\r\n            toolEventBinder.sheet.setAttr('rightFrame', true)\r\n            break\r\n        case 'bottom':\r\n            toolEventBinder.sheet.setAttr('bottomFrame', true)\r\n            break\r\n        case 'clear':\r\n            toolEventBinder.sheet.setAttr('allFrameEx', false)\r\n            break\r\n        case 'outer':\r\n            toolEventBinder.sheet.setAttr('leftFrame', true)\r\n            toolEventBinder.sheet.setAttr('topFrame', true)\r\n            toolEventBinder.sheet.setAttr('rightFrame', true)\r\n            toolEventBinder.sheet.setAttr('bottomFrame', true)\r\n            break\r\n        case 'all':\r\n            toolEventBinder.sheet.setAttr('allFrameEx', true)\r\n            break\r\n    }\r\n    toolEventBinder.sheet.render()\r\n}\r\n\r\nToolEventBinder.prototype.initTextAlign = function (value) {\r\n    var toolEventBinder = this\r\n    toolEventBinder.sheet.setAttr('alignment', value)\r\n    toolEventBinder.sheet.render()\r\n}\r\nToolEventBinder.prototype.initFileInput = function (fileInput) {\r\n    fileInput.onchange = function () {\r\n        var ajax\r\n        if (window.XMLHttpRequest) {\r\n            ajax = new XMLHttpRequest()\r\n        } else if (window.ActiveXObject) {\r\n            ajax = new window.ActiveXObject()\r\n        } else {\r\n            alert(\"请升级至最新版本的浏览器\")\r\n        }\r\n        if (ajax !== null) {\r\n            ajax.open(\"GET\", \"json.json\", true)\r\n            ajax.send(null)\r\n            ajax.onreadystatechange = function () {\r\n                if (ajax.readyState === 4 && ajax.status === 200) {\r\n                    var CellList = JSON.parse(ajax.responseText)\r\n                    CellList.forEach(function (e) {\r\n                        for (var key in e) {\r\n                            cellRender.renderCell(e['cellName'], key, e[key])\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nmodule.exports.ToolEventBinder = ToolEventBinder\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolEventBinder.js\n// module id = 6\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\nvar WSManagerModule = require('WSManager')\r\nvar WSManager = WSManagerModule.WSManager\r\nvar wsManager=new WSManager()\r\n\r\nvar parentNode = document.getElementById('QianMoApp')\r\n\r\nvar myUrl=GetQueryString(\"url\")\r\nif(myUrl!=null && myUrl.toString().length>1){\r\n    parentNode.setAttribute('url',myUrl)\r\n}\r\nfunction GetQueryString(name){\r\n    var reg=new RegExp(\"(^|&)\"+name+\"=([^&]*)(&|$)\")\r\n    var r=window.location.search.substring(1).match(reg)\r\n    if(r!=null){\r\n        return unescape(r[2])\r\n    }\r\n    return null\r\n}\r\n\r\nwsManager.init(parentNode)\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app.js\n// module id = 7\n// module chunks = 0","var config = require('config')\r\n\r\n// var UtilModule=require('Util')\r\n// var Util=UtilModule.Util\r\n// var util=new Util()\r\n\r\nvar CellModule = require('Cell')\r\nvar Cell = CellModule.Cell\r\n\r\nvar CellRender = function (sheet) {\r\n    this.sheet = sheet\r\n}\r\n/**\r\n * 渲染单元格\r\n * @param id\r\n * @param cmd\r\n * @param value\r\n */\r\nCellRender.prototype.renderCell = function (id, cmd, value) {\r\n    // var sheet=this.sheet\r\n    // if(id && id.indexOf('_')==-1){\r\n    //     var index=id.search(/\\d/)\r\n    //     id=id.substring(0,index)+'_'+id.substring(index,id.length)\r\n    // }\r\n    var ele = document.getElementById(id)\r\n\r\n    // if(id && !sheet.cells[id]){\r\n    //     sheet.cells[id] = new Cell(id)\r\n    // }\r\n    if (ele) {\r\n        switch (cmd) {\r\n            //合并范围\r\n            case \"colSpan\":\r\n                if(value>0) ele.colSpan = value\r\n                break\r\n            case 'rowSpan':\r\n                if(value>0)ele.rowSpan = value\r\n                break\r\n            case \"show\":\r\n                if (value) ele.style.display = 'table-cell'\r\n                else {\r\n                    ele.style.display = 'none'\r\n                }\r\n                break\r\n            //字体颜色\r\n            case \"foregroundColor\":\r\n                ele.style.color = value\r\n\r\n\r\n                break\r\n            //背景色\r\n            case \"backgroundColor\":\r\n\r\n                ele.style.backgroundColor = value\r\n\r\n                break\r\n            //文本内容\r\n            case \"content\":\r\n                if (value === null) {\r\n                    value = ''\r\n                }\r\n                ele.firstChild.innerHTML = value\r\n                break\r\n            //字体\r\n            case \"font\":\r\n                if (value == 'Default') {\r\n                    value = ''\r\n                }\r\n                ele.style.fontFamily = value\r\n                break\r\n            //字体大小\r\n            case \"fontSize\":\r\n                if (value == 'Default' || value == '-----') {\r\n                    value = ''\r\n                }\r\n                ele.style.fontSize = value\r\n                //this.sheet.cells[id].fontSize=value\r\n                break\r\n            //字体类型\r\n            //case \"format\":\r\n            //    this.sheet.cells[id].format=value\r\n            //    break\r\n            //加粗\r\n            case \"bold\":\r\n                if (value) ele.style.fontWeight = 'bold'\r\n                else ele.style.fontWeight = ''\r\n                break\r\n\r\n            //斜体\r\n            case \"italic\":\r\n                if (value) ele.style.fontStyle = 'italic'\r\n                else ele.style.fontStyle = ''\r\n                break\r\n            //\r\n            //对齐方向\r\n            case \"alignment\":\r\n\r\n                ele.style.textAlign = value\r\n                ele.firstChild.style.textAlign = value\r\n\r\n                break\r\n            //换行\r\n            case \"wrapText\":\r\n                if (value) ele.firstChild.className = 'wrap'\r\n                else ele.firstChild.className = 'noWrap'\r\n                break\r\n            //边框\r\n            case \"bottomFrame\":\r\n                var newId = id.split('_')[0] + '_' + (parseInt(id.split('_')[1])+1)\r\n                if (value ) {\r\n                    ele.style.borderBottom = '1px solid #000'\r\n                } else if(!this.sheet.cells[newId] || !this.sheet.cells[newId].topFrame){\r\n                    ele.style.borderBottom = ''\r\n                    console.log(newId)\r\n                }\r\n                // if (value) ele.style.borderBottom = '2px solid #000'\r\n                // else ele.style.borderBottom = ''\r\n                break\r\n            case \"leftFrame\":\r\n                var newId = String.fromCharCode(id.split('_')[0].charCodeAt(0) - 1) + '_' + id.split('_')[1]\r\n                if (value) {\r\n                    document.getElementById(newId).style.borderRight = '1px solid #000'\r\n                } else if(!this.sheet.cells[newId] || !this.sheet.cells[newId].rightFrame)document.getElementById(newId).style.borderRight = ''\r\n                // if (value) ele.style.borderLeft = '2px solid #000'\r\n                // else ele.style.borderLeft = ''\r\n                break\r\n            case \"rightFrame\":\r\n                var newId = String.fromCharCode(id.split('_')[0].charCodeAt(0) + 1) + '_' + id.split('_')[1]\r\n                if (value) {\r\n                    ele.style.borderRight = '1px solid #000'\r\n                } else if(!this.sheet.cells[newId] || !this.sheet.cells[newId].leftFrame) ele.style.borderRight = ''\r\n                // if (value) ele.style.borderRight = '2px solid #000'\r\n                // else ele.style.borderRight = ''\r\n                break\r\n            case \"topFrame\":\r\n                var newId = id.split('_')[0] + '_' + (parseInt(id.split('_')[1])-1)\r\n                if (value) {\r\n                    document.getElementById(newId).style.borderBottom = '1px solid #000'\r\n                } else if(!this.sheet.cells[newId] || !this.sheet.cells[newId].bottomFrame) document.getElementById(newId).style.borderBottom = ''\r\n                // if (value) ele.style.borderTop = '2px solid #000'\r\n                // else ele.style.borderTop = ''\r\n                break\r\n            //宽高\r\n            case 'width':\r\n                if (value) {\r\n                    var newId = id.split('_')[0]+'_0'\r\n                    document.getElementById(newId).firstChild.style.width = parseInt(value) + 'px'\r\n                }\r\n                break\r\n            case 'height':\r\n                if (value){\r\n                    var newId = '@_'+id.split('_')[1]\r\n                    document.getElementById(newId).firstChild.style.height = parseInt(value) + 'px'\r\n                }\r\n                break\r\n            case 'area':\r\n                console.log('!!!')\r\n                break\r\n            // case \"formula\":\r\n            //     this.sheet.cells[id].formula=value\r\n            //     break\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports.CellRender = CellRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/CellRender.js\n// module id = 8\n// module chunks = 0","/**\r\n * 表格对象\r\n */\r\n\r\n\r\nvar configModule = require('config')\r\nvar CellModule = require('Cell')\r\nvar Cell = CellModule.Cell\r\nvar sheetConfig = configModule.SheetConfig\r\n// var UtilModule = require('Util')\r\n// var Util = UtilModule.Util\r\n// var util = new Util()\r\nvar CellRenderModule = require('CellRender')\r\nvar CellRender = CellRenderModule.CellRender\r\n//var cellRender = new CellRender\r\nvar Sheet = function (UndoStack) {\r\n    this.cellRender = new CellRender(this)\r\n    this.height = sheetConfig.height\r\n    this.width = sheetConfig.width\r\n\r\n    this.headWidth = sheetConfig.headWidth\r\n    this.headHeight = sheetConfig.headHeight\r\n\r\n\r\n    this.rowNum = sheetConfig.rowNum\r\n    this.colNum = sheetConfig.colNum\r\n\r\n    this.maxCol = 65\r\n    this.maxRow = 1\r\n\r\n    this.cells = {}\r\n    this.firstCopiedCell = null\r\n    this.copiedCells = {}\r\n    // todo cellAttrs\r\n    this.cellAttrs = [['backgroundColor', ''], ['foregroundColor', ''], ['bold', false], ['italic', false],\r\n        ['content', ''], ['fontSize', ''], ['alignment', 'left'], ['font', ''], ['show', true],\r\n        ['colSpan', 1], ['rowSpan', 1]]\r\n    //['bottomFrame', false], ['leftFrame', false], ['topFrame', false], ['rightFrame', false]\r\n    this.UndoStack = UndoStack\r\n    this.undostackCache = []\r\n\r\n    this.isMouseDown = false\r\n    this.isKeyDown = false\r\n    this.isEditing = false\r\n    this.isMultiLineEditing = false\r\n    this.isDraging = false\r\n\r\n    //this.isFont = false\r\n    this.isPreview = false\r\n\r\n    this.firstCellid = 'A_1'\r\n    this.lastCellid = 'A_1'\r\n    this.editCells = this.getColAndRow()\r\n}\r\n\r\nSheet.prototype.addCell = function (id) {\r\n    if (!this.cells[id]) {\r\n        this.cells[id] = new Cell(id)\r\n        if (id.split('_')[0].charCodeAt(0) > this.maxCol) this.maxCol = id.split('_')[0].charCodeAt(0)\r\n        if (parseInt(id.split('_')[1]) > this.maxRow) this.maxRow = parseInt(id.split('_')[1])\r\n    }\r\n}\r\n\r\nSheet.prototype.setAttr = function (attr, value, cells) {\r\n    if (!cells) var cells = this.editCells\r\n    if (cells != null) {\r\n        switch (attr) {\r\n            //缩进\r\n            case 'indentation':\r\n                if (value > 0) {\r\n                    var html = '';\r\n                    for (var i = 0; i < value; i++) {\r\n                        html += '&nbsp;'\r\n                    }\r\n                    var i = cells.firstCellCol\r\n                    var j = cells.firstCellRow\r\n                    var id = String.fromCharCode(i) + '_' + j\r\n                    if (this.cells[id]) {\r\n                        if (this.cells[id]['content']) {\r\n                            if (this.cells[id].show) {\r\n                                html = html + this.cells[id]['content']\r\n                                this.undostackCache.push([id, 'content', html, this.cells[id]['content']])\r\n                                this.cells[id]['content'] = html\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                break\r\n            case 'cellname':\r\n            case 'area':\r\n                break\r\n            case 'merge':\r\n                if (value) {\r\n                    for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                        for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                            var id = String.fromCharCode(i) + '_' + j\r\n                            this.addCell(id)\r\n                            if (this.cells[id].show) {\r\n                                if (i === cells.firstCellCol && j === cells.firstCellRow) {\r\n                                    var colSpan = cells.lastCellCol - cells.firstCellCol + 1\r\n                                    var rowSpan = cells.lastCellRow - cells.firstCellRow + 1\r\n                                    if (colSpan !== this.cells[id].colSpan || rowSpan !== this.cells[id].rowSpan) {\r\n                                        this.undostackCache.push([id, 'colSpan', colSpan, this.cells[id].colSpan])\r\n                                        this.undostackCache.push([id, 'rowSpan', rowSpan, this.cells[id].rowSpan])\r\n                                        //this.undostackCache.push([id, 'area', [colSpan, rowSpan], [this.cells[id].colSpan, this.cells[id].rowSpan]])\r\n                                        this.cells[id].colSpan = colSpan\r\n                                        this.cells[id].rowSpan = rowSpan\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    this.cells[id].show = false\r\n                                    this.undostackCache.push([id, 'show', false, true])\r\n                                    this.undostackCache.push([id, 'colSpan', cells.firstCellCol - i + 1, this.cells[id].colSpan])\r\n                                    this.undostackCache.push([id, 'rowSpan', cells.firstCellRow - j + 1, this.cells[id].rowSpan])\r\n                                    this.cells[id].colSpan = cells.firstCellCol - i + 1\r\n                                    this.cells[id].rowSpan = cells.firstCellRow - j + 1\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    this.lastCellid = this.firstCellid\r\n                }\r\n                else {\r\n                    this.firstCellid = String.fromCharCode(cells.firstCellCol) + '_' + cells.firstCellRow\r\n                    this.lastCellid = String.fromCharCode(cells.lastCellCol) + '_' + cells.lastCellRow\r\n                    for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                        for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                            var id = String.fromCharCode(i) + '_' + j\r\n                            if (!this.cells[id]) {\r\n                                continue\r\n                            }\r\n                            if (this.cells[id].colSpan != 1 || this.cells[id].rowSpan != 1) {\r\n                                this.undostackCache.push([id, 'colSpan', 1, this.cells[id].colSpan])\r\n                                this.undostackCache.push([id, 'rowSpan', 1, this.cells[id].rowSpan])\r\n                                this.cells[id].colSpan = 1\r\n                                this.cells[id].rowSpan = 1\r\n                            }\r\n                            if (!this.cells[id].show) {\r\n                                this.undostackCache.push([id, 'show', true, false])\r\n                                this.cells[id].show = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                break\r\n            case 'leftFrame':\r\n            case 'topFrame':\r\n            case 'rightFrame':\r\n            case 'bottomFrame':\r\n                switch (attr) {\r\n                    case 'leftFrame':\r\n                        var mini = cells.firstCellCol\r\n                        var minj = cells.firstCellRow\r\n                        var maxi = cells.firstCellCol\r\n                        var maxj = cells.lastCellRow\r\n                        break\r\n                    case 'topFrame':\r\n                        var mini = cells.firstCellCol\r\n                        var minj = cells.firstCellRow\r\n                        var maxi = cells.lastCellCol\r\n                        var maxj = cells.firstCellRow\r\n                        break\r\n                    case 'rightFrame':\r\n                        var mini = cells.lastCellCol\r\n                        var minj = cells.firstCellRow\r\n                        var maxi = cells.lastCellCol\r\n                        var maxj = cells.lastCellRow\r\n                        break\r\n                    case 'bottomFrame':\r\n                        var mini = cells.firstCellCol\r\n                        var minj = cells.lastCellRow\r\n                        var maxi = cells.lastCellCol\r\n                        var maxj = cells.lastCellRow\r\n                        break\r\n\r\n                }\r\n                for (var i = mini; i <= maxi; i++) {\r\n                    for (var j = minj; j <= maxj; j++) {\r\n                        var id = String.fromCharCode(i) + '_' + j\r\n                        this.addCell(id)\r\n                        if (this.cells[id][attr] != value) {\r\n                            this.cells[id][attr] = value\r\n                            this.undostackCache.push([id, attr, value, !value])\r\n                        }\r\n                    }\r\n                }\r\n                break\r\n            case 'allFrameEx':\r\n                for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                    for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                        var id = String.fromCharCode(i) + '_' + j\r\n                        this.addCell(id)\r\n                        // var env = this\r\n                        //\r\n                        // if (env.cells[id].rightFrame != value && i !== cells.firstCellCol - 1) {\r\n                        //     env.undostackCache.push([id, 'topFrame', value, !value])\r\n                        //     env.cells[id].rightFrame = value\r\n                        // }\r\n                        // if (env.cells[id].bottomFrame != value && j !== cells.firstCellRow - 1) {\r\n                        //     env.undostackCache.push([id, 'rightFrame', value, !value])\r\n                        //     env.cells[id].bottomFrame = value\r\n                        // }\r\n                        var env = this\r\n\r\n                        var a = ['leftFrame', 'rightFrame', 'topFrame', 'bottomFrame']\r\n\r\n                        a.forEach(function (frame) {\r\n                            if (env.cells[id][frame] != value) {\r\n                                env.undostackCache.push([id, frame, value, !value])\r\n                                env.cells[id][frame] = value\r\n                            }\r\n                        })\r\n\r\n                    }\r\n                }\r\n                if (value == false) {\r\n                    if (cells.firstCellCol > 65) {\r\n                        var firstCellid = String.fromCharCode(cells.firstCellCol - 1)\r\n                            + '_' + cells.firstCellRow\r\n                        var lastCellid = String.fromCharCode(cells.firstCellCol - 1)\r\n                            + '_' + cells.lastCellRow\r\n                        var newCell = this.getColAndRow(firstCellid, lastCellid)\r\n                        this.setAttr('rightFrame', false, newCell)\r\n                        delete  newCell\r\n                    }\r\n                    if (cells.firstCellRow > 1) {\r\n\r\n                        var firstCellid = String.fromCharCode(cells.firstCellCol)\r\n                            + '_' + (cells.firstCellRow - 1)\r\n                        var lastCellid = String.fromCharCode(cells.lastCellCol)\r\n                            + '_' + (cells.firstCellRow - 1)\r\n                        var newCell = this.getColAndRow(firstCellid, lastCellid)\r\n                        this.setAttr('bottomFrame', false, newCell)\r\n                        delete  newCell\r\n                    }\r\n                    if (document.getElementById(String.fromCharCode(cells.lastCellCol)\r\n                            + '_' + (cells.lastCellRow + 1))) {\r\n                        var firstCellid = String.fromCharCode(cells.firstCellCol)\r\n                            + '_' + (cells.lastCellRow + 1)\r\n                        var lastCellid = String.fromCharCode(cells.lastCellCol)\r\n                            + '_' + (cells.lastCellRow + 1)\r\n                        var newCell = this.getColAndRow(firstCellid, lastCellid)\r\n                        this.setAttr('topFrame', false, newCell)\r\n                        delete  newCell\r\n                    }\r\n                    if (document.getElementById(String.fromCharCode(cells.lastCellCol + 1)\r\n                            + '_' + (cells.lastCellRow))) {\r\n                        var firstCellid = String.fromCharCode(cells.lastCellCol + 1)\r\n                            + '_' + (cells.firstCellRow)\r\n                        var lastCellid = String.fromCharCode(cells.lastCellCol + 1)\r\n                            + '_' + (cells.lastCellRow )\r\n                        var newCell = this.getColAndRow(firstCellid, lastCellid)\r\n                        this.setAttr('leftFrame', false, newCell)\r\n                        delete  newCell\r\n                    }\r\n                }\r\n                break\r\n            case 'allFrame':\r\n                for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                    for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                        var id = String.fromCharCode(i) + '_' + j\r\n                        this.addCell(id)\r\n                        var env = this\r\n\r\n                        var a = ['leftFrame', 'rightFrame', 'topFrame', 'bottomFrame']\r\n\r\n                        a.forEach(function (frame) {\r\n                            if (env.cells[id][frame] != value) {\r\n                                env.undostackCache.push([id, frame, value, !value])\r\n                                env.cells[id][frame] = value\r\n                            }\r\n                        })\r\n\r\n                    }\r\n                }\r\n                break\r\n            default:\r\n                for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                    for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                        var id = String.fromCharCode(i) + '_' + j\r\n                        this.addCell(id)\r\n\r\n                            if (this.cells[id][attr] !== value) {\r\n                                this.undostackCache.push([id, attr, value, this.cells[id][attr]])\r\n                                this.cells[id][attr] = value\r\n                            }\r\n\r\n                    }\r\n                }\r\n                break\r\n        }\r\n    }\r\n}\r\n//将value赋值给attr属性，赋值范围由sheet.firstcell和sheet.lastcell指定\r\n\r\nSheet.prototype.sheet2json = function () {\r\n//todo\r\n}\r\n\r\nSheet.prototype.json2sheet = function () {\r\n//todo\r\n}\r\n\r\nSheet.prototype.render = function () {\r\n    var sheet = this\r\n    this.undostackCache.forEach(function (cache) {\r\n        sheet.cellRender.renderCell(cache[0], cache[1], cache[2])\r\n    })\r\n    this.UndoStack.pushStep(this.undostackCache)\r\n    this.undostackCache = []\r\n    //遍历sheet.undostackCache,将sheet.undostackCache压入sheet.undostack\r\n}\r\nSheet.prototype.renderCell = function (id, cmd, value) {\r\n    this.cellRender.renderCell(id, cmd, value)\r\n}\r\n\r\nSheet.prototype.undo = function () {\r\n    var undoSteps = this.UndoStack.unDo()\r\n    if (undoSteps) {\r\n        var sheet = this\r\n        undoSteps.forEach(function (step) {\r\n            sheet.cells[step[0]][step[1]] = step[3]\r\n            sheet.cellRender.renderCell(step[0], step[1], step[3])\r\n        })\r\n    }\r\n}\r\n\r\nSheet.prototype.redo = function () {\r\n    var undoSteps = this.UndoStack.reDo()\r\n    if (undoSteps) {\r\n        var sheet = this\r\n        undoSteps.forEach(function (step) {\r\n            sheet.cells[step[0]][step[1]] = step[2]\r\n            sheet.cellRender.renderCell(step[0], step[1], step[2])\r\n        })\r\n    }\r\n\r\n}\r\n\r\nSheet.prototype.getColAndRow = function (firstCellid, lastCellid) {\r\n    if (firstCellid == null) {\r\n        firstCellid = this.firstCellid\r\n        lastCellid = this.lastCellid\r\n    }\r\n    //if (firstCell && firstCell.id && lastCell && lastCell.id) {\r\n    var result = {}\r\n    result.firstCellCol = Math.min(firstCellid.split('_')[0].charCodeAt(0), lastCellid.split('_')[0].charCodeAt(0))\r\n    result.firstCellRow = Math.min(parseInt(firstCellid.split('_')[1]), parseInt(lastCellid.split('_')[1]))\r\n    result.lastCellCol = Math.max(lastCellid.split('_')[0].charCodeAt(0), firstCellid.split('_')[0].charCodeAt(0))\r\n    result.lastCellRow = Math.max(parseInt(lastCellid.split('_')[1]), parseInt(firstCellid.split('_')[1]))\r\n    //}\r\n    var sheet = this\r\n    return getRectangle(result, sheet)\r\n}\r\n\r\ngetRectangle = function (cells, sheet) {\r\n    //console.log(cells)\r\n    var flag = false\r\n    var minCol = cells.firstCellCol\r\n    var minRow = cells.firstCellRow\r\n    var maxCol = cells.lastCellCol\r\n    var maxRow = cells.lastCellRow\r\n\r\n    for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n        for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n            var id = String.fromCharCode(i) + '_' + j\r\n            if (!sheet.cells[id]) {\r\n                continue\r\n\r\n            }\r\n            if (!sheet.cells[id].show) {\r\n                if ((i + sheet.cells[id].colSpan - 1) < minCol) {\r\n                    flag = true\r\n                    minCol = (i + sheet.cells[id].colSpan - 1)\r\n\r\n                }\r\n                if ((j + sheet.cells[id].rowSpan - 1) < minRow) {\r\n                    flag = true\r\n                    minRow = (j + sheet.cells[id].rowSpan - 1)\r\n                }\r\n            }\r\n            else {\r\n                if (sheet.cells[id].colSpan - 1 + i > maxCol) {\r\n                    flag = true\r\n                    maxCol = sheet.cells[id].colSpan - 1 + i\r\n                }\r\n                if (sheet.cells[id].rowSpan - 1 + j > maxRow) {\r\n                    flag = true\r\n                    maxRow = sheet.cells[id].rowSpan - 1 + j\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n    cells.firstCellCol = minCol\r\n    cells.firstCellRow = minRow\r\n    cells.lastCellCol = maxCol\r\n    cells.lastCellRow = maxRow\r\n    if (flag) return getRectangle(cells, sheet)\r\n    else return cells\r\n}\r\n\r\n\r\nmodule.exports.Sheet = Sheet\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Sheet.js\n// module id = 9\n// module chunks = 0","//事件绑定对象\r\nvar SheetEventHandlerModule = require('SheetEventHandler')\r\nvar SheetEventHandler = SheetEventHandlerModule.SheetEventHandler\r\nvar sheetEventHandler = null\r\n\r\nvar SheetEventBinder = function (sheet) {\r\n    this.sheet = sheet\r\n    sheetEventHandler = new SheetEventHandler(sheet)\r\n    window.onmouseup = function () {\r\n        sheet.isMouseDown = false\r\n    }\r\n    document.onkeydown = function (event) {\r\n        sheetEventHandler.keyDown(event)\r\n\r\n        if (!sheet.isMultiLineEditing && !sheet.isEditing) return false\r\n    }\r\n}\r\n\r\nSheetEventBinder.prototype.initRowTD = function (rowTD) {\r\n    var sheet = this.sheet\r\n    rowTD.onmousedown = function () {\r\n        sheetEventHandler.mouseDown(rowTD.id)\r\n    }\r\n    rowTD.onmouseup = function () {\r\n        sheetEventHandler.mouseUp(rowTD)\r\n    }\r\n    rowTD.onmousemove = function () {\r\n        if (sheet.isMouseDown || sheet.isDraging) {\r\n            sheetEventHandler.mouseMove(rowTD.id)\r\n        }\r\n    }\r\n    rowTD.ondblclick = function () {\r\n        sheetEventHandler.dblclick(this)\r\n    }\r\n}\r\nSheetEventBinder.prototype.initInput = function (input) {\r\n    input.onblur = function () {\r\n        sheetEventHandler.inputBlur()\r\n    }\r\n    input.onfocus = function () {\r\n        sheetEventHandler.inputFocus()\r\n    }\r\n}\r\nSheetEventBinder.prototype.initMultiLine = function (multiLine) {\r\n    multiLine.onblur = function () {\r\n        sheetEventHandler.multiLineBlur(multiLine.value)\r\n        multiLine.value = ''\r\n        multiLine.style.display = 'none'\r\n    }\r\n}\r\nSheetEventBinder.prototype.initDragBar = function (dragBar) {\r\n    dragBar.onmousedown = function () {\r\n        sheetEventHandler.dragBarMouseDown()\r\n    }\r\n    dragBar.onmouseup = function () {\r\n        sheetEventHandler.dragBarMouseUp()\r\n    }\r\n}\r\nmodule.exports.SheetEventBinder = SheetEventBinder\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetEventBinder.js\n// module id = 10\n// module chunks = 0","/**\r\n * Created by Ian on 17/7/22.\r\n */\r\n\r\nvar style  = require('style')\r\nvar config = require('config')\r\n\r\nvar SliderBarRender = function (sheet, sheetDiv) {\r\n\tthis.sheet = sheet\r\n\tthis.sheetDiv = sheetDiv\r\n\tthis.isOpen = false\r\n\r\n\t// alert(this.sheetDiv)\r\n}\r\n\r\nSliderBarRender.prototype.init = function (sliderBarDiv, sheetTableDiv) {\r\n\r\n\tvar toggleDiv = document.createElement('div')\r\n\r\n\t// sliderBarDiv.style = style.SliderBarStyle\r\n\r\n\t// if(this.isOpen){\r\n\t// \tsheetTableDiv.style.width = '75%'\r\n\t// \tsliderBarDiv.style.width = '25%'\r\n\t// }else{\r\n\t// \tsheetTableDiv.style.width = '100%'\r\n\t// \tsliderBarDiv.style.width = '0'\r\n\t// }\r\n\r\n\t// console.log(this.sheet)\r\n\trenderBar(sliderBarDiv, sheetTableDiv)\r\n\trenderToggle(this.sheetDiv, toggleDiv)\r\n\r\n\tvar isOpen = this.isOpen\r\n\tvar sheetDiv = this.sheetDiv\r\n\r\n\ttoggleDiv.onclick = function () {\r\n\t\tisOpen = !isOpen\r\n\r\n\t\trenderBar(sliderBarDiv, sheetTableDiv, isOpen)\r\n\t\trenderToggle(sheetDiv, toggleDiv, isOpen)\r\n\t}\r\n}\r\n\r\nfunction renderToggle(sheetDiv, toggleDiv, isOpen) {\r\n\tvar iconHtmlMap = config.SlideBarConfig.iconHtmlMap\r\n\tvar toggleOpenIcon = config.SlideBarConfig.toggleOpenIcon\r\n\tvar toggleCloseIcon = config.SlideBarConfig.toggleCloseIcon\r\n\r\n\t// var toggleDiv = document.createElement('div')\r\n\r\n\tif(isOpen){\r\n\r\n\t\ttoggleDiv.innerHTML = iconHtmlMap[toggleCloseIcon]\r\n\t\ttoggleDiv.style = style.ToggleDivOpenLeft + style.ToggleDivStyle\r\n\r\n\t\ttoggleDiv.onmouseover = function () {\r\n\t\t\ttoggleDiv.style = style.ToggleDivOpenLeft + style.ToggleDivHoverStyle\r\n\t\t}\r\n\r\n\t\ttoggleDiv.onmouseout = function () {\r\n\t\t\ttoggleDiv.style = style.ToggleDivOpenLeft + style.ToggleDivStyle\r\n\t\t\t// toggleDiv.style.left = '76%'\r\n\t\t}\r\n\t}else{\r\n\r\n\t\ttoggleDiv.innerHTML = iconHtmlMap[toggleOpenIcon]\r\n\t\ttoggleDiv.style = style.ToggleDivCloseLeft + style.ToggleDivStyle\r\n\r\n\t\ttoggleDiv.onmouseover = function () {\r\n\t\t\ttoggleDiv.style = style.ToggleDivCloseLeft + style.ToggleDivHoverStyle\r\n\t\t}\r\n\r\n\t\ttoggleDiv.onmouseout = function () {\r\n\t\t\ttoggleDiv.style = style.ToggleDivCloseLeft + style.ToggleDivStyle\r\n\t\t}\r\n\t}\r\n\r\n\t// console.log(sheet)\r\n\tsheetDiv.appendChild(toggleDiv)\r\n}\r\n\r\nfunction renderBar(sliderBarDiv, sheetTableDiv, isOpen) {\r\n\r\n\tsliderBarDiv.style = style.SliderBarStyle\r\n\r\n\tif(isOpen){\r\n\t\tsheetTableDiv.style.width = '75%'\r\n\t\tsliderBarDiv.style.width = '25%'\r\n\t}else{\r\n\t\tsheetTableDiv.style.width = '100%'\r\n\t\tsliderBarDiv.style.width = '0'\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports.SliderBarRender = SliderBarRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SliderBarRender.js\n// module id = 11\n// module chunks = 0","/**\r\n * 工具栏对象\r\n */\r\nvar configModule = require('config')\r\n\r\nvar ToolConfig = configModule.ToolConfig\r\n\r\nvar Tool = function () {\r\n    this.width = ToolConfig.width\r\n    this.height = ToolConfig.height\r\n}\r\n\r\nmodule.exports.Tool = Tool\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Tool.js\n// module id = 12\n// module chunks = 0","/**\r\n * 工具栏事件\r\n */\r\nvar config = require('config')\r\n\r\n\r\n// var CellRenderModule = require('CellRender')\r\n// var CellRender = CellRenderModule.CellRender\r\n// var cellRender = null\r\n\r\nvar SheetEventHandlerModule = require('SheetEventHandler')\r\nvar SheetEventHandler = SheetEventHandlerModule.SheetEventHandler\r\nvar sheetEventHandler = null\r\n\r\nvar ToolEventHandler = function (sheet) {\r\n    this.sheet = sheet\r\n    // cellRender = new CellRender(sheet)\r\n    sheetEventHandler = new SheetEventHandler(sheet)\r\n}\r\nToolEventHandler.prototype.buttonClick = function (action, value) {\r\n    var sheet = this.sheet\r\n    switch (action) {\r\n        case \"wrapText\":\r\n            var lastCellId = this.sheet.lastCellid\r\n            if (!sheet.cells[lastCellId]) {\r\n                sheet.setAttr('wrapText', true)\r\n            }\r\n            else {\r\n                sheet.setAttr('wrapText', !this.sheet.cells[lastCellId].wrapText)\r\n            }\r\n            sheet.render()\r\n            break\r\n        case \"preview\":\r\n            var e = this.sheet.cells\r\n            if (JSON.stringify(e) !== \"{}\") {\r\n                var needEditCells = []\r\n                for (var key in e) {\r\n                    if (e[key][\"content\"] != '' && e[key][\"content\"].indexOf('=') == 0) {\r\n                        var formula = {\r\n                            'coord': key,\r\n                            'value': e[key][\"content\"]\r\n                        }\r\n                        needEditCells.push(formula)\r\n                        this.sheet.cells[key][\"formula\"] = e[key][\"content\"]\r\n                    }\r\n                }\r\n                if (needEditCells.length > 0) {\r\n                    var ajax\r\n                    if (window.XMLHttpRequest) {\r\n                        ajax = new XMLHttpRequest()\r\n                    } else if (window.ActiveXObject) {\r\n                        ajax = new window.ActiveXObject()\r\n                    } else {\r\n                        alert(\"请升级至最新版本的浏览器\")\r\n                    }\r\n                    if (ajax !== null) {\r\n                        ajax.open(\"POST\", \"http://localhost:8088/qianmo-service/changeContent\", true)\r\n                        needEditCells = JSON.stringify(needEditCells)\r\n                        ajax.send(needEditCells)\r\n                        ajax.onreadystatechange = function () {\r\n                            if (ajax.readyState == 4 && ajax.status == 200) {\r\n                                var CellList = JSON.parse(ajax.responseText)\r\n                                for (var key in CellList) {\r\n                                    var value = CellList[key].value.substring(1)\r\n                                    if (value.indexOf(\"+\") != -1) {\r\n                                        var result = 0\r\n                                        var values = value.split(\"+\")\r\n                                        for (var v in values) {\r\n                                            result += parseInt(values[v])\r\n                                        }\r\n                                        value = result\r\n                                    }\r\n                                    e[CellList[key].coord][\"content\"] = value\r\n                                }\r\n                                config.WSConfig.isPreview = true\r\n                                var WSManagerModule = require('WSManager')\r\n                                var WSManager = WSManagerModule.WSManager\r\n                                var newWsManager = new WSManager()\r\n                                var parentNode = document.getElementById('QianMoApp2')\r\n                                // parentNode.firstChild.remove()\r\n                                newWsManager.init(parentNode)\r\n                                for (var key in e) {\r\n                                    for (var key1 in e[key]) {\r\n                                        if (key1 !== \"formula\") {\r\n                                            sheet.renderCell(key,key1, e[key][key1])\r\n                                        }\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }else{\r\n                    config.WSConfig.isPreview = true\r\n                    var WSManagerModule = require('WSManager')\r\n                    var WSManager = WSManagerModule.WSManager\r\n                    var newWsManager = new WSManager()\r\n                    var parentNode = document.getElementById('QianMoApp2')\r\n                    // parentNode.firstChild.remove()\r\n                    newWsManager.init(parentNode)\r\n                    for (var key in e) {\r\n                        for (var key1 in e[key]) {\r\n                            if (key1 !== \"formula\") {\r\n                                sheet.renderCell(key,key1, e[key][key1])\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                document.getElementById('QianMoApp').style.display='none'\r\n                document.getElementById('QianMoApp2').style.display='inline'\r\n            } else {\r\n                alert(\"无内容，不允许预览！\")\r\n            }\r\n\r\n            console.log(this.sheet.cells)\r\n            break\r\n        case \"Edit\":\r\n            document.getElementById('QianMoApp2').style.display='none'\r\n            document.getElementById('QianMoApp').style.display='inline'\r\n            console.log(this.sheet.cells)\r\n            config.WSConfig.isPreview = false\r\n            var WSManagerModule = require('WSManager')\r\n            var WSManager = WSManagerModule.WSManager\r\n            var newWsManager = new WSManager()\r\n            var parentNode = document.getElementById('QianMoApp')\r\n            parentNode.firstChild.remove()\r\n            newWsManager.init(parentNode)\r\n            var e = sheet.cells\r\n            console.log(e)\r\n            for (var key in e) {\r\n                var cells=sheet.getColAndRow(key,key)\r\n                for (var key1 in e[key]) {\r\n                    if (key1 === \"formula\" && e[key][key1] !== \"\") {\r\n                        // cellRender.renderCell(key, \"content\", e[key][key1])\r\n                        sheet.setAttr('content', e[key][key1],cells)\r\n                        sheet.render()\r\n                    } else {\r\n                        // cellRender.renderCell(key, key1, e[key][key1])\r\n                        sheet.setAttr(key1, e[key][key1],cells)\r\n                        sheet.render()\r\n                    }\r\n\r\n                }\r\n            }\r\n            break\r\n        case \"Down\":\r\n            var e = this.sheet.cells\r\n            console.log(e)\r\n            var a = {}\r\n            var CellList = []\r\n            for (var key in e) {\r\n                e[key][\"area\"] = e[key][\"area\"].split(\"_\")[0] + e[key][\"area\"].split(\"_\")[1]\r\n                    + e[key][\"area\"].split(\"_\")[2]\r\n                e[key][\"area\"] = e[key][\"area\"].split(\":\")[0] + \"-\" + e[key][\"area\"].split(\":\")[1]\r\n                var addCell = {\r\n                    \"cellName\": key.split(\"_\")[0] + key.split(\"_\")[1],\r\n                    \"area\": e[key][\"area\"],\r\n                    \"content\": e[key][\"content\"] === undefined ? \"\" : e[key][\"content\"],\r\n                    \"format\": e[key][\"format\"] === undefined ? \"\" : e[key][\"format\"],\r\n                    \"font\": e[key][\"font\"] === undefined ? \"\" : e[key][\"font\"],\r\n                    \"fontSize\": e[key][\"fontSize\"] === undefined ? \"\" : e[key][\"fontSize\"],\r\n                    \"foregroundColor\": e[key][\"foregroundColor\"] === undefined ? \"\" : e[key][\"foregroundColor\"],\r\n                    \"backgroundColor\": e[key][\"backgroundColor\"] === undefined ? \"\" : e[key][\"backgroundColor\"],\r\n                    \"formula\": e[key][\"formula\"] === undefined ? \"\" : e[key][\"formula\"],\r\n                    \"leftFrame\": e[key][\"leftFrame\"] === undefined ? \"\" : e[key][\"leftFrame\"],\r\n                    \"topFrame\": e[key][\"topFrame\"] === undefined ? \"\" : e[key][\"topFrame\"],\r\n                    \"rightFrame\": e[key][\"rightFrame\"] === undefined ? \"\" : e[key][\"rightFrame\"],\r\n                    \"bottomFrame\": e[key][\"bottomFrame\"] === undefined ? \"\" : e[key][\"bottomFrame\"],\r\n                    \"indentation\": e[key][\"indentation\"] === undefined ? \"\" : e[key][\"indentation\"],\r\n                    \"alignment\": e[key][\"alignment\"] === undefined ? \"\" : e[key][\"alignment\"],\r\n                    \"bold\": e[key][\"bold\"] === undefined ? \"\" : e[key][\"bold\"],\r\n                    \"italic\": e[key][\"italic\"] === undefined ? \"\" : e[key][\"italic\"]\r\n                }\r\n\r\n                CellList.push(addCell)\r\n            }\r\n            var json= JSON.stringify(CellList)\r\n            var ajax\r\n            if (window.XMLHttpRequest) {\r\n                ajax = new XMLHttpRequest()\r\n            } else if (window.ActiveXObject) {\r\n                ajax = new window.ActiveXObject()\r\n            } else {\r\n                alert(\"请升级至最新版本的浏览器\")\r\n            }\r\n            if(ajax !=null){\r\n                ajax.open(\"POST\",\"http://localhost:8088/qianmo-service/excelDownload\",true)\r\n                ajax.onload=function(){\r\n                    if(ajax.status==200){\r\n                        var filename = \"\";\r\n                        console.log(ajax.getResponseHeader)\r\n                        var disposition = ajax.getResponseHeader('Content-Disposition');\r\n                        if (disposition && disposition.indexOf('attachment') !== -1) {\r\n                            var filenameRegex = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\r\n                            var matches = filenameRegex.exec(disposition);\r\n                            if (matches != null && matches[1]) filename = matches[1].replace(/['\"]/g, '');\r\n                        }\r\n                        var type = ajax.getResponseHeader('Content-Type');\r\n                        var blob = new Blob([this.response], { type: type });\r\n                        if (typeof window.navigator.msSaveBlob !== 'undefined') {\r\n                            // IE workaround for \"HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed.\"\r\n                            window.navigator.msSaveBlob(blob, filename);\r\n                        } else {\r\n                            var URL = window.URL || window.webkitURL;\r\n                            var downloadUrl = URL.createObjectURL(blob);\r\n                            console.log(downloadUrl)\r\n                            if (filename) {\r\n                                // use HTML5 a[download] attribute to specify filename\r\n                                var a = document.createElement(\"a\");\r\n                                // safari doesn't support this yet\r\n                                if (typeof a.download === 'undefined') {\r\n                                    window.location = downloadUrl;\r\n                                } else {\r\n                                    a.href = downloadUrl;\r\n                                    a.download = filename;\r\n                                    console.log(a)\r\n                                    document.body.appendChild(a);\r\n                                    a.click();\r\n                                }\r\n                            } else {\r\n                                window.location = downloadUrl;\r\n                            }\r\n\r\n                            setTimeout(function () { URL.revokeObjectURL(downloadUrl); }, 100); // cleanup\r\n                        }\r\n                    }\r\n                    document.getElementById('statu').innerHTML='SUCCESS'\r\n                }\r\n                ajax.responseType = 'blob'\r\n                ajax.send(json)\r\n            }\r\n            break\r\n        case  \"Init\":\r\n            var parentNode = document.getElementById(\"QianMoApp\")\r\n            var param = parentNode.getAttribute(\"url\")\r\n            var url = ''\r\n            var method=\"GET\"\r\n            if(!param&& param!=''){\r\n                url='json.json'\r\n                param=null\r\n            }else{\r\n                method=\"POST\"\r\n                url='http://localhost:8088/qianmo-service/getContentJson'\r\n                param=param.substring(param.lastIndexOf(\"\\\\\")+1)\r\n            }\r\n            var ajax\r\n            if (window.XMLHttpRequest) {\r\n                ajax = new XMLHttpRequest()\r\n            } else if (window.ActiveXObject) {\r\n                ajax = new window.ActiveXObject()\r\n            } else {\r\n                alert(\"请升级至最新版本的浏览器\")\r\n            }\r\n            if (ajax !== null) {\r\n                ajax.open(method, url, true)\r\n                ajax.send(param)\r\n                ajax.onreadystatechange = function () {\r\n                    if (ajax.readyState === 4 && ajax.status === 200) {\r\n                        var CellList = JSON.parse(ajax.responseText)\r\n                        console.log(CellList)\r\n                        CellList.forEach(function (e) {\r\n\r\n                            var area = e['area']\r\n                            var firstCell = e['cellName'].split('_')\r\n\r\n                            var cells = {}\r\n                            cells.firstCellCol = firstCell[0].charCodeAt(0)\r\n                            cells.firstCellRow = parseInt(firstCell[1])\r\n                            var areaSubstring = area.split('_')\r\n                            cells.lastCellCol = areaSubstring[2].charCodeAt(0)\r\n                            cells.lastCellRow = parseInt(areaSubstring[3])\r\n                            if (cells.firstCellCol !== cells.lastCellCol || cells.firstCellRow !== cells.lastCellRow) {\r\n                                sheet.setAttr('merge', true, cells)\r\n                            }\r\n\r\n\r\n                            cells.lastCellCol = firstCell[0].charCodeAt(0)\r\n                            cells.lastCellRow = parseInt(firstCell[1])\r\n\r\n\r\n                            for (var key in e) {\r\n                                switch (e[key]) {\r\n                                    case 'false':\r\n                                        var value = false\r\n                                        break\r\n                                    case 'true':\r\n                                        var value = true\r\n                                        break\r\n                                    default:\r\n                                        var value = e[key]\r\n                                }\r\n                                if ((key === 'bottomFrame' || key === 'topFrame' || key === 'leftFrame' ||\r\n                                        key === 'rightFrame') && value === false) continue\r\n\r\n                                sheet.setAttr(key, value, cells)\r\n                            }\r\n                        })\r\n\r\n                        sheet.render()\r\n                    }\r\n                }\r\n            }\r\n            break\r\n        case 'copy':\r\n            cells = sheet.editCells\r\n            sheet.firstCopiedCell = String.fromCharCode(cells.firstCellCol) + '_' + cells.firstCellRow\r\n            sheet.copiedCells = []\r\n            for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                    var id = String.fromCharCode(i) + '_' + j\r\n                    var newCell = {}\r\n                    newCell.coord = id\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        if (!sheet.cells[id]) {\r\n                            newCell[attr[0]] = attr[1]\r\n                        }\r\n                        else {\r\n                            newCell[attr[0]] = sheet.cells[id][attr[0]]\r\n                        }\r\n                    })\r\n                    if (!sheet.cells[id]) {\r\n                        newCell.bottomFrame = false\r\n                        newCell.topFrame = false\r\n                        newCell.leftFrame = false\r\n                        newCell.rightFrame = false\r\n                    }\r\n                    else {\r\n                        newCell.bottomFrame = sheet.cells[id].bottomFrame\r\n                        newCell.topFrame = sheet.cells[id].topFrame\r\n                        newCell.leftFrame = sheet.cells[id].leftFrame\r\n                        newCell.rightFrame = sheet.cells[id].rightFrame\r\n                    }\r\n                    sheet.copiedCells.push(newCell)\r\n                }\r\n            }\r\n            console.log('copy done!')\r\n            break\r\n        case 'cut':\r\n            cells = sheet.editCells\r\n            sheet.firstCopiedCell = String.fromCharCode(cells.firstCellCol) + '_' + cells.firstCellRow\r\n            sheet.copiedCells = []\r\n            for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                    var id = String.fromCharCode(i) + '_' + j\r\n                    var newCell = {}\r\n                    newCell.coord = id\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        if (!sheet.cells[id]) {\r\n                            newCell[attr[0]] = attr[1]\r\n                        }\r\n                        else {\r\n                            newCell[attr[0]] = sheet.cells[id][attr[0]]\r\n                        }\r\n                    })\r\n                    if (!sheet.cells[id]) {\r\n                        newCell.bottomFrame = false\r\n                        newCell.topFrame = false\r\n                        newCell.leftFrame = false\r\n                        newCell.rightFrame = false\r\n                    }\r\n                    else {\r\n                        newCell.bottomFrame = sheet.cells[id].bottomFrame\r\n                        newCell.topFrame = sheet.cells[id].topFrame\r\n                        newCell.leftFrame = sheet.cells[id].leftFrame\r\n                        newCell.rightFrame = sheet.cells[id].rightFrame\r\n                    }\r\n                    sheet.copiedCells.push(newCell)\r\n                }\r\n            }\r\n            sheet.cellAttrs.forEach(function (attr) {\r\n                sheet.setAttr(attr[0], attr[1], cells)\r\n            })\r\n            sheet.setAttr('allFrame', false, cells)\r\n            sheet.render()\r\n            sheet.lastCellid = sheet.firstCellid\r\n\r\n            console.log('cut done!')\r\n            break\r\n        case 'paste':\r\n            var borders = [['bottomFrame', false], ['leftFrame', false], ['topFrame', false], ['rightFrame', false]]\r\n            if (sheet.firstCopiedCell) {\r\n                cells = sheet.editCells\r\n                sheet.copiedCells.forEach(function (cell) {\r\n                    var newCell = {}\r\n                    var firstCopiedCellCol = sheet.firstCopiedCell.split('_')[0].charCodeAt(0)\r\n                    var firstCopiedCellRow = parseInt(sheet.firstCopiedCell.split('_')[1])\r\n                    cellCol = cell.coord.split('_')[0].charCodeAt(0)\r\n                    cellRow = parseInt(cell.coord.split('_')[1])\r\n                    newCell.firstCellCol = cells.firstCellCol + cellCol - firstCopiedCellCol\r\n                    newCell.firstCellRow = cells.firstCellRow + cellRow - firstCopiedCellRow\r\n                    newCell.lastCellCol = newCell.firstCellCol\r\n                    newCell.lastCellRow = newCell.firstCellRow\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        sheet.setAttr(attr[0], cell[attr[0]], newCell)\r\n                    })\r\n                    borders.forEach(function (frame) {\r\n                        sheet.setAttr(frame[0], cell[frame[0]], newCell)\r\n                    })\r\n                    delete newCell\r\n                })\r\n                sheet.render()\r\n                console.log('paste done!')\r\n                console.log(sheet.cells)\r\n            } else {\r\n                console.log('nothing to paste')\r\n            }\r\n            break\r\n        case 'font':\r\n            sheet.setAttr('font', value)\r\n            sheet.render()\r\n            break\r\n        case 'fontSize':\r\n            sheet.setAttr('fontSize', value)\r\n            sheet.render()\r\n            break\r\n        case 'bold':\r\n            var lastCellId = sheet.lastCell.id\r\n            if (!sheet.cells[lastCellId]) {\r\n                sheet.setAttr('bold', true)\r\n            }\r\n            sheet.setAttr('bold', !sheet.cells[lastCellId].bold)\r\n            sheet.render()\r\n            break\r\n        case 'italic':\r\n            var lastCellId = sheet.lastCell.id\r\n            if (!sheet.cells[lastCellId]) {\r\n                sheet.setAttr('italic', true)\r\n            }\r\n            sheet.setAttr('italic', !this.sheet.cells[lastCellId].italic)\r\n            sheet.render()\r\n            break\r\n        case 'merge':\r\n            this.setCellBackgroundColor('#fff')\r\n            this.sheet.setAttr('merge', value)\r\n            this.sheet.render()\r\n            this.mouseDown(sheet.firstCellid)\r\n            console.log(sheet.firstCellid)\r\n            this.mouseUp(document.getElementById(sheet.lastCellid))\r\n            break\r\n        // case 'border':\r\n        // switch(value){\r\n        // \tcase 'left':\r\n        // \t\tsheet.setAttr('leftFrame',false)\r\n        //             console.log('a')\r\n        // \t\tbreak\r\n        // \tcase 'top':\r\n        // \t\tsheet.setAttr('topFrame',false)\r\n        // \t\tbreak\r\n        // \tcase 'right':\r\n        // \t\tsheet.setAttr('rightFrame',false)\r\n        // \t\tbreak\r\n        // \tcase 'bottom':\r\n        // \t\tsheet.setAttr('bottomFrame',false)\r\n        // \t\tbreak\r\n        // \tcase 'clear':\r\n        // \t\tsheet.setAttr('allFrame',false)\r\n        // \t\tbreak\r\n        // \tcase 'outer':\r\n        // \t\tsheet.setAttr('leftFrame',true)\r\n        // \t\tsheet.setAttr('topFrame',true)\r\n        // \t\tsheet.setAttr('rightFrame',true)\r\n        // \t\tsheet.setAttr('bottomFrame',true)\r\n        // \t\tbreak\r\n        // \tcase 'all':\r\n        // \t\tsheet.setAttr('allFrame',true)\r\n        // \t\tbreak\r\n        //\r\n        // \t//fontBorderSelect.value='border'\r\n        // }\r\n        // sheet.render()\r\n        //     break\r\n        case 'alignment':\r\n            sheet.setAttr('alignment', value)\r\n            sheet.render()\r\n            break\r\n        case 'undo':\r\n            sheet.undo()\r\n            break\r\n        case 'redo':\r\n            sheet.redo()\r\n            break\r\n        // case 'sort':\r\n        //     break\r\n        case 'multiLine':\r\n            document.getElementById('dragBar').style.display = 'none'\r\n            sheet.isMultiLineEditing = true\r\n            var ml = document.getElementById('multiLine1')\r\n            ml.style.display = 'block'\r\n            if (sheet.cells[sheet.lastCellid]) ml.value = sheet.cells[sheet.lastCellid].content\r\n            else ml.value = ''\r\n            ml.focus()\r\n            break\r\n        case 'cleanText':\r\n            sheet.setAttr('content', '')\r\n            sheet.render()\r\n            break\r\n        case 'cleanStyle':\r\n            sheet.cellAttrs.forEach(function (attr) {\r\n                if (attr[0] !== 'content') sheet.setAttr(attr[0], attr[1])\r\n            })\r\n            sheet.render()\r\n            break\r\n        case 'cleanAll':\r\n            sheet.cellAttrs.forEach(function (attr) {\r\n                sheet.setAttr(attr[0], attr[1])\r\n            })\r\n            sheet.setAttr('allFrameEx', false)\r\n            sheet.render()\r\n            break\r\n        case 'addCol':\r\n        case 'deleteCol':\r\n            cells = sheet.getColAndRow(sheet.firstCellid.split('_')[0]+'_1',String.fromCharCode(sheet.maxCol)+'_'+sheet.maxRow)\r\n            //sheet.firstCopiedCell = String.fromCharCode(cells.firstCellCol) + '_' + cells.firstCellRow\r\n            var sheetcopiedCells = []\r\n            for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                    var id = String.fromCharCode(i) + '_' + j\r\n                    var newCell = {}\r\n                    newCell.coord = id\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        if (!sheet.cells[id]) {\r\n                            newCell[attr[0]] = attr[1]\r\n                        }\r\n                        else {\r\n                            newCell[attr[0]] = sheet.cells[id][attr[0]]\r\n                        }\r\n                    })\r\n                    if (!sheet.cells[id]) {\r\n                        newCell.bottomFrame = false\r\n                        newCell.topFrame = false\r\n                        newCell.leftFrame = false\r\n                        newCell.rightFrame = false\r\n                    }\r\n                    else {\r\n                        newCell.bottomFrame = sheet.cells[id].bottomFrame\r\n                        newCell.topFrame = sheet.cells[id].topFrame\r\n                        newCell.leftFrame = sheet.cells[id].leftFrame\r\n                        newCell.rightFrame = sheet.cells[id].rightFrame\r\n                    }\r\n                    sheetcopiedCells.push(newCell)\r\n                }\r\n            }\r\n            sheet.cellAttrs.forEach(function (attr) {\r\n                sheet.setAttr(attr[0], attr[1], cells)\r\n            })\r\n            sheet.setAttr('allFrame', false, cells)\r\n\r\n            var borders = [['bottomFrame', false], ['leftFrame', false], ['topFrame', false], ['rightFrame', false]]\r\n            if (sheetcopiedCells) {\r\n                if(action === 'deleteCol'){\r\n                    var firstCopiedCellCol = cells.firstCellCol+1\r\n                    var firstCopiedCellRow = cells.firstCellRow\r\n                }else{\r\n                    var firstCopiedCellCol = cells.firstCellCol-1\r\n                    var firstCopiedCellRow = cells.firstCellRow\r\n                }\r\n                sheetcopiedCells.forEach(function (cell) {\r\n                    var newCell = {}\r\n                    cellCol = cell.coord.split('_')[0].charCodeAt(0)\r\n                    cellRow = parseInt(cell.coord.split('_')[1])\r\n                    newCell.firstCellCol = cells.firstCellCol + cellCol - firstCopiedCellCol\r\n                    newCell.firstCellRow = cells.firstCellRow + cellRow - firstCopiedCellRow\r\n                    newCell.lastCellCol = newCell.firstCellCol\r\n                    newCell.lastCellRow = newCell.firstCellRow\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        sheet.setAttr(attr[0], cell[attr[0]], newCell)\r\n                    })\r\n                    borders.forEach(function (frame) {\r\n                        sheet.setAttr(frame[0], cell[frame[0]], newCell)\r\n                    })\r\n                    delete newCell\r\n                })\r\n                sheet.render()\r\n                console.log('addCol')\r\n            }\r\n            break\r\n        case 'addRow':\r\n        case 'deleteRow':\r\n            cells = sheet.getColAndRow('A_'+sheet.firstCellid.split('_')[1],String.fromCharCode(sheet.maxCol)+'_'+sheet.maxRow)\r\n            //sheet.firstCopiedCell = String.fromCharCode(cells.firstCellCol) + '_' + cells.firstCellRow\r\n            var sheetcopiedCells = []\r\n            for (var i = cells.firstCellCol; i <= cells.lastCellCol; i++) {\r\n                for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                    var id = String.fromCharCode(i) + '_' + j\r\n                    var newCell = {}\r\n                    newCell.coord = id\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        if (!sheet.cells[id]) {\r\n                            newCell[attr[0]] = attr[1]\r\n                        }\r\n                        else {\r\n                            newCell[attr[0]] = sheet.cells[id][attr[0]]\r\n                        }\r\n                    })\r\n                    if (!sheet.cells[id]) {\r\n                        newCell.bottomFrame = false\r\n                        newCell.topFrame = false\r\n                        newCell.leftFrame = false\r\n                        newCell.rightFrame = false\r\n                    }\r\n                    else {\r\n                        newCell.bottomFrame = sheet.cells[id].bottomFrame\r\n                        newCell.topFrame = sheet.cells[id].topFrame\r\n                        newCell.leftFrame = sheet.cells[id].leftFrame\r\n                        newCell.rightFrame = sheet.cells[id].rightFrame\r\n                    }\r\n                    sheetcopiedCells.push(newCell)\r\n                }\r\n            }\r\n            sheet.cellAttrs.forEach(function (attr) {\r\n                sheet.setAttr(attr[0], attr[1], cells)\r\n            })\r\n            sheet.setAttr('allFrame', false, cells)\r\n\r\n            var borders = [['bottomFrame', false], ['leftFrame', false], ['topFrame', false], ['rightFrame', false]]\r\n            if (sheetcopiedCells) {\r\n                if(action === 'deleteRow'){\r\n                    var firstCopiedCellCol = cells.firstCellCol\r\n                    var firstCopiedCellRow = cells.firstCellRow+1\r\n                }else{\r\n                    var firstCopiedCellCol = cells.firstCellCol\r\n                    var firstCopiedCellRow = cells.firstCellRow-1\r\n                }\r\n                sheetcopiedCells.forEach(function (cell) {\r\n                    var newCell = {}\r\n                    cellCol = cell.coord.split('_')[0].charCodeAt(0)\r\n                    cellRow = parseInt(cell.coord.split('_')[1])\r\n                    newCell.firstCellCol = cells.firstCellCol + cellCol - firstCopiedCellCol\r\n                    newCell.firstCellRow = cells.firstCellRow + cellRow - firstCopiedCellRow\r\n                    newCell.lastCellCol = newCell.firstCellCol\r\n                    newCell.lastCellRow = newCell.firstCellRow\r\n                    sheet.cellAttrs.forEach(function (attr) {\r\n                        sheet.setAttr(attr[0], cell[attr[0]], newCell)\r\n                    })\r\n                    borders.forEach(function (frame) {\r\n                        sheet.setAttr(frame[0], cell[frame[0]], newCell)\r\n                    })\r\n                    delete newCell\r\n                })\r\n                sheet.render()\r\n            }\r\n            break\r\n        default:\r\n            alert('该功能未实现，请期待')\r\n            break\r\n    }\r\n    if(action !== ('multiLine' || 'copy')){\r\n        sheetEventHandler.mouseDown(sheet.firstCellid)\r\n        sheetEventHandler.mouseUp(document.getElementById(sheet.lastCellid))\r\n    }\r\n}\r\n\r\n\r\nmodule.exports.ToolEventHandler = ToolEventHandler\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolEventHandler.js\n// module id = 13\n// module chunks = 0","/**\r\n * 工具栏渲染\r\n */\r\nvar config = require('config')\r\nvar style = require('style')\r\nvar ToolRender = function (sheet) {\r\n\tthis.sheet = sheet\r\n}\r\nToolRender.prototype.init = function (toolDiv, width, height) {\r\n\tvar ToolEventBinderModule = require('ToolEventBinder')\r\n\tvar ToolEventBinder = ToolEventBinderModule.ToolEventBinder\r\n\t// var toolEventBinder = new ToolEventBinder(this.sheet)\r\n\r\n\ttoolDiv.style.width = width\r\n\ttoolDiv.style.height = height\r\n\r\n\trenderMenu(toolDiv, this.sheet)\r\n\r\n}\r\n\r\nfunction renderMenu(toolDiv, sheet) {\r\n\tvar menuDiv = document.createElement('div')\r\n\tvar buttonBox = document.createElement('div')\r\n\r\n\tbuttonBox.style = style.ButtonBoxStyle\r\n\r\n\ttoolDiv.appendChild(menuDiv)\r\n\ttoolDiv.appendChild(buttonBox)\r\n\r\n\tvar toolMenu = config.ToolConfig.menu\r\n\r\n\tvar styleBox = document.createElement('div')\r\n\tstyleBox.innerHTML = toolMenu[0]\r\n\tvar toolBox = document.createElement('div')\r\n\ttoolBox.innerHTML = toolMenu[1]\r\n\tvar dataBox = document.createElement('div')\r\n\tdataBox.innerHTML = toolMenu[2]\r\n\r\n\tvar boxes = {\r\n\t\tstyleBox: {node: styleBox, selected: false},\r\n\t\ttoolBox: {node: toolBox, selected: false},\r\n\t\tdataBox: {node: dataBox, selected: false}\r\n\t}\r\n\r\n\tmenuDiv.style = style.MeunDivStyle\r\n\r\n\tchangeSelected(boxes, 'styleBox')\r\n\trenderTool('styleBox', buttonBox, sheet)\r\n\r\n\tstyleBox.onclick = function () {\r\n\t\tchangeSelected(boxes, 'styleBox')\r\n\t\trenderTool('styleBox', buttonBox, sheet)\r\n\t}\r\n\ttoolBox.onclick = function () {\r\n\t\tchangeSelected(boxes, 'toolBox')\r\n\t\trenderTool('toolBox', buttonBox, sheet)\r\n\t}\r\n\tdataBox.onclick = function () {\r\n\t\tchangeSelected(boxes, 'dataBox')\r\n\t\trenderTool('dataBox', buttonBox, sheet)\r\n\t}\r\n\r\n\tfor (var box in boxes) {\r\n\t\tmenuDiv.appendChild(boxes[box].node)\r\n\t}\r\n\r\n}\r\n\r\nfunction renderTool(menu, buttonBox, sheet) {\r\n\r\n\tremoveAllChild(buttonBox)\r\n\r\n\tvar ToolEventBinderModule = require('ToolEventBinder')\r\n\tvar ToolEventBinder = ToolEventBinderModule.ToolEventBinder\r\n\tvar toolEventBinder = new ToolEventBinder(sheet)\r\n\r\n\tvar cmdMap = config.ToolConfig.cmdCodeMap\r\n\tvar toolHtml = config.ToolConfig.toolHtml\r\n\tvar styleHtml = config.ToolConfig.styleHtml\r\n\tvar dataHtml = config.ToolConfig.dataHtml\r\n\tvar defaultHtml = config.ToolConfig.defaultHtml\r\n\r\n\tif (config.WSConfig.isPreview) {\r\n\t\tvar previewHtml = config.ToolConfig.previewHtml\r\n\r\n\t\tpreviewHtml.forEach(function (innerhtml) {\r\n\r\n\t\t\tvar buttonDiv = document.createElement('div')\r\n\t\t\tbuttonDiv.id = innerhtml\r\n\t\t\tbuttonDiv.style = style.ButtonDivStyle\r\n\t\t\tbuttonDiv.innerHTML = innerhtml\r\n\r\n\t\t\tbuttonDiv.onclick = function () {\r\n\t\t\t\ttoolEventBinder.buttonClick(innerhtml)\r\n\t\t\t}\r\n\t\t\tbuttonBox.appendChild(buttonDiv)\r\n\t\t})\r\n\r\n\t\treturn\r\n\t}\r\n\r\n\tdefaultHtml.forEach(function (innerhtml) {\r\n\r\n\t\tvar buttonDiv = document.createElement('div')\r\n\t\tbuttonDiv.id = innerhtml\r\n\t\tbuttonDiv.style = style.ButtonDivStyle\r\n\t\tbuttonDiv.innerHTML = cmdMap[innerhtml]\r\n\r\n\t\tbuttonDiv.onclick = function () {\r\n\t\t\ttoolEventBinder.buttonClick(innerhtml)\r\n\t\t}\r\n\t\tbuttonBox.appendChild(buttonDiv)\r\n\t})\r\n\r\n\tif (menu === 'styleBox') {\r\n\r\n\t\tfor (var i = 0; i < styleHtml.length; i++) {\r\n\r\n\t\t\tif (styleHtml[i] === 'font') {\r\n\t\t\t\trenderFont(toolEventBinder, buttonBox)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tif (styleHtml[i] === 'align') {\r\n\t\t\t\trenderAlign(toolEventBinder, buttonBox)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tif (styleHtml[i] === 'border') {\r\n\t\t\t\trenderBorder(toolEventBinder, buttonBox)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tvar styleButtonDiv = document.createElement('div')\r\n\t\t\tstyleButtonDiv.id = styleHtml[i]\r\n\t\t\tstyleButtonDiv.style = style.ButtonDivStyle\r\n\t\t\tstyleButtonDiv.innerHTML = cmdMap[styleHtml[i]]\r\n\r\n\t\t\tbuttonBox.appendChild(styleButtonDiv)\r\n\r\n\t\t\tif (styleHtml[i] === 'bold') {\r\n\t\t\t\ttoolEventBinder.initFontWeight(styleButtonDiv)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tif (styleHtml[i] === 'italic') {\r\n\t\t\t\ttoolEventBinder.initFontStyle(styleButtonDiv)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tif (styleHtml[i] === 'textColor') {\r\n\t\t\t\trenderFontColor(toolEventBinder, styleButtonDiv)\r\n\t\t\t\trenderColorSelect(toolEventBinder, buttonBox)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tif (styleHtml[i] === 'fillColor') {\r\n\t\t\t\trenderBackgroundColor(toolEventBinder, styleButtonDiv)\r\n\t\t\t\trenderColorSelect(toolEventBinder, buttonBox)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstyleButtonDiv.onclick = function (e) {\r\n\t\t\t\ttoolEventBinder.buttonClick(e.currentTarget.id)\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (menu === 'toolBox') {\r\n\r\n\t\tfor (var m = 0; m < toolHtml.length; m++) {\r\n\r\n\t\t\tvar toolButtonDiv = document.createElement('div')\r\n\t\t\ttoolButtonDiv.id = toolHtml[m]\r\n\t\t\ttoolButtonDiv.style = style.ButtonDivStyle\r\n\t\t\ttoolButtonDiv.innerHTML = cmdMap[toolHtml[m]]\r\n\r\n\t\t\tbuttonBox.appendChild(toolButtonDiv)\r\n\r\n\t\t\tif (toolHtml[m] === 'mergeCell') {\r\n\t\t\t\ttoolEventBinder.initMerge(toolButtonDiv, true)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tif (toolHtml[m] === 'splitCell') {\r\n\t\t\t\ttoolEventBinder.initMerge(toolButtonDiv, false)\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\ttoolButtonDiv.onclick = function (e) {\r\n\t\t\t\ttoolEventBinder.buttonClick(e.currentTarget.id)\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\r\n\t\tfor (var n = 0; n < dataHtml.length; n++) {\r\n\r\n\t\t\tvar dataButtonDiv = document.createElement('div')\r\n\t\t\tdataButtonDiv.id = dataHtml[n]\r\n\t\t\tdataButtonDiv.style = style.ButtonDivStyle\r\n\t\t\tdataButtonDiv.style.fontSize = '15px'\r\n\t\t\tdataButtonDiv.innerHTML = dataHtml[n]\r\n\r\n\t\t\tdataButtonDiv.onclick = function (e) {\r\n\t\t\t\tconsole.log(e.currentTarget.id)\r\n\t\t\t\ttoolEventBinder.buttonClick(e.currentTarget.id)\r\n\t\t\t}\r\n\t\t\tbuttonBox.appendChild(dataButtonDiv)\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nfunction changeSelected(boxes, selectedNode) {\r\n\r\n\tfor (var box in boxes) {\r\n\t\tboxes[box].selected = false\r\n\t}\r\n\tboxes[selectedNode].selected = true\r\n\r\n\tfor (var b in boxes) {\r\n\t\tif (boxes[b].selected) {\r\n\t\t\tboxes[b].node.style = style.MeunBoxSelectedStyle\r\n\t\t} else {\r\n\t\t\tboxes[b].node.style = style.MeunBoxStyle\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction renderFont(toolEventBinder, buttonBox) {\r\n\t//字体\r\n\tvar fontFamilySelect = document.createElement('select')\r\n\tfontFamilySelect.style.marginLeft = '10px'\r\n\tvar fontFamilyOption = ['fontFamily', 'Default', 'Custom', 'Verdana', 'Arial', 'Courier']\r\n\tfontFamilyOption.forEach(function (o) {\r\n\t\tvar option = document.createElement('option')\r\n\t\toption.innerHTML = o\r\n\t\tfontFamilySelect.appendChild(option)\r\n\t})\r\n\ttoolEventBinder.initFontFamily(fontFamilySelect)\r\n\tbuttonBox.appendChild(fontFamilySelect)\r\n\r\n\t//字体大小\r\n\tvar fontSizeSelect = document.createElement('select')\r\n\tfontSizeSelect.style.marginLeft = '10px'\r\n\tvar fontSizeOption = ['fontSize', 'Default', 'X-Small', 'Small', 'Medium', 'Large',\r\n\t\t'X-Large', '6pt', '7pt', '8pt', '9pt', '10pt', '11pt', '12pt', '14pt', '16pt', '18pt',\r\n\t\t'20pt', '22pt', '24pt', '28pt', '36pt', '48pt', '72pt']\r\n\tfontSizeOption.forEach(function (o) {\r\n\t\tvar option = document.createElement('option')\r\n\t\toption.innerHTML = o\r\n\t\tfontSizeSelect.appendChild(option)\r\n\t})\r\n\ttoolEventBinder.initFontSize(fontSizeSelect)\r\n\tbuttonBox.appendChild(fontSizeSelect)\r\n}\r\n\r\nfunction renderBorder(toolEventBinder, buttonBox) {\r\n\tvar borderHtml = config.ToolConfig.borderHtml\r\n\tvar cmdMap = config.ToolConfig.cmdCodeMap\r\n\tvar borderButton = []\r\n\tvar i\r\n\r\n\tfor (i = 0; i < borderHtml.length; i++) {\r\n\t\tvar borderButtonDiv = document.createElement('div')\r\n\t\tborderButtonDiv.id = borderHtml[i]\r\n\t\tborderButtonDiv.style = style.ButtonDivStyle\r\n\t\tborderButtonDiv.innerHTML = cmdMap[borderHtml[i]]\r\n\r\n\t\tbuttonBox.appendChild(borderButtonDiv)\r\n\t\tborderButton.push(borderButtonDiv)\r\n\t}\r\n\r\n\tfor (i = 0; i < borderButton.length; i++) {\r\n\t\tborderButton[i].onclick = function (e) {\r\n\t\t\tfor (var j = 0; j < borderButton.length; j++) {\r\n\t\t\t\tborderButton[j].style = style.ButtonDivStyle\r\n\t\t\t}\r\n\r\n\t\t\tvar fontBorderOption = config.ToolConfig.fontBorderOption\r\n\t\t\ttoolEventBinder.initFontBorder(fontBorderOption[e.currentTarget.id])\r\n\r\n\t\t\te.currentTarget.style = style.ButtonDivSelectedStyle\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction renderAlign(toolEventBinder, buttonBox) {\r\n\tvar alignHtml = config.ToolConfig.alignHtml\r\n\tvar cmdMap = config.ToolConfig.cmdCodeMap\r\n\tvar alignButton = []\r\n\tvar i\r\n\r\n\tfor (i = 0; i < alignHtml.length; i++) {\r\n\t\tvar alignButtonDiv = document.createElement('div')\r\n\t\talignButtonDiv.id = alignHtml[i]\r\n\t\talignButtonDiv.style = style.ButtonDivStyle\r\n\t\talignButtonDiv.innerHTML = cmdMap[alignHtml[i]]\r\n\r\n\t\tbuttonBox.appendChild(alignButtonDiv)\r\n\t\talignButton.push(alignButtonDiv)\r\n\t}\r\n\r\n\tfor (i = 0; i < alignButton.length; i++) {\r\n\t\talignButton[i].onclick = function (e) {\r\n\t\t\tfor (var j = 0; j < alignButton.length; j++) {\r\n\t\t\t\talignButton[j].style = style.ButtonDivStyle\r\n\t\t\t}\r\n\r\n\t\t\tvar alignOption = config.ToolConfig.alignOption\r\n\t\t\ttoolEventBinder.initTextAlign(alignOption[e.currentTarget.id])\r\n\r\n\t\t\te.currentTarget.style = style.ButtonDivSelectedStyle\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction renderFontColor(toolEventBinder, styleButtonDiv) {\r\n\t//color,字体颜色\r\n\t// var colorDiv = document.createElement('div')\r\n\t// colorDiv.style = style.ColorDivStyle\r\n\t// buttonBox.appendChild(colorDiv)\r\n\ttoolEventBinder.initColor(styleButtonDiv)\r\n}\r\n\r\nfunction renderBackgroundColor(toolEventBinder, styleButtonDiv) {\r\n\r\n\t//backgroundColor背景颜色\r\n\t// var backgroundColorDiv = document.createElement('div')\r\n\t// backgroundColorDiv.style = style.backgroundColorDivStyle\r\n\t// buttonBox.appendChild(backgroundColorDiv)\r\n\ttoolEventBinder.initBackgroundColor(styleButtonDiv)\r\n}\r\n\r\nfunction renderColorSelect(toolEventBinder, buttonBox) {\r\n\tvar colorSelectDiv = document.createElement(\"div\")\r\n\tcolorSelectDiv.id = 'colorSelect'\r\n\tcolorSelectDiv.style = style.ColorSelectDivStyle\r\n\t// colorSelectDiv.style.display = 'none'\r\n\t// colorSelectDiv.style.position = \"absolute\"\r\n\t// colorSelectDiv.style.zIndex = 100\r\n\t// colorSelectDiv.style.backgroundColor = \"#FFF\"\r\n\t// colorSelectDiv.style.border = \"1px solid black\"\r\n\t// colorSelectDiv.style.width = '106px'\r\n\tbuttonBox.appendChild(colorSelectDiv)\r\n\r\n\tvar mainDiv = document.createElement(\"div\")\r\n\t// mainDiv.style.padding = \"3px\"\r\n\t// mainDiv.style.backgroundColor = \"#CCC\"\r\n\tcolorSelectDiv.appendChild(mainDiv)\r\n\r\n\tvar mainTable = document.createElement(\"table\")\r\n\tmainTable.cellSpacing = 0\r\n\tmainTable.cellPadding = 0\r\n\tmainTable.style.width = \"100px\"\r\n\tmainDiv.appendChild(mainTable)\r\n\r\n\tvar mainTbody = document.createElement(\"tbody\")\r\n\tmainTable.appendChild(mainTbody)\r\n\tvar steps = [0, 68, 153, 204, 255]\r\n\tvar commonRgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"]\r\n\r\n\tfor (var row = 0; row < 16; row++) {\r\n\t\tvar tr = document.createElement(\"tr\")\r\n\t\tfor (var col = 0; col < 5; col++) {\r\n\t\t\tvar td = document.createElement(\"td\")\r\n\t\t\ttoolEventBinder.initColorSelect(td)\r\n\t\t\ttd.style.fontSize = \"1px\"\r\n\t\t\ttd.innerHTML = \"&nbsp;\"\r\n\t\t\ttd.style.height = \"10px\"\r\n\t\t\ttd.style.lineHeight = '12px'\r\n\t\t\tif (col <= 1) {\r\n\t\t\t\ttd.style.width = \"17px\"\r\n\t\t\t\ttd.style.borderRight = \"3px solid white\"\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttd.style.width = \"20px\"\r\n\t\t\t\ttd.style.backgroundRepeat = \"no-repeat\"\r\n\t\t\t}\r\n\t\t\tif (col === 0) {\r\n\t\t\t\tvar x = commonRgb[row]\r\n\t\t\t\ttd.style.backgroundColor = \"rgb(\" + steps[x.charAt(0) - 0] + \",\" + steps[x.charAt(1) - 0] + \",\" + steps[x.charAt(2) - 0] + \")\"\r\n\t\t\t}\r\n\t\t\tif (col === 1) {\r\n\t\t\t\ttd.style.backgroundColor = makeRGB(17 * (15 - row), 17 * (15 - row), 17 * (15 - row))\r\n\t\t\t}\r\n\t\t\tif (col === 2) {\r\n\t\t\t\ttd.style.backgroundColor = makeRGB(17 * (15 - row), 0, 0)\r\n\t\t\t}\r\n\t\t\tif (col === 3) {\r\n\t\t\t\ttd.style.backgroundColor = makeRGB(0, 17 * (15 - row), 0)\r\n\t\t\t}\r\n\t\t\tif (col === 4) {\r\n\t\t\t\ttd.style.backgroundColor = makeRGB(0, 0, 17 * (15 - row))\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td)\r\n\t\t}\r\n\t\tmainTbody.appendChild(tr)\r\n\t}\r\n\tmainTable.appendChild(mainTbody)\r\n}\r\n\r\nfunction makeRGB(r, g, b) {\r\n\treturn \"rgb(\" + (r > 0 ? r : 0) + \",\" + (g > 0 ? g : 0) + \",\" + (b > 0 ? b : 0) + \")\"\r\n}\r\n\r\nfunction removeAllChild(node) {\r\n\r\n\twhile (node.hasChildNodes()) {\r\n\t\tnode.removeChild(node.firstChild)\r\n\t}\r\n}\r\n\r\nmodule.exports.ToolRender = ToolRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolRender.js\n// module id = 14\n// module chunks = 0","/**\r\n *  堆栈对象\r\n */\r\nvar UndoStack = function () {\r\n\r\n    this.tos = -1\r\n    //this.maxRedo = 0\r\n    this.maxUndo = 50\r\n    this.stack = []\r\n\r\n}\r\nUndoStack.prototype.pushStep = function (stack) {\r\n    while(this.stack.length > this.tos+1) this.stack.pop()\r\n    this.stack.push(stack)\r\n    if(this.stack.length > this.maxUndo) this.stack.shift()\r\n    else this.tos++\r\n}\r\nUndoStack.prototype.reDo = function () {\r\n    if (this.tos < this.stack.length-1){\r\n        this.tos ++\r\n        var result = this.stack[this.tos]\r\n    }\r\n    else result = null\r\n    return result\r\n}\r\nUndoStack.prototype.unDo = function () {\r\n    if (this.tos > -1){\r\n        var result = this.stack[this.tos]\r\n        this.tos --\r\n    }\r\n    else result = null\r\n    return result\r\n}\r\nmodule.exports.UndoStack = UndoStack\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/UndoStack.js\n// module id = 15\n// module chunks = 0","/**\r\n * 工作区域渲染\r\n * @param wsManager\r\n * @param parentNode\r\n * @constructor\r\n */\r\n\r\n\r\nvar WSRender = function (wsManager, parentNode) {\r\n\tthis.manager = wsManager\r\n\tthis.parNode = parentNode\r\n}\r\n\r\nWSRender.prototype.init = function () {\r\n\tvar ws = this.manager.workspace\r\n\r\n\t//workspace\r\n\tvar WSDiv = document.createElement('div')\r\n\t// WSDiv.style.width = ws.width + 'px'\r\n\t// WSDiv.style.height = ws.height + 'px'\r\n\tWSDiv.style = require('style').WSStyle\r\n\tthis.parNode.appendChild(WSDiv)\r\n\r\n\t//tool\r\n\tvar ToolRenderModule = require('ToolRender')\r\n\tvar ToolRender = ToolRenderModule.ToolRender\r\n\tvar toolRender = new ToolRender(ws.Sheet)\r\n\tvar tool = ws.Tool\r\n\tvar toolDiv = document.createElement('div')\r\n\ttoolRender.init(toolDiv, tool.width, tool.height)\r\n\tWSDiv.appendChild(toolDiv)\r\n\r\n\t//sheet\r\n\tvar SheetRenderModule = require('SheetRender')\r\n\tvar SheetRender = SheetRenderModule.SheetRender\r\n\tvar sheetRender = new SheetRender(ws.Sheet)\r\n\tvar sheet = ws.Sheet\r\n\tvar sheetDiv = document.createElement('div')\r\n\tsheetRender.init(sheetDiv)\r\n\tWSDiv.appendChild(sheetDiv)\r\n\r\n\t//slideBar\r\n\t// var SliderBarRenderModule = require('SliderBarRender')\r\n\t// var SliderBarRender = SliderBarRenderModule.SliderBarRender\r\n\t// var sliderBarRender = new SliderBarRender(ws.Sheet)\r\n\t// var sliderBar = ws.SliderBar\r\n\t// var sliderBarDiv = document.createElement('div')\r\n\t// sliderBarRender.init(sliderBarDiv)\r\n\t// WSDiv.appendChild(sliderBarDiv)\r\n\r\n}\r\nmodule.exports.WSRender = WSRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSRender.js\n// module id = 16\n// module chunks = 0","/**\r\n * 工作区对象，包括工具栏，表格等\r\n * @type {*}\r\n */\r\nvar config= require('config')\r\n\r\nvar Workspace = function (Tool, Sheet, SliderBar) {\r\n\r\n    this.width = config.WSConfig.width\r\n    this.height = config.WSConfig.height\r\n\r\n    this.Tool =Tool\r\n    this.Sheet= Sheet\r\n    this.SliderBar = SliderBar\r\n}\r\n\r\nmodule.exports.Workspace = Workspace\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Workspace.js\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}