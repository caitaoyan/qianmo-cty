{"version":3,"sources":["webpack:///webpack/bootstrap 7c9b0ae5deff1a98ac87","webpack:///./config/config.js","webpack:///./component/Util.js","webpack:///./component/WSManager.js","webpack:///./app.js","webpack:///./component/Cell.js","webpack:///./component/Sheet.js","webpack:///./component/SheetEventBinder.js","webpack:///./component/SheetEventHandler.js","webpack:///./component/SheetRender.js","webpack:///./component/Tool.js","webpack:///./component/ToolEventBinder.js","webpack:///./component/ToolEventHandler.js","webpack:///./component/ToolRender.js","webpack:///./component/UndoStack.js","webpack:///./component/WSRender.js","webpack:///./component/Workspace.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC3IA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wB;;;;;;AChCA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oC;;;;;;ACpCA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;;;ACVA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,0B;;;;;;ACnBA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,+CAA+C;;AAE/C,4B;;;;;;ACzBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gD;;;;;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,wBAAwB;AACxE;AACA,oDAAoD,wBAAwB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C;AACA,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oD;;;;;;ACzRA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA,cAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kBAAkB,WAAW,UAAU,UAAU,wBAAwB;AACtG;AACA;AACA;AACA;AACA;;AAEA,wC;;;;;;AC9IA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,0B;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8C;;;;;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb,6CAA6C,qBAAqB;AAClE,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA,4CAA4C,wBAAwB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iCAAiC;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,iCAAiC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,oBAAoB,SAAS;AAC7B,2BAA2B,WAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,qBAAqB;AACtD,wCAAwC,wBAAwB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA,kD;;;;;;AChMA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ,QAAQ,QAAQ,QAAQ;AACxE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,mBAAmB,QAAQ;AAC3B;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sC;;;;;;ACrMA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oC;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kC;;;;;;ACtCA;AACA;AACA,UAAU;AACV;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7c9b0ae5deff1a98ac87","/**\r\n * 配置文件，主要是个各类属性默认值\r\n * 整张表命名为：sheet\r\n * 表格上半部分叫做：sheetTool\r\n * 表格叫做：sheetGrid\r\n *\r\n */\r\n\r\n/**\r\n * 整张表-Sheet的属性默认值\r\n *\r\n */\r\nvar WSConfig = {\r\n\theight: 600,\r\n\twidth: 1030,\r\n\tisMouseDown:false,\r\n\tisKeyDown:true,\r\n\tisEditing:false,\r\n\teditCell:null,\r\n\tisFont:false\r\n}\r\n\r\n/**\r\n * 表头-SheetTool的属性默认值\r\n *\r\n */\r\nvar ToolConfig = {\r\n\theight: 40,\r\n\twidth: WSConfig.width\r\n}\r\n\r\n/**\r\n * 单元格-Cell属性默认值\r\n *\r\n */\r\nvar CellConfig = {\r\n\theight: 20,\r\n\twidth: 100\r\n}\r\n\r\n/**\r\n * 表单-SheetGrid的属性默认值\r\n *\r\n */\r\nvar SheetConfig = {\r\n\theight: WSConfig.height - ToolConfig.height,\r\n\twidth: WSConfig.width,\r\n\theadWidth: 30,\r\n\theadHeight: 25,\r\n\r\n\trowNum: (WSConfig.height - ToolConfig.height-30)/CellConfig.height,\r\n\tcolNum: (WSConfig.width-30)/CellConfig.width\r\n}\r\nvar keyboardTables = {\r\n\r\n\tspecialKeysCommon: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tspecialKeysIE: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysIE: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysOpera: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n\t\t45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n\t\t46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n\t\t113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysOpera: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysSafari: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n\t\t63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n\t\t63277: \"[pgdn]\", 63237: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysSafari: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysSafari: {\r\n\t\t63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n\t\t63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n\t},\r\n\r\n\tspecialKeysFirefox: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysFirefox: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysFirefox: {\r\n\t\t16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n\t\t91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n\t\t117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n\t\t144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n\t}\r\n}\r\n\r\n/**\r\n * 输出模块\r\n *\r\n */\r\nmodule.exports.WSConfig = WSConfig\r\nmodule.exports.ToolConfig = ToolConfig\r\nmodule.exports.SheetConfig = SheetConfig\r\nmodule.exports.CellConfig = CellConfig\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/config.js\n// module id = 0\n// module chunks = 0","var Util=function(){\r\n\r\n}\r\n/**\r\n * 将第一个单元格和最后一个单元格进行排序\r\n * @param firstCell\r\n * @param lastCell\r\n * @returns {*}\r\n */\r\nUtil.prototype.getColAndRow=function(firstCell,lastCell){\r\n    var result=null\r\n    if(firstCell&&firstCell.id&&lastCell&&lastCell.id) {\r\n        result=new Object()\r\n        result.firstCellCol = firstCell.id.split('_')[0].charCodeAt(0)\r\n        result.firstCellRow = parseInt(firstCell.id.split('_')[1])\r\n        result.lastCellCol = lastCell.id.split('_')[0].charCodeAt(0)\r\n        result.lastCellRow = parseInt(lastCell.id.split('_')[1])\r\n        if( result.firstCellCol> result.lastCellCol){\r\n            var newFirstCellCol=result.firstCellCol\r\n            result.firstCellCol=result.lastCellCol\r\n            result.lastCellCol=newFirstCellCol\r\n        }\r\n        if( result.firstCellRow> result.lastCellRow){\r\n            var newFirstCellRow=result.firstCellRow\r\n            result.firstCellRow=result.lastCellRow\r\n            result.lastCellRow=newFirstCellRow\r\n        }\r\n\r\n    }\r\n    return result\r\n}\r\n\r\nmodule.exports.Util=Util\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Util.js\n// module id = 1\n// module chunks = 0","/**\r\n * 整体工作管理对象\r\n * @constructor\r\n */\r\nvar WSManager = function () {}\r\n\r\nWSManager.prototype.init = function (parentNode) {\r\n\r\n    //实例化初始化Tool对象\r\n    var ToolModule = require('Tool')\r\n    var Tool=ToolModule.Tool\r\n    var tool=new Tool()\r\n\r\n    //实例化初始化UndoStack对象\r\n    var UndoStackModule =require('UndoStack')\r\n    var UndoStack = UndoStackModule.UndoStack\r\n    var undoStack = new UndoStack()\r\n\r\n    //实例化初始化Sheet对象\r\n    var SheetModule = require('Sheet')\r\n    var Sheet =SheetModule.Sheet\r\n    var sheet=new Sheet(undoStack)\r\n\r\n    //实例化初始化Workspace对象\r\n    var WorkspaceModule = require('Workspace')\r\n    var Workspace = WorkspaceModule.Workspace\r\n    this.workspace=new Workspace(tool,sheet)\r\n\r\n    //实例化初始化WSRender对象\r\n    var WSRenderModule = require('WSRender')\r\n    var WSRender = WSRenderModule.WSRender\r\n    var wsRender=new WSRender(this,parentNode)\r\n\r\n    wsRender.init()\r\n}\r\n\r\nmodule.exports.WSManager = WSManager\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSManager.js\n// module id = 2\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\nvar WSManagerModule = require('WSManager')\r\nvar WSManager = WSManagerModule.WSManager\r\nvar wsManager=new WSManager()\r\n\r\nvar parentNode = document.getElementById('QianMoApp')\r\n\r\nwsManager.init(parentNode)\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app.js\n// module id = 3\n// module chunks = 0","/**\r\n * 单元格对象\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar cellConfig = configModule.CellConfig\r\n\r\nvar Cell = function (coord) {\r\n\r\n\t//成员属性\r\n\t//设置默认值\r\n\tthis.height = cellConfig.height\r\n\tthis.width = cellConfig.width\r\n\r\n\tthis.text = null\r\n\tthis.coord = coord\r\n}\r\n\r\nmodule.exports.Cell = Cell\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Cell.js\n// module id = 4\n// module chunks = 0","/**\r\n * 表格对象\r\n */\r\n\r\n\r\nvar configModule = require('config')\r\n\r\nvar sheetConfig = configModule.SheetConfig\r\n\r\nvar Sheet = function (UndoStack) {\r\n    this.height = sheetConfig.height\r\n    this.width = sheetConfig.width\r\n\r\n    this.headWidth = sheetConfig.headWidth\r\n    this.headHeight = sheetConfig.headHeight\r\n\r\n    this.rowNum = sheetConfig.rowNum\r\n    this.colNum = sheetConfig.colNum\r\n\r\n    this.cells = {}\r\n    this.UndoStack = UndoStack\r\n}\r\n\r\n//Sheet.prototype.addCell = function(newcell) {return this.cells[newcell.coord]=newcell}\r\n\r\nmodule.exports.Sheet = Sheet\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Sheet.js\n// module id = 5\n// module chunks = 0","//事件绑定对象\r\nvar config = require('config')\r\nvar SheetEventHandlerModule=require('SheetEventHandler')\r\nvar SheetEventHandler = SheetEventHandlerModule.SheetEventHandler\r\nvar sheetEventHandler = null\r\n\r\nvar SheetEventBinder = function (sheet) {\r\n    this.sheet=sheet\r\n    sheetEventHandler=new SheetEventHandler(sheet)\r\n    // window.onmousedown=function(){\r\n    //     document.getElementById('colorSelect').style.display='none'\r\n    // }\r\n    window.onmouseup = function(){\r\n        config.WSConfig.isMouseDown=false\r\n    }\r\n    document.onkeydown = function (event) {\r\n\r\n        if(sheetEventHandler.firstCell){\r\n            sheetEventHandler.keyDown(sheetEventHandler.firstCell,event)\r\n        }\r\n    }\r\n}\r\n\r\nSheetEventBinder.prototype.initRowTD = function(rowTD){\r\n\r\n    rowTD.onmousedown = function(){\r\n        sheetEventHandler.mouseDown(this)\r\n    }\r\n    rowTD.onmouseup = function(){\r\n        sheetEventHandler.mouseUp(this)\r\n    }\r\n    rowTD.onmousemove = function(){\r\n        if(config.WSConfig.isMouseDown) {\r\n            sheetEventHandler.mouseMove(this)\r\n        }\r\n    }\r\n    rowTD.ondblclick = function() {\r\n        sheetEventHandler.dblclick(this)\r\n    }\r\n}\r\nSheetEventBinder.prototype.initInput = function (input) {\r\n    input.onblur = function () {\r\n        sheetEventHandler.inputBlur()\r\n    }\r\n    input.onfocus = function () {\r\n        sheetEventHandler.inputFocus()\r\n    }\r\n}\r\nmodule.exports.SheetEventBinder=SheetEventBinder\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetEventBinder.js\n// module id = 6\n// module chunks = 0","//鼠标和键盘事件\r\nvar config = require('config')\r\nvar CellModule = require('Cell')\r\nvar Cell=CellModule.Cell\r\nvar UtilModule=require('Util')\r\nvar Util=UtilModule.Util\r\nvar util=new Util()\r\n\r\nvar SheetEventHandler = function (sheet) {\r\n    this.firstCell = null\r\n    this.lastCell = null\r\n    this.sheet=sheet\r\n}\r\n/**\r\n * 鼠标按下事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseDown = function(element){\r\n    this.setCellBackgroundColor('#fff')\r\n    if(element.id){\r\n        this.firstCell = element\r\n        config.WSConfig.isMouseDown=true\r\n    }\r\n}\r\n/**\r\n * 鼠标移动事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseMove = function(element){\r\n    this.setCellBackgroundColor('#fff')\r\n    if(element.id){\r\n        this.lastCell=element\r\n        this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\n/**\r\n * 鼠标抬起事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.mouseUp = function(element){\r\n    if(element.id){\r\n        this.lastCell = element\r\n        this.sheet.range=this.firstCell.id+':'+this.lastCell.id\r\n        this.setCellBackgroundColor('#69f')\r\n        config.editCell = element\r\n    }\r\n    config.WSConfig.isMouseDown=false\r\n}\r\n/**\r\n * 鼠标双击事件\r\n * @param element\r\n */\r\nSheetEventHandler.prototype.dblclick = function(element){\r\n    if(element.id){\r\n        config.editCell = element\r\n        var input = document.getElementById('input')\r\n        input.style.display = 'block'\r\n        input.style.backgroundColor = '#efe'\r\n        input.style.left = getLeft(element) + 'px'\r\n        input.style.top = getTop(element) + 'px'\r\n        input.style.height = element.offsetHeight + 'px'\r\n        input.style.width = element.offsetWidth + 'px'\r\n        if(this.sheet.cells[element.id]){\r\n            input.value = this.sheet.cells[element.id].text\r\n        }\r\n        else{\r\n            input.value = ''\r\n        }\r\n        input.focus()\r\n    }\r\n    config.WSConfig.isMouseDown=false\r\n}\r\nSheetEventHandler.prototype.inputBlur = function () {\r\n    config.isEditing = false\r\n    var input = document.getElementById('input')\r\n    input.blur()\r\n    input.style.display = 'none'\r\n    var ele = config.editCell\r\n    if(input.value){\r\n        if(!this.sheet.cells[ele.id]) {\r\n            this.sheet.cells[ele.id] = new Cell(ele)\r\n        }\r\n        this.sheet.cells[ele.id].text = input.value\r\n        ele.firstChild.innerHTML = input.value\r\n    }\r\n}\r\nSheetEventHandler.prototype.inputFocus = function () {\r\n    config.isEditing = true\r\n    var input = document.getElementById('input')\r\n    input.focus()\r\n}\r\n//鼠标失去焦点事件\r\nSheetEventHandler.prototype.mouseBlur=function(element){\r\n    element.style.color='transparent'\r\n    element.style.background='transparent'\r\n    if(config.WSConfig.isKeyDown){\r\n        var value=element.value\r\n        if(element.nextSibling.innerHTML==''&&value!=''){\r\n            var command = 'set '+ element.id + ' ' + value\r\n            var type = 'set'\r\n            this.sheet.UndoStack.pushCommand(command,type)\r\n        }\r\n        element.nextSibling.innerHTML=value\r\n    }\r\n    config.WSConfig.isKeyDown=true\r\n    element.parentNode.style.backgroundColor = 'transparent'\r\n}\r\n/**\r\n * 设置单元格背景颜色\r\n * @param backgroundColor\r\n */\r\nSheetEventHandler.prototype.setCellBackgroundColor=function(backgroundColor){\r\n    var cells=util.getColAndRow(this.firstCell,this.lastCell)\r\n    if(cells!=null) {\r\n        for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n            for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                var ele = document.getElementById(String.fromCharCode(i) + '_' + j)\r\n                if(ele){\r\n                    if(backgroundColor=='#fff'&&ele.backBackgroundColor!=undefined){\r\n                        ele.style.backgroundColor = ele.backBackgroundColor\r\n                    }else{\r\n                        ele.style.backgroundColor = backgroundColor\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 键盘按下事件\r\n * @param element\r\n * @param event\r\n */\r\nSheetEventHandler.prototype.keyDown = function(element,event){\r\n    var col=element.id.split('_')[0]\r\n    var row=element.id.split('_')[1]\r\n\r\n    switch (event.which) {\r\n        case 37://左键\r\n            if(!config.isEditing){\r\n                col=String.fromCharCode(col.charCodeAt(0) - 1)\r\n                var cell = document.getElementById( col +'_'+ row )\r\n                if (cell) {\r\n                    this.mouseDown(cell)\r\n                    this.mouseUp(cell)\r\n                }\r\n            }\r\n            break\r\n        case 38://上键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)-1) )\r\n            if (cell) {\r\n                if(config.isEditing){\r\n                    config.isEditing = false\r\n                    document.getElementById('input').blur()\r\n                }\r\n                this.mouseDown(cell)\r\n                this.mouseUp(cell)\r\n            }\r\n            break\r\n        case 39://右键\r\n            if(!config.isEditing){\r\n                col=String.fromCharCode(col.charCodeAt(0) + 1)\r\n                var cell = document.getElementById( col +'_'+ row)\r\n                if (cell) {\r\n                    this.mouseDown(cell)\r\n                    this.mouseUp(cell)\r\n                }\r\n            }\r\n            break\r\n        case 40://下键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)+1) )\r\n            if (cell) {\r\n                if(config.isEditing){\r\n                    config.isEditing = false\r\n                    document.getElementById('input').blur()\r\n                }\r\n                this.mouseDown(cell)\r\n                this.mouseUp(cell)\r\n            }\r\n            break\r\n        case 17://ctrl\r\n            break\r\n        case 18://alt\r\n            break\r\n        case 67://ctrl+c\r\n            this.sheet.copiedfrom=this.sheet.range\r\n            var command = 'copy ' + this.sheet.copiedfrom + ' formulas'\r\n            var type = 'copy'\r\n            this.sheet.UndoStack.pushCommand(command,type)\r\n            ta = document.getElementById('ta')\r\n            var text = ''\r\n            var firstCell=this.sheet.copiedfrom.split(':')[0]\r\n            var lastCell=this.sheet.copiedfrom.split(':')[1]\r\n            var cells=util.getColAndRow(document.getElementById(firstCell),\r\n                document.getElementById(lastCell))\r\n            if(cells!=null) {\r\n                var rowCount = 0\r\n                for (var i = cells.firstCellRow; i <= cells.lastCellRow; i++) {\r\n                    var colCount = 0\r\n                    for (var j = cells.firstCellCol; j <= cells.lastCellCol; j++) {\r\n                        var eleOld = document.getElementById(\r\n                            String.fromCharCode(j)\r\n                            + '_' + i)\r\n                        text += eleOld.firstChild.innerHTML + '\\t'\r\n                        colCount++\r\n                    }\r\n                    text=text.substr(0,text.length-1)\r\n                    text += '\\n'\r\n                    rowCount++\r\n                }\r\n                text=text.substr(0,text.length-1)\r\n            }\r\n            ta.value = text\r\n            ta.style.display = 'block'\r\n            ta.focus()\r\n            ta.select()\r\n\r\n            window.setTimeout(function() {\r\n                ta.style.display = 'none'\r\n                var cell = document.getElementById(col + '_' + row)\r\n                cell.focus()\r\n            },200)\r\n\r\n            break\r\n        case 86://ctrl+v\r\n            ta = document.getElementById('ta')\r\n            ta.style.display = 'block'\r\n            ta.focus()\r\n            ta.select()\r\n            var sheet = this.sheet\r\n            window.setTimeout(function () {\r\n                ta.blur()\r\n                var v = ta.value\r\n                ta.style.display = 'none'\r\n                v = v.split('\\n')\r\n                for (var i = 0; i < v.length; i++) {\r\n                    var vv = v[i].split('\\t')\r\n                    for (var j = 0; j < vv.length; j++) {\r\n                        var cvCol = String.fromCharCode(col.charCodeAt(0) + j)\r\n                        var cvRow = parseInt(row) + i\r\n                        var cell = document.getElementById(cvCol + '_' + cvRow)\r\n                        if(cell){\r\n                            cell.firstChild.innerHTML = vv[j]\r\n                            if(!sheet.cells[cell.id]) {\r\n                                sheet.cells[cell.id] = new Cell(cell)\r\n                            }\r\n                            sheet.cells[cell.id].text = vv[j]\r\n                            //还需要给cell height和width\r\n                        }\r\n\r\n                    }\r\n                }\r\n                var cell = document.getElementById(col + '_' + row)\r\n                cell.focus()\r\n            }, 200)\r\n\r\n            var command = 'past ' + element.id + ' formulas'\r\n            var type = 'past'\r\n            this.sheet.UndoStack.pushCommand(command,type)\r\n            config.WSConfig.isKeyDown=false\r\n            break\r\n        default:\r\n            if(!config.isEditing){\r\n                if(config.editCell) this.dblclick(config.editCell)\r\n            }\r\n    }\r\n}\r\n\r\n//获取元素的纵坐标\r\nfunction getTop(e){\r\n    var offset=e.offsetTop;\r\n    if(e.offsetParent!=null) offset+=getTop(e.offsetParent);\r\n    return offset;\r\n}\r\n//获取元素的横坐标\r\nfunction getLeft(e){\r\n    var offset=e.offsetLeft\r\n    if(e.offsetParent!=null) offset+=getLeft(e.offsetParent)\r\n    return offset\r\n}\r\nmodule.exports.SheetEventHandler = SheetEventHandler\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetEventHandler.js\n// module id = 7\n// module chunks = 0","/**\r\n * 渲染表格\r\n */\r\n\r\nvar config = require('config')\r\n\r\nvar SheetRender = function (sheet) {\r\n\tthis.sheet=sheet\r\n}\r\n\r\nSheetRender.prototype.init = function (sheetDiv) {\r\n\r\n\tvar sheetTable = document.createElement('table')\r\n    sheetTable.style.userSelect = 'none'\r\n    sheetDiv.appendChild(sheetTable)\r\n\tsheetTable.style.width = this.sheet.width + 'px'\r\n\tsheetTable.style.height = this.sheet.height + 'px'\r\n\t//表格的具体渲染\r\n\trenderSheet(this.sheet, sheetTable)\r\n}\r\n\r\n/**\r\n * 构建表格的数据模型\r\n * 一个存放表头的二维数组\r\n * @param rowNum\r\n * @param colNum\r\n */\r\nfunction createHeader(rowNum, colNum) {\r\n\tvar gridHeader =  []\r\n\tfor(var a=0;a<rowNum+1;a++){\r\n        gridHeader[a] = []\r\n\r\n\t\tfor(var b=0;b<colNum+1;b++){\r\n            gridHeader[a][b] = null\r\n\t\t}\r\n\t}\r\n\tvar startString = \"A\"\r\n\r\n\tfor(var i=1; i<colNum+1; i++){\r\n        gridHeader[0][i] = String.fromCharCode(startString.charCodeAt(0) + i - 1)\r\n\t}\r\n\r\n\tfor(var j=1; j<rowNum+1; j++){\r\n        gridHeader[j][0] = j\r\n\t}\r\n\r\n\treturn gridHeader\r\n}\r\n/**\r\n * 表格渲染\r\n * @param sheet\r\n * @param sheetTable\r\n */\r\nfunction renderSheet(sheet, sheetTable) {\r\n\tvar gridHeader = createHeader(sheet.rowNum,  sheet.colNum)\r\n\tvar cellHeight = config.CellConfig.height\r\n\tvar cellWidth = config.CellConfig.width\r\n\tvar\theadWidth = config.SheetConfig.headWidth\r\n\tvar\theadHeight = config.SheetConfig.headHeight\r\n\r\n\tvar rowNum = gridHeader.length\r\n\tvar colNum = gridHeader[0].length\r\n\r\n\r\n\tvar rowHead = document.createElement('tr')\r\n\tsheetTable.appendChild(rowHead)\r\n\t//渲染第一行表头\r\n\tfor(var i=0;i<colNum;i++){\r\n\t\tvar rowHeadTH  = document.createElement('th')\r\n\t\trowHead.appendChild(rowHeadTH)\r\n\r\n\t\tvar rowHeadDiv = document.createElement('div')\r\n\t\trowHeadTH.appendChild(rowHeadDiv)\r\n\t\t//第一行第一列特殊处理\r\n\t\tif(i === 0){\r\n\t\t\trowHeadTH.style.minWidth = headWidth + 'px'\r\n\t\t\trowHeadTH.style.minHeight = headHeight + 'px'\r\n\t\t\trowHeadDiv.style.minWidth = headWidth-2 + 'px'\r\n\t\t\trowHeadDiv.style.minHeight = headHeight-2 + 'px'\r\n\t\t}else{\r\n\t\t\trowHeadTH.style.minHeight = headHeight + 'px'\r\n\t\t\trowHeadTH.style.minWidth = cellWidth + 'px'\r\n\t\t\trowHeadDiv.style.minHeight = headHeight-2 + 'px'\r\n\t\t\trowHeadDiv.style.minWidth = cellWidth-2 + 'px'\r\n\r\n\t\t\trowHeadDiv.innerHTML = gridHeader[0][i]\r\n\t\t}\r\n\r\n\t}\r\n\r\n    var SheetEventBinderModule = require('SheetEventBinder')\r\n    var SheetEventBinder=SheetEventBinderModule.SheetEventBinder\r\n    var sheetEventBinder=new SheetEventBinder(sheet)\r\n\r\n\t//渲染除第一行外单元格\r\n\tfor(var j = 1;j<rowNum;j++){\r\n\t\tvar rowTR = document.createElement('tr')\r\n\t\tsheetTable.appendChild(rowTR)\r\n\r\n\t\tfor(var k=0; k<colNum;k++){\r\n\t\t\t//表格第一列特殊处理\r\n\t\t\tif(k === 0){\r\n\t\t\t\tvar rowTH = document.createElement('th')\r\n\t\t\t\trowTR.appendChild(rowTH)\r\n                rowTH.style.minWidth = headWidth + 'px'\r\n                rowTH.style.minHeight = cellHeight + 'px'\r\n\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n\t\t\t\trowTH.appendChild(rowDiv)\r\n                rowDiv.style.minWidth = headWidth-2 + 'px'\r\n                rowDiv.style.minHeight = cellHeight-2 + 'px'\r\n                rowDiv.innerHTML = gridHeader[j][k]\r\n\t\t\t}else {\r\n\t\t\t\tvar rowTD = document.createElement('td')\r\n                rowTD.id = gridHeader[0][k]+\"_\"+j\r\n                rowTR.appendChild(rowTD)\r\n                rowTD.style.minWidth = cellWidth + 'px'\r\n                rowTD.style.minHeight = cellHeight + 'px'\r\n                rowTD.style.display = 'table-cell'\r\n                sheetEventBinder.initRowTD(rowTD)\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n                rowTD.appendChild(rowDiv)\r\n                rowDiv.style.minWidth = cellWidth-2 + 'px'\r\n                rowDiv.style.minHeight = cellHeight-2 + 'px'\r\n                rowDiv.style.textAlign = 'right'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar input = document.createElement('input')\r\n\tinput.style.display = 'none'\r\n    input.style.position = 'absolute'\r\n\tinput.id = 'input'\r\n    sheetEventBinder.initInput(input)\r\n\tsheetTable.appendChild(input)\r\n    var ta = document.createElement('textarea') // used for ctrl-c/ctrl-v where an invisible text area is needed\r\n    ta.style = 'display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);'\r\n    ta.value = '';\r\n    ta.id = 'ta'\r\n    sheetTable.appendChild(ta)\r\n    //sheetEventBinder.init()\r\n}\r\n\r\nmodule.exports.SheetRender = SheetRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetRender.js\n// module id = 8\n// module chunks = 0","/**\r\n * 工具栏对象\r\n */\r\nvar configModule = require('config')\r\n\r\nvar ToolConfig = configModule.ToolConfig\r\n\r\nvar Tool = function () {\r\n    this.width = ToolConfig.width\r\n    this.height = ToolConfig.height\r\n}\r\n\r\nmodule.exports.Tool = Tool\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Tool.js\n// module id = 9\n// module chunks = 0","/**\r\n 工具栏绑定事件\r\n */\r\nvar config = require('config')\r\nvar ToolEventHandlerModule=require('ToolEventHandler')\r\nvar ToolEventHandler = ToolEventHandlerModule.ToolEventHandler\r\nvar toolEventHandler=null\r\n\r\nvar ToolEventBinder=function(sheet){\r\n    this.sheet=sheet\r\n    toolEventHandler=new ToolEventHandler(sheet)\r\n}\r\nToolEventBinder.prototype.initFontFamily=function(fontFamilySelect){\r\n    var toolEventBinder=this\r\n    fontFamilySelect.onchange=function(){\r\n        var fontFamily=fontFamilySelect.value\r\n        toolEventBinder.fontValue=fontFamily\r\n        toolEventBinder.fontType='family'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n        fontFamilySelect.value='-----'\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontSize=function(fontSizeSelect){\r\n    var toolEventBinder=this\r\n    fontSizeSelect.onchange=function(){\r\n        var fontSize=fontSizeSelect.value\r\n        toolEventBinder.fontValue=fontSize\r\n        toolEventBinder.fontType='size'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n        fontSizeSelect.value='-----'\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontWeight=function(fontWeightDiv){\r\n    var toolEventBinder=this\r\n    fontWeightDiv.onclick=function(){\r\n        config.WSConfig.isFont=false\r\n        toolEventBinder.fontValue='bold'\r\n        toolEventBinder.fontType='weight'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n        if(config.WSConfig.isFont){\r\n            toolEventHandler.setFont(toolEventBinder)\r\n        }\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontStyle=function(fontStyleDiv){\r\n    var toolEventBinder=this\r\n    fontStyleDiv.onclick=function(){\r\n        config.WSConfig.isFont=false\r\n        toolEventBinder.fontValue='italic'\r\n        toolEventBinder.fontType='style'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n        if(config.WSConfig.isFont){\r\n            toolEventHandler.setFont(toolEventBinder)\r\n        }\r\n    }\r\n}\r\nToolEventBinder.prototype.initColor=function(colorDiv){\r\n    var toolEventBinder=this\r\n    colorDiv.onclick=function(){\r\n        var colorSelectDiv=document.getElementById('colorSelect')\r\n        if(colorSelectDiv.style.display=='none'||toolEventBinder.fontType=='backgroundColor'){\r\n            toolEventBinder.fontType='color'\r\n            colorSelectDiv.style.display='block'\r\n            var left=this.offsetLeft\r\n            var top=this.offsetTop\r\n            colorSelectDiv.style.top=top+18+'px'\r\n            colorSelectDiv.style.left=left+'px'\r\n        }else{\r\n            colorSelectDiv.style.display='none'\r\n        }\r\n\r\n    }\r\n}\r\nToolEventBinder.prototype.initBackgroundColor=function(backgroundColorDiv){\r\n    var toolEventBinder=this\r\n    backgroundColorDiv.onclick=function(){\r\n        var colorSelectDiv=document.getElementById('colorSelect')\r\n        if(colorSelectDiv.style.display=='none'||toolEventBinder.fontType=='color'){\r\n            toolEventBinder.fontType='backgroundColor'\r\n            colorSelectDiv.style.display='block'\r\n            var left=this.offsetLeft\r\n            var top=this.offsetTop\r\n            colorSelectDiv.style.top=top+18+'px'\r\n            colorSelectDiv.style.left=left+'px'\r\n        }else{\r\n            colorSelectDiv.style.display='none'\r\n        }\r\n\r\n    }\r\n}\r\nToolEventBinder.prototype.initColorSelect=function(td){\r\n    var toolEventBinder=this\r\n    td.onclick=function(){\r\n        toolEventBinder.fontValue=this.style.backgroundColor\r\n        document.getElementById('colorSelect').style.display='none'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n    }\r\n}\r\nToolEventBinder.prototype.initMerge=function(mergeDiv){\r\n    var toolEventBinder=this\r\n    mergeDiv.onclick=function(){\r\n        config.WSConfig.isFont=false\r\n        // toolEventBinder.fontValue='italic'\r\n        toolEventBinder.fontType='merge'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n    }\r\n}\r\nToolEventBinder.prototype.initFontBorder=function(fontBorderSelect){\r\n    var toolEventBinder=this\r\n    fontBorderSelect.onchange=function(){\r\n        var fontBorder=fontBorderSelect.value\r\n        toolEventBinder.fontValue=fontBorder\r\n        toolEventBinder.fontType='border'\r\n        toolEventHandler.setFont(toolEventBinder)\r\n        fontBorderSelect.value='-----'\r\n    }\r\n}\r\nmodule.exports.ToolEventBinder=ToolEventBinder\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolEventBinder.js\n// module id = 10\n// module chunks = 0","/**\r\n * 工具栏事件\r\n */\r\nvar config = require('config')\r\nvar UtilModule=require('Util')\r\nvar Util=UtilModule.Util\r\nvar util=new Util()\r\n\r\nvar ToolEventHandler=function(sheet){\r\n    this.sheet=sheet\r\n}\r\n\r\nToolEventHandler.prototype.setFont=function(toolEventBinder){\r\n    var sheet=this.sheet\r\n    var fontType=toolEventBinder.fontType\r\n    var fontValue=toolEventBinder.fontValue\r\n    if(sheet.range){\r\n        var firstCell=sheet.range.split(':')[0]\r\n        var lastCell=sheet.range.split(':')[1]\r\n        var cells=util.getColAndRow(document.getElementById(firstCell),\r\n            document.getElementById(lastCell))\r\n        if(cells!=null) {\r\n            if(fontType=='merge'){\r\n                mergeCell(firstCell,lastCell,cells,sheet)\r\n            }else if(fontType=='border'){\r\n                setFontBorder(cells,fontValue)\r\n            }else{\r\n                for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n                    for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                        var ele = document.getElementById(String.fromCharCode(i) + '_' + j).firstChild\r\n                        if(fontType=='family'){\r\n                            setFontFamily(ele,fontValue)\r\n                        }else if(fontType=='size'){\r\n                            setFontSize(ele,fontValue)\r\n                        }else if(fontType=='weight'){\r\n                            setFontWeight(ele,fontValue)\r\n                        }else if(fontType=='style'){\r\n                            setFontStyle(ele,fontValue)\r\n                        }else if(fontType=='color'){\r\n                            setFontColor(ele,fontValue)\r\n                        }else if(fontType=='backgroundColor'){\r\n                            setFontBackgroundColor(ele,fontValue)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction setFontFamily(ele,fontFamily) {\r\n    if(fontFamily=='Default'){\r\n        fontFamily=''\r\n    }\r\n    ele.style.fontFamily=fontFamily\r\n}\r\nfunction setFontSize(ele,fontSize){\r\n    if(fontSize=='Default'||fontSize=='-----'){\r\n        fontSize=''\r\n    }\r\n    ele.style.fontSize=fontSize\r\n}\r\nfunction setFontWeight(ele,fontWeight){\r\n    if(!config.WSConfig.isFont){\r\n        if(ele.style.fontWeight!=''){\r\n            fontWeight=''\r\n        }else{\r\n            config.WSConfig.isFont=true\r\n        }\r\n    }\r\n\r\n    ele.style.fontWeight=fontWeight\r\n}\r\nfunction setFontStyle(ele,fontStyle){\r\n    if(!config.WSConfig.isFont){\r\n        if(ele.style.fontStyle!=''){\r\n            fontStyle=''\r\n        }else{\r\n            config.WSConfig.isFont=true\r\n        }\r\n    }\r\n\r\n    ele.style.fontStyle=fontStyle\r\n}\r\nfunction setFontColor(ele,fontColor){\r\n    ele.backBackgroundColor=fontColor\r\n    ele.parentNode.style.color=fontColor\r\n}\r\nfunction setFontBackgroundColor(ele,fontBackgroundColor){\r\n    ele.parentNode.backBackgroundColor=fontBackgroundColor\r\n    ele.parentNode.style.backgroundColor=fontBackgroundColor\r\n}\r\nfunction mergeCell(firstCell,lastCell,cells,sheet){\r\n    var newCell=document.getElementById(String.fromCharCode(cells.firstCellCol)+\"_\"+cells.firstCellRow)\r\n    if(firstCell!=lastCell){\r\n       var colSpanNum=0\r\n       var rowSpanNum=0\r\n        for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++) {\r\n            var newRowSpanNum=0\r\n            for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n                newRowSpanNum++\r\n                if(i!=cells.firstCellCol||j!=cells.firstCellRow){\r\n                    var ele=document.getElementById(String.fromCharCode(i) + '_' + j)\r\n                    if(ele){\r\n                        ele .style.display='none'\r\n                    }\r\n                }\r\n                if(i==cells.lastCellCol&&newCell.colSpan>colSpanNum){\r\n                    for(var num=1;num<(newCell.colSpan-colSpanNum);num++){\r\n                        var ele=document.getElementById(String.fromCharCode(i+num) + '_' + j)\r\n                        if(ele){\r\n                            ele .style.display='none'\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if(newRowSpanNum>=rowSpanNum){\r\n                rowSpanNum=newRowSpanNum\r\n            }\r\n            if(newCell.rowSpan>rowSpanNum){\r\n                for(var num=0;num<(newCell.rowSpan-rowSpanNum);num++){\r\n                    var ele=document.getElementById(String.fromCharCode(i) + '_' + (j+num))\r\n                    if(ele){\r\n                        ele .style.display='none'\r\n                }\r\n                }\r\n            }\r\n            colSpanNum++\r\n        }\r\n        if(rowSpanNum>newCell.rowSpan){\r\n            newCell.rowSpan=rowSpanNum\r\n        }\r\n        if(colSpanNum>newCell.colSpan){\r\n            newCell.colSpan=colSpanNum\r\n        }\r\n        sheet.range=newCell.id+\":\"+newCell.id\r\n    }else{\r\n        var colNum=newCell.colSpan\r\n        var rowNum=newCell.rowSpan\r\n        for(var i=0;i<colNum;i++) {\r\n            for (var j = 0; j <rowNum; j++) {\r\n                var id=String.fromCharCode(cells.firstCellCol+i) + '_' + (cells.firstCellRow+j)\r\n                var ele=document.getElementById(id)\r\n                if(ele){\r\n                    ele.colSpan=1\r\n                    ele.rowSpan=1\r\n                    ele .style.display='table-cell'\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction  setFontBorder(cells,fontValue){\r\n    // '-----','左边框','上边框','右边框','下边框','外侧边框','无边框','全边框'\r\n    for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++) {\r\n        for (var j = cells.firstCellRow; j <= cells.lastCellRow; j++) {\r\n            var ele = document.getElementById(String.fromCharCode(i) + '_' + j)\r\n            if(fontValue=='无边框'){\r\n                ele.style.border='1px solid #ccc'\r\n                ele = document.getElementById(String.fromCharCode(i-1) + '_' + j)\r\n                ele.style.borderRight='1px solid #ccc'\r\n                ele = document.getElementById(String.fromCharCode(i) + '_' + (j-1))\r\n                ele.style.borderBottom='1px solid #ccc'\r\n            }else if(fontValue=='全边框'){\r\n                ele.style.border='1px solid #000'\r\n                ele = document.getElementById(String.fromCharCode(i-1) + '_' + j)\r\n                ele.style.borderRight='1px solid #000'\r\n                ele = document.getElementById(String.fromCharCode(i) + '_' + (j-1))\r\n                ele.style.borderBottom='1px solid #000'\r\n            }else{\r\n                if(i==cells.firstCellCol&&(fontValue=='左边框'||fontValue=='外侧边框')){\r\n                    ele = document.getElementById(String.fromCharCode(i-1) + '_' + j)\r\n                    ele.style.borderRight='1px solid #000'\r\n                }\r\n                if(j == cells.firstCellRow&&(fontValue=='上边框'||fontValue=='外侧边框')){\r\n                    ele = document.getElementById(String.fromCharCode(i) + '_' + (j-1))\r\n                    ele.style.borderBottom='1px solid #000'\r\n                }\r\n                if(i==cells.lastCellCol&&(fontValue=='右边框'||fontValue=='外侧边框')){\r\n                    ele.style.borderRight='1px solid #000'\r\n                }\r\n                if(j == cells.lastCellRow&&(fontValue=='下边框'||fontValue=='外侧边框')){\r\n                    ele.style.borderBottom='1px solid #000'\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports.ToolEventHandler = ToolEventHandler\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolEventHandler.js\n// module id = 11\n// module chunks = 0","/**\r\n * 工具栏渲染\r\n */\r\n\r\nvar ToolRender=function(sheet){\r\n    this.sheet=sheet\r\n}\r\nToolRender.prototype.init=function(toolDiv,width,height){\r\n    toolDiv.style.width = width + 'px'\r\n    toolDiv.style.height = height + 'px'\r\n    toolDiv.style.backgroundColor = '#aaaaaa'\r\n    //sheetToolDiv.innerHTML = \"&#xe900;&#xe901;&#xe14d;&#xe14e;&#xe14f;\"\r\n    var html = [\"&#xe900\",\"&#xe901\",\"&#xe14d\",\"&#xe14e\",\"&#xe14f\"]\r\n    //渲染工具栏具体button按钮\r\n    html.forEach(function(innerhtml){\r\n        var buttonDiv = document.createElement('div')\r\n        buttonDiv.style.display = \"inline\"\r\n        buttonDiv.innerHTML=innerhtml\r\n\r\n        buttonDiv.onclick = function(){\r\n            // eventHandle.buttonClick(innerhtml)\r\n        }\r\n        toolDiv.appendChild(buttonDiv)\r\n    })\r\n\r\n    var ToolEventBinderModule = require('ToolEventBinder')\r\n    var ToolEventBinder=ToolEventBinderModule.ToolEventBinder\r\n    var toolEventBinder=new ToolEventBinder(this.sheet)\r\n\r\n    renderFont(toolEventBinder,toolDiv)\r\n    renderColorAndBackgroundColor(toolEventBinder,toolDiv)\r\n    renderColorSelect(toolEventBinder,toolDiv)\r\n\r\n    //合并单元格\r\n    var mergeDiv=document.createElement('div')\r\n    mergeDiv.style.display = \"inline\"\r\n    mergeDiv.innerHTML='&#xe157'\r\n    mergeDiv.style.paddingLeft='10px'\r\n    mergeDiv.style.cursor='pointer'\r\n    toolEventBinder.initMerge(mergeDiv)\r\n    toolDiv.appendChild(mergeDiv)\r\n\r\n    //单元格边框\r\n    var fontBorderSelect=document.createElement('select')\r\n    var fontBorderOption=['-----','左边框','上边框','右边框','下边框','无边框','外侧边框','全边框']\r\n    fontBorderOption.forEach(function(o){\r\n        var option=document.createElement('option')\r\n        option.innerHTML=o\r\n        fontBorderSelect.appendChild(option)\r\n    })\r\n    toolEventBinder.initFontBorder(fontBorderSelect)\r\n    toolDiv.appendChild(fontBorderSelect)\r\n}\r\n\r\nfunction renderFont(toolEventBinder,toolDiv){\r\n    //字体\r\n    var fontFamilySelect=document.createElement('select')\r\n    var fontFamilyOption=['-----','Default','Custom','Verdana','Arial','Courier']\r\n    fontFamilyOption.forEach(function(o){\r\n        var option=document.createElement('option')\r\n        option.innerHTML=o\r\n        fontFamilySelect.appendChild(option)\r\n    })\r\n    toolEventBinder.initFontFamily(fontFamilySelect)\r\n    toolDiv.appendChild(fontFamilySelect)\r\n\r\n    //字体大小\r\n    var fontSizeSelect=document.createElement('select')\r\n    var fontSizeOption=['-----','Default','X-Small','Small','Medium','Large',\r\n        'X-Large','6pt','7pt','8pt','9pt','10pt','11pt','12pt','14pt','16pt','18pt',\r\n        '20pt','22pt','24pt','28pt','36pt','48pt','72pt']\r\n    fontSizeOption.forEach(function(o){\r\n        var option=document.createElement('option')\r\n        option.innerHTML=o\r\n        fontSizeSelect.appendChild(option)\r\n    })\r\n    toolEventBinder.initFontSize(fontSizeSelect)\r\n    toolDiv.appendChild(fontSizeSelect)\r\n\r\n    //加粗\r\n    var fontWeightDiv=document.createElement('div')\r\n    fontWeightDiv.innerHTML='B'\r\n    fontWeightDiv.style.display='inline'\r\n    fontWeightDiv.style.paddingLeft='10px'\r\n    fontWeightDiv.style.cursor='pointer'\r\n    fontWeightDiv.style.fontWeight='bold'\r\n    toolEventBinder.initFontWeight(fontWeightDiv)\r\n    toolDiv.appendChild(fontWeightDiv)\r\n\r\n    //斜体\r\n    var fontStyleDiv=document.createElement('div')\r\n    fontStyleDiv.innerHTML='I'\r\n    fontStyleDiv.style.display='inline'\r\n    fontStyleDiv.style.paddingLeft='10px'\r\n    fontStyleDiv.style.cursor='pointer'\r\n    fontStyleDiv.style.fontStyle='italic'\r\n    fontStyleDiv.style.fontFamily='Verdana'\r\n    toolEventBinder.initFontStyle(fontStyleDiv)\r\n    toolDiv.appendChild(fontStyleDiv)\r\n}\r\nfunction renderColorAndBackgroundColor(toolEventBinder,toolDiv){\r\n    //color,字体颜色\r\n    var colorDiv=document.createElement('div')\r\n    colorDiv.style.display='inline'\r\n    colorDiv.style.marginLeft='10px'\r\n    colorDiv.style.paddingLeft='15px'\r\n    colorDiv.style.cursor='pointer'\r\n    colorDiv.style.border='1px solid black'\r\n    colorDiv.style.width='15px'\r\n    colorDiv.style.height='15px'\r\n    colorDiv.style.backgroundColor='#fff'\r\n    toolDiv.appendChild(colorDiv)\r\n    toolEventBinder.initColor(colorDiv)\r\n\r\n    //backgroundColor背景颜色\r\n    var backgroundColorDiv=document.createElement('div')\r\n    backgroundColorDiv.style.display='inline'\r\n    backgroundColorDiv.style.marginLeft='10px'\r\n    backgroundColorDiv.style.paddingLeft='15px'\r\n    backgroundColorDiv.style.cursor='pointer'\r\n    backgroundColorDiv.style.border='1px solid black'\r\n    backgroundColorDiv.style.width='15px'\r\n    backgroundColorDiv.style.height='15px'\r\n    backgroundColorDiv.style.backgroundColor='#fff'\r\n    toolDiv.appendChild(backgroundColorDiv)\r\n    toolEventBinder.initBackgroundColor(backgroundColorDiv)\r\n}\r\n\r\nfunction renderColorSelect(toolEventBinder,toolDiv){\r\n    var colorSelectDiv=document.createElement(\"div\")\r\n    colorSelectDiv.id='colorSelect'\r\n    colorSelectDiv.style.display='none'\r\n    colorSelectDiv.style.position = \"absolute\"\r\n    colorSelectDiv.style.zIndex = 100\r\n    colorSelectDiv.style.backgroundColor = \"#FFF\"\r\n    colorSelectDiv.style.border = \"1px solid black\"\r\n    colorSelectDiv.style.width='106px'\r\n    toolDiv.appendChild(colorSelectDiv)\r\n\r\n    var mainDiv = document.createElement(\"div\")\r\n    mainDiv.style.padding = \"3px\"\r\n    mainDiv.style.backgroundColor = \"#CCC\"\r\n    colorSelectDiv.appendChild(mainDiv)\r\n\r\n    var mainTable = document.createElement(\"table\")\r\n    mainTable.cellSpacing = 0\r\n    mainTable.cellPadding = 0\r\n    mainTable.style.width = \"100px\"\r\n    mainDiv.appendChild(mainTable)\r\n\r\n    var mainTbody = document.createElement(\"tbody\")\r\n    mainTable.appendChild(mainTbody)\r\n    var steps = [0, 68, 153, 204, 255]\r\n    var commonRgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"]\r\n\r\n    for (var row=0; row<16; row++) {\r\n        var tr = document.createElement(\"tr\")\r\n        for (var col=0; col<5; col++) {\r\n            var td = document.createElement(\"td\")\r\n            toolEventBinder.initColorSelect(td)\r\n            td.style.fontSize = \"1px\"\r\n            td.innerHTML = \"&nbsp;\"\r\n            td.style.height = \"10px\"\r\n            if (col<=1) {\r\n                td.style.width = \"17px\"\r\n                td.style.borderRight = \"3px solid white\"\r\n            }\r\n            else {\r\n                td.style.width = \"20px\"\r\n                td.style.backgroundRepeat = \"no-repeat\"\r\n            }\r\n            if(col==0){\r\n                var x = commonRgb[row]\r\n                td.style.backgroundColor=\"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\"\r\n            }\r\n            if(col==1){\r\n                td.style.backgroundColor=makeRGB(17*(15-row),17*(15-row),17*(15-row))\r\n            }\r\n            if(col==2){\r\n                td.style.backgroundColor=makeRGB(17*(15-row),0,0)\r\n            }\r\n            if(col==3){\r\n                td.style.backgroundColor=makeRGB(0,17*(15-row),0)\r\n            }\r\n            if(col==4){\r\n                td.style.backgroundColor=makeRGB(0,0,17*(15-row))\r\n            }\r\n            tr.appendChild(td)\r\n        }\r\n        mainTbody.appendChild(tr)\r\n    }\r\n    mainTable.appendChild(mainTbody)\r\n}\r\n\r\nfunction makeRGB(r, g, b) {\r\n    return \"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\"\r\n}\r\nmodule.exports.ToolRender = ToolRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolRender.js\n// module id = 12\n// module chunks = 0","/**\r\n *  堆栈对象\r\n */\r\nvar UndoStack = function () {\r\n\r\n    this.tos=-1\r\n    this.maxRedo=0\r\n    this.maxUndo=50\r\n    this.stack=[]\r\n\r\n}\r\nUndoStack.prototype.pushCommand = function(command,type){\r\n    var stack={\r\n        command : command,\r\n        type: type\r\n    }\r\n    this.stack.push(stack)\r\n    this.tos++\r\n}\r\nUndoStack.prototype.reDo = function(){\r\n\r\n}\r\nUndoStack.prototype.unDo = function(){\r\n\r\n}\r\nmodule.exports.UndoStack = UndoStack\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/UndoStack.js\n// module id = 13\n// module chunks = 0","/**\r\n * 工作区域渲染\r\n * @param wsManager\r\n * @param parentNode\r\n * @constructor\r\n */\r\nvar WSRender=function(wsManager,parentNode){\r\n    this.manager=wsManager\r\n    this.parNode=parentNode\r\n}\r\n\r\nWSRender.prototype.init=function () {\r\n    var ws=this.manager.workspace\r\n\r\n    //workspace\r\n    var WSDiv = document.createElement('div')\r\n    WSDiv.style.width = ws.width + 'px'\r\n    WSDiv.style.height = ws.height + 'px'\r\n    this.parNode.appendChild(WSDiv)\r\n\r\n    //tool\r\n    var ToolRenderModule = require('ToolRender')\r\n    var ToolRender = ToolRenderModule.ToolRender\r\n    var toolRender=new ToolRender(ws.Sheet)\r\n    var tool = ws.Tool\r\n    var toolDiv = document.createElement('div')\r\n    toolRender.init(toolDiv,tool.width,tool.height)\r\n    WSDiv.appendChild(toolDiv)\r\n\r\n    //sheet\r\n    var SheetRenderModule= require('SheetRender')\r\n    var SheetRender= SheetRenderModule.SheetRender\r\n    var sheetRender=new SheetRender(ws.Sheet)\r\n    var sheet=ws.Sheet\r\n    var sheetDiv=document.createElement('div')\r\n    sheetRender.init(sheetDiv)\r\n    WSDiv.appendChild(sheetDiv)\r\n}\r\nmodule.exports.WSRender = WSRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSRender.js\n// module id = 14\n// module chunks = 0","/**\r\n * 工作区对象，包括工具栏，表格等\r\n * @type {*}\r\n */\r\nvar config= require('config')\r\n\r\nvar Workspace = function (Tool, Sheet) {\r\n\r\n    this.width = config.WSConfig.width\r\n    this.height = config.WSConfig.height\r\n\r\n    this.Tool =Tool\r\n    this.Sheet= Sheet\r\n}\r\n\r\nmodule.exports.Workspace = Workspace\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Workspace.js\n// module id = 15\n// module chunks = 0"],"sourceRoot":""}