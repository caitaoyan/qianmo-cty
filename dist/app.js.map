{"version":3,"sources":["webpack:///webpack/bootstrap bbe43a7459290c00a4f6","webpack:///./config/config.js","webpack:///./component/WSManager.js","webpack:///./app.js","webpack:///./component/Cell.js","webpack:///./component/Sheet.js","webpack:///./component/SheetBindEvent.js","webpack:///./component/SheetEventHandel.js","webpack:///./component/SheetRender.js","webpack:///./component/Tool.js","webpack:///./component/ToolRender.js","webpack:///./component/UndoStack.js","webpack:///./component/WSRender.js","webpack:///./component/Workspace.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvIA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,oC;;;;;;ACjCA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;;;ACVA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,0B;;;;;;AClBA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,4B;;;;;;ACvBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4C;;;;;;AC3CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,kD;;;;;;AC/JA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,aAAa,SAAS;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA,eAAe,SAAS;AACxB;AACA;;AAEA,cAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wC;;;;;;AC5JA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,0B;;;;;;;;ACPA;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ,QAAQ,QAAQ,QAAQ;AACxE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sC;;;;;;ACvBA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oC;;;;;;AC3BA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kC;;;;;;AChCA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bbe43a7459290c00a4f6","/**\r\n * 配置文件，主要是个各类属性默认值\r\n * 整张表命名为：sheet\r\n * 表格上半部分叫做：sheetTool\r\n * 表格叫做：sheetGrid\r\n *\r\n */\r\n\r\n/**\r\n * 整张表-Sheet的属性默认值\r\n *\r\n */\r\nvar WSConfig = {\r\n\theight: 600,\r\n\twidth: 1030,\r\n\tisMouseDown:false,\r\n\tisKeyDown:true\r\n}\r\n\r\n/**\r\n * 表头-SheetTool的属性默认值\r\n *\r\n */\r\nvar ToolConfig = {\r\n\theight: 40,\r\n\twidth: WSConfig.width\r\n}\r\n\r\n/**\r\n * 单元格-Cell属性默认值\r\n *\r\n */\r\nvar CellConfig = {\r\n\theight: 20,\r\n\twidth: 100\r\n}\r\n\r\n/**\r\n * 表单-SheetGrid的属性默认值\r\n *\r\n */\r\nvar SheetConfig = {\r\n\theight: WSConfig.height - ToolConfig.height,\r\n\twidth: WSConfig.width,\r\n\theadWidth: 30,\r\n\theadHeight: 25,\r\n\r\n\trowNum: (WSConfig.height - ToolConfig.height-30)/CellConfig.height,\r\n\tcolNum: (WSConfig.width-30)/CellConfig.width\r\n}\r\nvar keyboardTables = {\r\n\r\n\tspecialKeysCommon: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tspecialKeysIE: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysIE: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysOpera: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n\t\t45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n\t\t46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n\t\t113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysOpera: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysSafari: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n\t\t63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n\t\t63277: \"[pgdn]\", 63237: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysSafari: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysSafari: {\r\n\t\t63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n\t\t63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n\t},\r\n\r\n\tspecialKeysFirefox: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysFirefox: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysFirefox: {\r\n\t\t16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n\t\t91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n\t\t117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n\t\t144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n\t}\r\n}\r\n\r\n/**\r\n * 输出模块\r\n *\r\n */\r\nmodule.exports.WSConfig = WSConfig\r\nmodule.exports.ToolConfig = ToolConfig\r\nmodule.exports.SheetConfig = SheetConfig\r\nmodule.exports.CellConfig = CellConfig\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/config.js\n// module id = 0\n// module chunks = 0","\r\nvar WSManager = function () {}\r\n\r\nWSManager.prototype.init = function (parentNode) {\r\n\r\n    //实例化初始化Tool对象\r\n    var ToolModule = require('Tool')\r\n    var Tool=ToolModule.Tool\r\n    var tool=new Tool()\r\n\r\n    //实例化初始化UndoStack对象\r\n    var UndoStackModule =require('UndoStack')\r\n    var UndoStack = UndoStackModule.UndoStack\r\n    var undoStack = new UndoStack()\r\n\r\n    //实例化初始化Sheet对象\r\n    var SheetModule = require('Sheet')\r\n    var Sheet =SheetModule.Sheet\r\n    var sheet=new Sheet(undoStack)\r\n\r\n    //实例化初始化Workspace对象\r\n    var WorkspaceModule = require('Workspace')\r\n    var Workspace = WorkspaceModule.Workspace\r\n    this.workspace=new Workspace(tool,sheet)\r\n\r\n    //实例化初始化WSRender对象\r\n    var WSRenderModule = require('WSRender')\r\n    var WSRender = WSRenderModule.WSRender\r\n    var wsRender=new WSRender(this,parentNode)\r\n\r\n    wsRender.init()\r\n}\r\n\r\nmodule.exports.WSManager = WSManager\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSManager.js\n// module id = 1\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\nvar WSManagerModule = require('WSManager')\r\nvar WSManager = WSManagerModule.WSManager\r\nvar wsManager=new WSManager()\r\n\r\nvar parentNode = document.getElementById('QianMoApp')\r\n\r\nwsManager.init(parentNode)\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app.js\n// module id = 2\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar cellConfig = configModule.CellConfig\r\n\r\nvar Cell = function (coord) {\r\n\r\n\t//成员属性\r\n\t//设置默认值\r\n\tthis.height = cellConfig.height\r\n\tthis.width = cellConfig.width\r\n\r\n\tthis.coord = coord\r\n}\r\n\r\nmodule.exports.Cell = Cell\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Cell.js\n// module id = 3\n// module chunks = 0","/**\r\n * 表格对象\r\n */\r\n\r\n\r\nvar configModule = require('config')\r\n\r\nvar sheetConfig = configModule.SheetConfig\r\n\r\nvar Sheet = function (UndoStack) {\r\n    this.height = sheetConfig.height\r\n    this.width = sheetConfig.width\r\n\r\n    this.headWidth = sheetConfig.headWidth\r\n    this.headHeight = sheetConfig.headHeight\r\n\r\n    this.rowNum = sheetConfig.rowNum\r\n    this.colNum = sheetConfig.colNum\r\n\r\n    this.cells = {}\r\n    this.UndoStack = UndoStack\r\n}\r\n\r\nmodule.exports.Sheet = Sheet\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Sheet.js\n// module id = 4\n// module chunks = 0","var config = require('config')\r\nvar SheetEventHandelModule=require('SheetEventHandel')\r\nvar SheetEventHandel = SheetEventHandelModule.SheetEventHandel\r\nvar sheetEventHandel=null\r\n\r\nvar SheetBindEvent = function (sheet) {\r\n    this.sheet=sheet\r\n    sheetEventHandel=new SheetEventHandel(sheet)\r\n}\r\n\r\nSheetBindEvent.prototype.init=function(rowTD,rowInput){\r\n\r\n    rowTD.onmousedown = function(){\r\n        sheetEventHandel.mouseDown(this)\r\n    }\r\n    window.onmousedown=function(){\r\n        sheetEventHandel.setCellBackgroundColor('transparent')\r\n    }\r\n    rowTD.onmouseup = function(){\r\n        sheetEventHandel.mouseUp(this)\r\n    }\r\n    window.onmouseup = function(){\r\n        config.WSConfig.isMouseDown=false\r\n    }\r\n    rowTD.onmousemove = function(){\r\n        if(config.WSConfig.isMouseDown) {\r\n            sheetEventHandel.mouseMove(this)\r\n        }\r\n    }\r\n    rowInput.ondblclick = function () {\r\n        this.style.color='#111'\r\n        this.style.background='#efe'\r\n    }\r\n    rowInput.onfocus = function () {\r\n        this.parentNode.style.backgroundColor = '#69f'\r\n    }\r\n    rowInput.onblur=function () {\r\n        sheetEventHandel.mouseBlur(this)\r\n    }\r\n    rowInput.onkeydown=function (event) {\r\n        sheetEventHandel.keyDown(this,event)\r\n    }\r\n}\r\nmodule.exports.SheetBindEvent=SheetBindEvent\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetBindEvent.js\n// module id = 5\n// module chunks = 0","var config = require('config')\r\nvar CellModule = require('Cell')\r\nvar Cell=CellModule.Cell\r\n\r\nvar SheetEventHandel = function (sheet) {\r\n    this.firstCell = null\r\n    this.lastCell = null\r\n    this.sheet=sheet\r\n}\r\n\r\nSheetEventHandel.prototype.mouseDown = function(element){\r\n    this.setCellBackgroundColor('transparent')\r\n    if(element.firstChild.id){\r\n        this.firstCell = element.firstChild\r\n        config.WSConfig.isMouseDown=true\r\n    }\r\n}\r\n\r\nSheetEventHandel.prototype.mouseMove = function(element){\r\n    this.setCellBackgroundColor('transparent')\r\n    if(element.firstChild.id){\r\n        this.lastCell=element.firstChild\r\n        this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\nSheetEventHandel.prototype.mouseUp = function(element){\r\n    if(element.firstChild.id){\r\n        this.lastCell = element.firstChild\r\n        this.sheet.range=this.firstCell.id+':'+this.lastCell.id\r\n        this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\nSheetEventHandel.prototype.mouseBlur=function(element){\r\n    element.style.color='transparent'\r\n    element.style.background='transparent'\r\n    if(config.WSConfig.isKeyDown){\r\n        var value=element.value\r\n        if(element.nextSibling.innerHTML==''&&value!=''){\r\n            var command = 'set '+ element.id + ' ' + value\r\n            var type = 'set'\r\n            this.sheet.UndoStack.pushCommand(command,type)\r\n        }\r\n        element.nextSibling.innerHTML=value\r\n    }\r\n    element.parentNode.style.backgroundColor = 'transparent'\r\n}\r\n\r\nSheetEventHandel.prototype.setCellBackgroundColor=function(backgroundColor){\r\n    var cells=this.getColAndRow(this.firstCell,this.lastCell)\r\n    // console.log(this.lastCell);\r\n    if(cells!=null) {\r\n        for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n            for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                var ele = document.getElementById(String.fromCharCode(i) + '_' + j)\r\n                ele.parentNode.style.backgroundColor = backgroundColor\r\n            }\r\n        }\r\n    }\r\n}\r\nSheetEventHandel.prototype.getColAndRow=function(firstCell,lastCell){\r\n    var result=null\r\n    if(firstCell&&firstCell.id&&lastCell&&lastCell.id) {\r\n        result=new Object()\r\n        result.firstCellCol = firstCell.id.split('_')[0].charCodeAt(0)\r\n        result.firstCellRow = parseInt(firstCell.id.split('_')[1])\r\n        result.lastCellCol = lastCell.id.split('_')[0].charCodeAt(0)\r\n        result.lastCellRow = parseInt(lastCell.id.split('_')[1])\r\n        if( result.firstCellCol> result.lastCellCol){\r\n            var newFirstCellCol=result.firstCellCol\r\n            result.firstCellCol=result.lastCellCol\r\n            result.lastCellCol=newFirstCellCol\r\n        }\r\n        if( result.firstCellRow> result.lastCellRow){\r\n            var newFirstCellRow=result.firstCellRow\r\n            result.firstCellRow=result.lastCellRow\r\n            result.lastCellRow=newFirstCellRow\r\n        }\r\n\r\n    }\r\n    return result\r\n}\r\n\r\nSheetEventHandel.prototype.keyDown = function(element,event){\r\n    var col=element.id.split('_')[0]\r\n    var row=element.id.split('_')[1]\r\n\r\n    switch (event.which) {\r\n        case 37://左键\r\n            col=String.fromCharCode(col.charCodeAt(0) - 1)\r\n            var cell = document.getElementById( col +'_'+ row )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 38://上键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)-1) )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 39://右键\r\n            col=String.fromCharCode(col.charCodeAt(0) + 1)\r\n            var cell = document.getElementById( col +'_'+ row)\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 40://下键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)+1) )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 17://ctrl\r\n            break\r\n        case 18://alt\r\n            break\r\n        case 67://ctrl+c\r\n            this.sheet.copiedfrom=this.sheet.range\r\n            var command = 'copy ' + this.sheet.copiedfrom + ' formulas'\r\n            var type = 'copy'\r\n            this.sheet.UndoStack.pushCommand(command,type)\r\n            break\r\n        case 86://ctrl+v\r\n            var firstCell=this.sheet.copiedfrom.split(':')[0]\r\n            var lastCell=this.sheet.copiedfrom.split(':')[1]\r\n            var cells=this.getColAndRow(document.getElementById(firstCell),\r\n                document.getElementById(lastCell))\r\n            if(cells!=null) {\r\n                var colCount=0\r\n                for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n                    var rowCount=0\r\n                    for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                        var eleOld = document.getElementById(\r\n                            String.fromCharCode(i)\r\n                            + '_' + j)\r\n                        var eleNew = document.getElementById(\r\n                            String.fromCharCode(col.charCodeAt(0)+colCount)\r\n                            + '_' + (parseInt(row)+rowCount))\r\n                        if(eleNew){\r\n                            eleNew.nextSibling.innerHTML=eleOld.nextSibling.innerHTML\r\n                            var cell=new Cell()\r\n                            cell.value=eleOld.nextSibling.innerHTML\r\n                            this.sheet.cells[eleNew.id]=cell\r\n                        }\r\n                        rowCount++\r\n\r\n                    }\r\n                    colCount++\r\n                }\r\n                var command = 'past ' + element.id + ' formulas'\r\n                var type = 'past'\r\n                this.sheet.UndoStack.pushCommand(command,type)\r\n            }\r\n            config.WSConfig.isKeyDown=false\r\n            break\r\n        default:\r\n            var cell=new Cell()\r\n            cell.value=element.value\r\n            this.sheet.cells[element.id]=cell\r\n            element.style.color='#111'\r\n            element.style.background='#efe'\r\n            break\r\n    }\r\n}\r\n\r\n\r\nmodule.exports.SheetEventHandel = SheetEventHandel\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetEventHandel.js\n// module id = 6\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\n/**\r\n * SheetView Class\r\n *  负责\r\n *  @渲染表格\r\n *  @改变样式\r\n *\r\n *  总之，跟dom的直接交互，全由SheetView完成\r\n */\r\n\r\n/**\r\n * 这段代码还有很多地方需要重构\r\n * 包括各种样式\r\n * 希望不要动\r\n */\r\nvar config = require('config')\r\n\r\nvar SheetRender = function (sheet) {\r\n\tthis.sheet=sheet\r\n}\r\n\r\nSheetRender.prototype.init = function (sheetDiv) {\r\n\r\n\tvar sheetTable = document.createElement('table')\r\n    sheetDiv.appendChild(sheetTable)\r\n\r\n\tsheetTable.style.width = this.sheet.width + 'px'\r\n\tsheetTable.style.height = this.sheet.height + 'px'\r\n\r\n\trenderSheet(this.sheet, sheetTable)\r\n}\r\n\r\n/**\r\n * 构建表格的数据模型\r\n * 一个二维数组\r\n *\r\n * 感觉这个应该放在controller里面\r\n * 但是先这样写\r\n * 你们不要改\r\n *\r\n * 表头存放表头显示的值\r\n * 其他为空，表示要放input\r\n *\r\n * @param rowNum\r\n * @param colNum\r\n */\r\nfunction createHeader(rowNum, colNum) {\r\n\tvar gridHeader =  []\r\n\tfor(var a=0;a<rowNum+1;a++){\r\n        gridHeader[a] = []\r\n\r\n\t\tfor(var b=0;b<colNum+1;b++){\r\n            gridHeader[a][b] = null\r\n\t\t}\r\n\t}\r\n\tvar startString = \"A\"\r\n\r\n\tfor(var i=1; i<colNum+1; i++){\r\n        gridHeader[0][i] = String.fromCharCode(startString.charCodeAt(0) + i - 1)\r\n\t}\r\n\r\n\tfor(var j=1; j<rowNum+1; j++){\r\n        gridHeader[j][0] = j\r\n\t}\r\n\r\n\treturn gridHeader\r\n}\r\n\r\nfunction renderSheet(sheet, sheetTable) {\r\n\tvar gridHeader = createHeader(sheet.rowNum,  sheet.colNum)\r\n\tvar cellHeight = config.CellConfig.height\r\n\tvar cellWidth = config.CellConfig.width\r\n\tvar\theadWidth = config.SheetConfig.headWidth\r\n\tvar\theadHeight = config.SheetConfig.headHeight\r\n\r\n\tvar rowNum = gridHeader.length\r\n\tvar colNum = gridHeader[0].length\r\n\r\n\r\n\tvar rowHead = document.createElement('tr')\r\n\tsheetTable.appendChild(rowHead)\r\n\r\n\tfor(var i=0;i<colNum;i++){\r\n\t\tvar rowHeadTH  = document.createElement('th')\r\n\t\trowHead.appendChild(rowHeadTH)\r\n\r\n\t\tvar rowHeadDiv = document.createElement('div')\r\n\t\trowHeadTH.appendChild(rowHeadDiv)\r\n\r\n\t\tif(i === 0){\r\n\t\t\trowHeadTH.style.width = headWidth + 'px'\r\n\t\t\trowHeadTH.style.height = headHeight + 'px'\r\n\t\t\trowHeadDiv.style.width = headWidth-2 + 'px'\r\n\t\t\trowHeadDiv.style.height = headHeight-2 + 'px'\r\n\t\t}else{\r\n\t\t\trowHeadTH.style.height = headHeight + 'px'\r\n\t\t\trowHeadTH.style.width = cellWidth + 'px'\r\n\t\t\trowHeadDiv.style.height = headHeight-2 + 'px'\r\n\t\t\trowHeadDiv.style.width = cellWidth-2 + 'px'\r\n\r\n\t\t\trowHeadDiv.innerHTML = gridHeader[0][i]\r\n\t\t}\r\n\r\n\t}\r\n\r\n    var SheetBindEventModule = require('SheetBindEvent')\r\n    var SheetBindEvent=SheetBindEventModule.SheetBindEvent\r\n    var sheetBindEvent=new SheetBindEvent(sheet)\r\n\r\n\r\n\tfor(var j = 1;j<rowNum;j++){\r\n\t\tvar rowTR = document.createElement('tr')\r\n\t\tsheetTable.appendChild(rowTR)\r\n\r\n\t\tfor(var k=0; k<colNum;k++){\r\n\t\t\tif(k === 0){\r\n\t\t\t\tvar rowTH = document.createElement('th')\r\n\t\t\t\trowTR.appendChild(rowTH)\r\n                rowTH.style.width = headWidth + 'px'\r\n                rowTH.style.height = cellHeight + 'px'\r\n\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n\t\t\t\trowTH.appendChild(rowDiv)\r\n                rowDiv.style.width = headWidth-2 + 'px'\r\n                rowDiv.style.height = cellHeight-2 + 'px'\r\n                rowDiv.innerHTML = gridHeader[j][k]\r\n\t\t\t}else {\r\n\t\t\t\tvar rowTD = document.createElement('td')\r\n                rowTR.appendChild(rowTD)\r\n                rowTD.style.width = cellWidth + 'px'\r\n                rowTD.style.height = cellHeight + 'px'\r\n                rowTD.style.display = 'table-cell'\r\n\r\n\t\t\t\tvar rowInput = document.createElement('input')\r\n                rowTD.appendChild(rowInput)\r\n                rowInput.id = gridHeader[0][k]+\"_\"+j\r\n                rowInput.style.width = cellWidth-2 + 'px'\r\n                rowInput.style.height = cellHeight-2 + 'px'\r\n                rowInput.style.position = 'absolute'\r\n                rowInput.style.color = 'transparent'\r\n                rowInput.style.backgroundColor = 'transparent'\r\n\r\n                sheetBindEvent.init(rowTD,rowInput)\r\n\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n                rowTD.appendChild(rowDiv)\r\n                rowDiv.style.width = cellWidth-2 + 'px'\r\n                rowDiv.style.height = cellHeight-2 + 'px'\r\n                rowDiv.style.textAlign = 'right'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nmodule.exports.SheetRender = SheetRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetRender.js\n// module id = 7\n// module chunks = 0","var configModule = require('config')\r\n\r\nvar ToolConfig = configModule.ToolConfig\r\n\r\nvar Tool = function () {\r\n    this.width = ToolConfig.width\r\n    this.height = ToolConfig.height\r\n}\r\n\r\nmodule.exports.Tool = Tool\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Tool.js\n// module id = 8\n// module chunks = 0","\r\n\r\nvar ToolRender=function(){\r\n\r\n}\r\nToolRender.prototype.init=function(toolDiv,width,height){\r\n    toolDiv.style.width = width + 'px'\r\n    toolDiv.style.height = height + 'px'\r\n    toolDiv.style.backgroundColor = '#aaaaaa'\r\n    //sheetToolDiv.innerHTML = \"&#xe900;&#xe901;&#xe14d;&#xe14e;&#xe14f;\"\r\n    var html = [\"&#xe900\",\"&#xe901\",\"&#xe14d\",\"&#xe14e\",\"&#xe14f\"]\r\n\r\n    html.forEach(function(innerhtml){\r\n        var buttonDiv = document.createElement('div')\r\n        buttonDiv.style.display = \"inline\"\r\n        buttonDiv.innerHTML=innerhtml\r\n\r\n        buttonDiv.onclick = function(){\r\n            // eventHandle.buttonClick(innerhtml)\r\n        }\r\n        toolDiv.appendChild(buttonDiv)\r\n    })\r\n}\r\nmodule.exports.ToolRender = ToolRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/ToolRender.js\n// module id = 9\n// module chunks = 0","/**\r\n * Created by cty on 17/6/12.\r\n */\r\n\r\n\r\nvar UndoStack = function () {\r\n\r\n    this.tos=-1\r\n    this.maxRedo=0\r\n    this.maxUndo=50\r\n    this.stack=[]\r\n\r\n}\r\nUndoStack.prototype.pushCommand = function(command,type){\r\n    var stack={\r\n        command : command,\r\n        type: type\r\n    }\r\n    this.stack.push(stack)\r\n    this.tos++\r\n}\r\nUndoStack.prototype.reDo = function(){\r\n\r\n}\r\nUndoStack.prototype.unDo = function(){\r\n\r\n}\r\nmodule.exports.UndoStack = UndoStack\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/UndoStack.js\n// module id = 10\n// module chunks = 0","var WSRender=function(wsManager,parentNode){\r\n    this.manager=wsManager\r\n    this.parNode=parentNode\r\n}\r\n\r\nWSRender.prototype.init=function () {\r\n    var ws=this.manager.workspace\r\n\r\n    //workspace\r\n    var WSDiv = document.createElement('div')\r\n    WSDiv.style.width = ws.width + 'px'\r\n    WSDiv.style.height = ws.height + 'px'\r\n    this.parNode.appendChild(WSDiv)\r\n\r\n    //tool\r\n    var ToolRenderModule = require('ToolRender')\r\n    var ToolRender = ToolRenderModule.ToolRender\r\n    var toolRender=new ToolRender()\r\n    var tool = ws.Tool\r\n    var toolDiv = document.createElement('div')\r\n    toolRender.init(toolDiv,tool.width,tool.height)\r\n    WSDiv.appendChild(toolDiv)\r\n\r\n    //sheet\r\n    var SheetRenderModule= require('SheetRender')\r\n    var SheetRender= SheetRenderModule.SheetRender\r\n    var sheetRender=new SheetRender(ws.Sheet)\r\n    var sheet=ws.Sheet\r\n    var sheetDiv=document.createElement('div')\r\n    sheetRender.init(sheetDiv)\r\n    WSDiv.appendChild(sheetDiv)\r\n}\r\nmodule.exports.WSRender = WSRender\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/WSRender.js\n// module id = 11\n// module chunks = 0","var config= require('config')\r\n\r\nvar Workspace = function (Tool, Sheet) {\r\n\r\n    this.width = config.WSConfig.width\r\n    this.height = config.WSConfig.height\r\n\r\n    this.Tool =Tool\r\n    this.Sheet= Sheet\r\n}\r\n\r\nmodule.exports.Workspace = Workspace\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Workspace.js\n// module id = 12\n// module chunks = 0"],"sourceRoot":""}