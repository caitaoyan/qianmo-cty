{"version":3,"sources":["webpack:///webpack/bootstrap 277222bfb00a5718b21a","webpack:///./config/config.js","webpack:///./component/Cell.js","webpack:///./component/Controller.js","webpack:///./app.js","webpack:///./component/EventHandle.js","webpack:///./component/Render.js","webpack:///./component/Sheet.js","webpack:///./component/SheetGrid.js","webpack:///./component/SheetTool.js","webpack:///./component/UndoStack.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACxIA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,0B;;;;;;AClBA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,sC;;;;;;AChCA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,2B;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D,yCAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qBAAqB;AAClE;AACA,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,wC;;;;;;ACnJA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAqC,QAAQ,QAAQ,QAAQ,QAAQ;AACrE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA,aAAa,YAAY;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,aAAa,SAAS;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,eAAe,SAAS;AACxB;AACA;;AAEA,cAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8B;;;;;;AClOA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,4B;;;;;;AClBA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,oC;;;;;;AC1BA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,oC;;;;;;ACbA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oC","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 277222bfb00a5718b21a","/**\r\n * 配置文件，主要是个各类属性默认值\r\n * 整张表命名为：sheet\r\n * 表格上半部分叫做：sheetTool\r\n * 表格叫做：sheetGrid\r\n *\r\n */\r\n\r\n/**\r\n * 整张表-Sheet的属性默认值\r\n *\r\n */\r\nvar SheetConfig = {\r\n\theight: 600,\r\n\twidth: 1030,\r\n\tisMouseDown:false,\r\n\tisKeyDown:true\r\n}\r\n\r\n/**\r\n * 表头-SheetTool的属性默认值\r\n *\r\n */\r\nvar SheetToolConfig = {\r\n\theight: 40,\r\n\twidth: SheetConfig.width\r\n}\r\n\r\n/**\r\n * 单元格-Cell属性默认值\r\n *\r\n */\r\nvar CellConfig = {\r\n\theight: 20,\r\n\twidth: 100\r\n}\r\n\r\n/**\r\n * 表单-SheetGrid的属性默认值\r\n *\r\n */\r\nvar SheetGridConfig = {\r\n\theight: SheetConfig.height - SheetToolConfig.height,\r\n\twidth: SheetConfig.width,\r\n\theadWidth: 30,\r\n\theadHeight: 25,\r\n\r\n\trowNum: (SheetConfig.height - SheetToolConfig.height-30)/CellConfig.height,\r\n\tcolNum: (SheetConfig.width-30)/CellConfig.width\r\n}\r\nvar keyboardTables = {\r\n\r\n\tspecialKeysCommon: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tspecialKeysIE: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysIE: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysOpera: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n\t\t45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n\t\t46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n\t\t113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysOpera: {\r\n\t\t67: \"[ctrl-c]\",\r\n\t\t83: \"[ctrl-s]\",\r\n\t\t86: \"[ctrl-v]\",\r\n\t\t88: \"[ctrl-x]\",\r\n\t\t90: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tspecialKeysSafari: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n\t\t63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n\t\t63277: \"[pgdn]\", 63237: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysSafari: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysSafari: {\r\n\t\t63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n\t\t63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n\t},\r\n\r\n\tspecialKeysFirefox: {\r\n\t\t8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n\t\t35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n\t\t46: \"[del]\", 113: \"[f2]\"\r\n\t},\r\n\r\n\tcontrolKeysFirefox: {\r\n\t\t99: \"[ctrl-c]\",\r\n\t\t115: \"[ctrl-s]\",\r\n\t\t118: \"[ctrl-v]\",\r\n\t\t120: \"[ctrl-x]\",\r\n\t\t122: \"[ctrl-z]\"\r\n\t},\r\n\r\n\tignoreKeysFirefox: {\r\n\t\t16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n\t\t91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n\t\t117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n\t\t144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n\t}\r\n}\r\n\r\n/**\r\n * 输出模块\r\n *\r\n */\r\nmodule.exports.SheetConfig = SheetConfig\r\nmodule.exports.SheetToolConfig = SheetToolConfig\r\nmodule.exports.SheetGridConfig = SheetGridConfig\r\nmodule.exports.CellConfig = CellConfig\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/config.js\n// module id = 0\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar cellConfig = configModule.CellConfig\r\n\r\nvar Cell = function (coord) {\r\n\r\n\t//成员属性\r\n\t//设置默认值\r\n\tthis.height = cellConfig.height\r\n\tthis.width = cellConfig.width\r\n\r\n\tthis.coord = coord\r\n}\r\n\r\nmodule.exports.Cell = Cell\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Cell.js\n// module id = 1\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\n\r\nvar Controller = function () {}\r\n\r\nController.prototype.init = function (parentNode) {\r\n\r\n\t//实例化初始化需要的对象\r\n\r\n\tvar sheetGridModule = require('SheetGrid')\r\n\tvar sheetToolModule = require('SheetTool')\r\n\tvar sheetModule = require('Sheet')\r\n\tvar renderModule = require('Render')\r\n\tvar undoStackModule = require('UndoStack')\r\n\r\n\tvar SheetGrid = sheetGridModule.SheetGrid\r\n\tvar SheetTool = sheetToolModule.SheetTool\r\n\tvar Sheet = sheetModule.Sheet\r\n\tvar Render = renderModule.Render\r\n\tvar UndoStack = undoStackModule.UndoStack\r\n\r\n\tthis.sheetGrid = new SheetGrid()\r\n\tthis.sheetTool = new SheetTool()\r\n\tthis.undoStack = new UndoStack()\r\n\tthis.sheet = new Sheet(this.sheetTool, this.sheetGrid,this.undoStack)\r\n\tthis.render = new Render()\r\n\r\n\tthis.render.renderSheet(this.sheet, parentNode)\r\n}\r\n\r\nmodule.exports.Controller = Controller\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Controller.js\n// module id = 2\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\nvar controllerModule = require('Controller')\r\nvar Controller = controllerModule.Controller\r\n\r\nvar parentNode = document.getElementById('QianMoApp')\r\n\r\nvar controller = new Controller()\r\ncontroller.init(parentNode)\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app.js\n// module id = 3\n// module chunks = 0","/**\r\n * Created by ASUS on 2017/6/8.\r\n */\r\n//\r\nvar config = require('config')\r\nvar CellModule = require('Cell')\r\nvar Cell=CellModule.Cell\r\nvar EventHandle = function () {\r\n    this.firstCell = null\r\n    this.lastCell = null\r\n}\r\n\r\nEventHandle.prototype.buttonClick = function(str){\r\n    alert(str)\r\n}\r\nEventHandle.prototype.mouseDown = function(element){\r\n    this.setCellBackgroundColor('transparent')\r\n    if(element.firstChild.id){\r\n        this.firstCell = element.firstChild\r\n        config.SheetConfig.isMouseDown=true\r\n    }\r\n}\r\nEventHandle.prototype.mouseMove = function(element){\r\n    this.setCellBackgroundColor('transparent')\r\n    if(element.firstChild.id){\r\n        this.lastCell=element.firstChild\r\n        this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\nEventHandle.prototype.mouseUp = function(element,sheet){\r\n    if(element.firstChild.id){\r\n        this.lastCell = element.firstChild\r\n        sheet.range=this.firstCell.id+':'+this.lastCell.id\r\n        this.setCellBackgroundColor('#69f')\r\n    }\r\n}\r\nEventHandle.prototype.setCellBackgroundColor=function(backgroundColor){\r\n    var cells=this.getColAndRow(this.firstCell,this.lastCell)\r\n    if(cells!=null) {\r\n        for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n            for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                var ele = document.getElementById(String.fromCharCode(i) + '_' + j)\r\n                ele.parentNode.style.backgroundColor = backgroundColor\r\n            }\r\n        }\r\n    }\r\n}\r\nEventHandle.prototype.getColAndRow=function(firstCell,lastCell){\r\n    var result=null\r\n    if(firstCell&&firstCell.id&&lastCell&&lastCell.id) {\r\n        result=new Object()\r\n        result.firstCellCol = firstCell.id.split('_')[0].charCodeAt(0)\r\n        result.firstCellRow = parseInt(firstCell.id.split('_')[1])\r\n        result.lastCellCol = lastCell.id.split('_')[0].charCodeAt(0)\r\n        result.lastCellRow = parseInt(lastCell.id.split('_')[1])\r\n        if( result.firstCellCol> result.lastCellCol){\r\n            var newFirstCellCol=result.firstCellCol\r\n            result.firstCellCol=result.lastCellCol\r\n            result.lastCellCol=newFirstCellCol\r\n        }\r\n        if( result.firstCellRow> result.lastCellRow){\r\n            var newFirstCellRow=result.firstCellRow\r\n            result.firstCellRow=result.lastCellRow\r\n            result.lastCellRow=newFirstCellRow\r\n        }\r\n\r\n    }\r\n    return result\r\n}\r\nEventHandle.prototype.keyDown = function(element,event,sheet){\r\n    var col=element.id.split('_')[0]\r\n    var row=element.id.split('_')[1]\r\n\r\n    switch (event.which) {\r\n        case 37://左键\r\n            col=String.fromCharCode(col.charCodeAt(0) - 1)\r\n            var cell = document.getElementById( col +'_'+ row )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 38://上键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)-1) )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 39://右键\r\n            col=String.fromCharCode(col.charCodeAt(0) + 1)\r\n            var cell = document.getElementById( col +'_'+ row)\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 40://下键\r\n            var cell = document.getElementById( col +'_'+ (parseInt(row)+1) )\r\n            if (cell) {cell.focus()}\r\n            break\r\n        case 17://ctrl\r\n            break\r\n        case 18://alt\r\n            break\r\n        case 67://ctrl+c\r\n             sheet.copiedfrom=sheet.range\r\n            var command = 'copy ' + sheet.copiedfrom + ' formulas'\r\n            var type = 'copy'\r\n            sheet.UndoStack.setStack(command,type)\r\n            break\r\n        case 86://ctrl+v\r\n            var firstCell=sheet.copiedfrom.split(':')[0]\r\n            var lastCell=sheet.copiedfrom.split(':')[1]\r\n            var cells=this.getColAndRow(document.getElementById(firstCell),\r\n                document.getElementById(lastCell))\r\n            if(cells!=null) {\r\n                var colCount=0\r\n                for(var i=cells.firstCellCol;i<=cells.lastCellCol;i++){\r\n                    var rowCount=0\r\n                    for(var j=cells.firstCellRow;j<=cells.lastCellRow;j++){\r\n                        var eleOld = document.getElementById(\r\n                            String.fromCharCode(i)\r\n                            + '_' + j)\r\n                        var eleNew = document.getElementById(\r\n                            String.fromCharCode(col.charCodeAt(0)+colCount)\r\n                            + '_' + (parseInt(row)+rowCount))\r\n                        if(eleNew){\r\n                            eleNew.nextSibling.innerHTML=eleOld.nextSibling.innerHTML\r\n                            var cell=new Cell()\r\n                            cell.value=eleOld.nextSibling.innerHTML\r\n                            sheet.SheetGrid.cells[eleNew.id]=cell\r\n                        }\r\n                        rowCount++\r\n\r\n                    }\r\n                    colCount++\r\n                }\r\n                var command = 'past ' + element.id + ' formulas'\r\n                var type = 'past'\r\n                sheet.UndoStack.setStack(command,type)\r\n            }\r\n            config.SheetConfig.isKeyDown=false\r\n            break\r\n        default:\r\n            var cell=new Cell()\r\n            cell.value=element.value\r\n            sheet.SheetGrid.cells[element.id]=cell\r\n            element.style.color='#111'\r\n            element.style.background='#efe'\r\n            break\r\n    }\r\n    console.log(sheet);\r\n}\r\n\r\n\r\nmodule.exports.EventHandle = EventHandle\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/EventHandle.js\n// module id = 4\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/5.\r\n */\r\n\r\n/**\r\n * SheetView Class\r\n *  负责\r\n *  @渲染表格\r\n *  @改变样式\r\n *\r\n *  总之，跟dom的直接交互，全由SheetView完成\r\n */\r\n\r\n/**\r\n * 这段代码还有很多地方需要重构\r\n * 包括各种样式\r\n * 希望不要动\r\n */\r\nvar config = require('config')\r\nvar EventHandleModule = require('EventHandle')\r\nvar EventHandle = EventHandleModule.EventHandle\r\nvar eventHandle = new EventHandle()\r\nvar CellModule = require('Cell')\r\nvar Cell=CellModule.Cell\r\n\r\nvar Render = function () {}\r\n\r\nRender.prototype.renderSheet = function (sheet, parentNode) {\r\n\tvar sheetDiv = document.createElement('div')\r\n\r\n\tsheetDiv.style.width = sheet.width + 'px'\r\n\tsheetDiv.style.height = sheet.height + 'px'\r\n\r\n\tparentNode.appendChild(sheetDiv)\r\n\r\n\tvar sheetTool = sheet.SheetTool\r\n\t// console.log(sheet)\r\n\tvar sheetToolDiv = document.createElement('div')\r\n\r\n\tsheetToolDiv.style.width = sheetTool.width + 'px'\r\n\tsheetToolDiv.style.height = sheetTool.height + 'px'\r\n\tsheetToolDiv.style.backgroundColor = '#aaaaaa'\r\n\t//sheetToolDiv.innerHTML = \"&#xe900;&#xe901;&#xe14d;&#xe14e;&#xe14f;\"\r\n    var html = [\"&#xe900\",\"&#xe901\",\"&#xe14d\",\"&#xe14e\",\"&#xe14f\"]\r\n\r\n\thtml.forEach(function(innerhtml){\r\n\t    var buttonDiv = document.createElement('div')\r\n\t\tbuttonDiv.style.display = \"inline\"\r\n        buttonDiv.innerHTML=innerhtml\r\n\r\n        buttonDiv.onclick = function(){\r\n            eventHandle.buttonClick(innerhtml)\r\n        }\r\n\t    sheetToolDiv.appendChild(buttonDiv)\r\n    })\r\n\r\n\r\n\tsheetDiv.appendChild(sheetToolDiv)\r\n\r\n\tvar sheetGrid = sheet.SheetGrid\r\n\tvar sheetGridTable = document.createElement('table')\r\n\tsheetDiv.appendChild(sheetGridTable)\r\n\tsheetGridTable.style.width = sheetGrid.width + 'px'\r\n\tsheetGridTable.style.height = sheetGrid.height + 'px'\r\n\r\n\tfillGrid(sheet, sheetGridTable)\r\n\r\n}\r\n\r\n/**\r\n * 构建表格的数据模型\r\n * 一个二维数组\r\n *\r\n * 感觉这个应该放在controller里面\r\n * 但是先这样写\r\n * 你们不要改\r\n *\r\n * 表头存放表头显示的值\r\n * 其他为空，表示要放input\r\n *\r\n * @param rowNum\r\n * @param colNum\r\n */\r\nfunction createModel(rowNum, colNum) {\r\n\tvar sheetGridModel =  []\r\n\tfor(var a=0;a<rowNum+1;a++){\r\n\t\tsheetGridModel[a] = []\r\n\r\n\t\tfor(var b=0;b<colNum+1;b++){\r\n\t\t\tsheetGridModel[a][b] = null\r\n\t\t}\r\n\t}\r\n\tvar startString = \"A\"\r\n\r\n\tfor(var i=1; i<colNum+1; i++){\r\n\t\tsheetGridModel[0][i] = String.fromCharCode(startString.charCodeAt(0) + i - 1)\r\n\t}\r\n\r\n\tfor(var j=1; j<rowNum+1; j++){\r\n\t\tsheetGridModel[j][0] = j\r\n\t}\r\n\r\n\treturn sheetGridModel\r\n}\r\n\r\nfunction fillGrid(sheet, sheetGridTable) {\r\n\tvar sheetGridModel = createModel(sheet.SheetGrid.rowNum,  sheet.SheetGrid.colNum)\r\n\tvar cellHeight = config.CellConfig.height\r\n\tvar cellWidth = config.CellConfig.width\r\n\tvar\theadWidth = config.SheetGridConfig.headWidth\r\n\tvar\theadHeight = config.SheetGridConfig.headHeight\r\n\r\n\tvar rowNum = sheetGridModel.length\r\n\tvar colNum = sheetGridModel[0].length\r\n\r\n\r\n\tvar rowHead = document.createElement('tr')\r\n\tsheetGridTable.appendChild(rowHead)\r\n\r\n\tfor(var i=0;i<colNum;i++){\r\n\t\tvar rowHeadTH  = document.createElement('th')\r\n\t\trowHead.appendChild(rowHeadTH)\r\n\r\n\t\tvar rowHeadDiv = document.createElement('div')\r\n\t\trowHeadTH.appendChild(rowHeadDiv)\r\n\r\n\t\tif(i === 0){\r\n\t\t\trowHeadTH.style.width = headWidth + 'px'\r\n\t\t\trowHeadTH.style.height = headHeight + 'px'\r\n\t\t\trowHeadDiv.style.width = headWidth-2 + 'px'\r\n\t\t\trowHeadDiv.style.height = headHeight-2 + 'px'\r\n\t\t}else{\r\n\t\t\trowHeadTH.style.height = headHeight + 'px'\r\n\t\t\trowHeadTH.style.width = cellWidth + 'px'\r\n\t\t\trowHeadDiv.style.height = headHeight-2 + 'px'\r\n\t\t\trowHeadDiv.style.width = cellWidth-2 + 'px'\r\n\r\n\t\t\trowHeadDiv.innerHTML = sheetGridModel[0][i]\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfor(var j = 1;j<rowNum;j++){\r\n\t\tvar rowTR = document.createElement('tr')\r\n\t\tsheetGridTable.appendChild(rowTR)\r\n\r\n\t\tfor(var k=0; k<colNum;k++){\r\n\t\t\tif(k === 0){\r\n\t\t\t\tvar rowTH = document.createElement('th')\r\n\t\t\t\trowTR.appendChild(rowTH)\r\n\t\t\t\tvar rowDiv = document.createElement('div')\r\n\t\t\t\trowTH.appendChild(rowDiv)\r\n\r\n\t\t\t\trowTH.style.width = headWidth + 'px'\r\n\t\t\t\trowTH.style.height = cellHeight + 'px'\r\n\t\t\t\trowDiv.style.width = headWidth-2 + 'px'\r\n\t\t\t\trowDiv.style.height = cellHeight-2 + 'px'\r\n\t\t\t\trowDiv.innerHTML = sheetGridModel[j][k]\r\n\t\t\t}else {\r\n\t\t\t\tvar rowTD = document.createElement('td')\r\n                rowTD.style.display = 'table-cell'\r\n\t\t\t\trowTR.appendChild(rowTD)\r\n\r\n\t\t\t\tvar rowInput = document.createElement('input')\r\n                rowInput.id = sheetGridModel[0][k]+\"_\"+j\r\n                rowInput.style.position = 'absolute'\r\n                rowInput.style.color = 'transparent'\r\n                rowInput.style.backgroundColor = 'transparent'\r\n\t\t\t\trowTD.onmousedown = function(){\r\n                    eventHandle.mouseDown(this)\r\n                }\r\n                window.onmousedown=function(){\r\n\t\t\t\t\teventHandle.setCellBackgroundColor('transparent')\r\n\t\t\t\t}\r\n\t\t\t\trowTD.onmouseup = function(){\r\n                    eventHandle.mouseUp(this,sheet)\r\n                }\r\n\t\t\t\twindow.onmouseup = function(){\r\n\t\t\t\t\tconfig.SheetConfig.isMouseDown=false\r\n\t\t\t\t}\r\n\t\t\t\trowTD.onmousemove = function(){\r\n\t\t\t\t\tif(config.SheetConfig.isMouseDown) {\r\n\t\t\t\t\t\teventHandle.mouseMove(this)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                rowInput.ondblclick = function () {\r\n                    this.style.color='#111'\r\n                    this.style.background='#efe'\r\n                }\r\n\t\t\t\trowInput.onfocus = function () {\r\n\t\t\t\t\tthis.parentNode.style.backgroundColor = '#69f'\r\n\t\t\t\t}\r\n                rowInput.onblur=function () {\r\n                    this.style.color='transparent'\r\n                    this.style.background='transparent'\r\n\t\t\t\t\tif(config.SheetConfig.isKeyDown){\r\n                    \tvar value=this.value\r\n                    \tif(this.nextSibling.innerHTML==''&&value!=''){\r\n                    \t\tvar command = 'set '+ this.id + ' ' + value\r\n\t\t\t\t\t\t\tvar type = 'set'\r\n\t\t\t\t\t\t\tsheet.UndoStack.setStack(command,type)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.nextSibling.innerHTML=value\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.parentNode.style.backgroundColor = 'transparent'\r\n                }\r\n\t\t\t\trowInput.onkeydown=function (event) {\r\n\t\t\t\t\teventHandle.keyDown(this,event,sheet)\r\n\t\t\t\t}\r\n                rowTD.appendChild(rowInput)\r\n\r\n                var rowDiv = document.createElement('div')\r\n                rowDiv.style.textAlign = 'right'\r\n                rowTD.appendChild(rowDiv)\r\n\r\n\t\t\t\trowTD.style.width = cellWidth + 'px'\r\n\t\t\t\trowTD.style.height = cellHeight + 'px'\r\n\t\t\t\trowInput.style.width = cellWidth-2 + 'px'\r\n\t\t\t\trowInput.style.height = cellHeight-2 + 'px'\r\n                rowDiv.style.width = cellWidth-2 + 'px'\r\n                rowDiv.style.height = cellHeight-2 + 'px'\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nmodule.exports.Render = Render\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Render.js\n// module id = 5\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar sheetConfig = configModule.SheetConfig\r\n\r\nvar Sheet = function (SheetTool, SheetGrid,UndoStack) {\r\n\r\n\tthis.width = sheetConfig.width\r\n\tthis.height = sheetConfig.height\r\n\r\n\tthis.SheetTool = SheetTool\r\n\tthis.SheetGrid = SheetGrid\r\n\tthis.UndoStack = UndoStack\r\n}\r\n\r\nmodule.exports.Sheet = Sheet\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/Sheet.js\n// module id = 6\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\n/**\r\n * 表格对象\r\n */\r\n\r\n\r\nvar configModule = require('config')\r\n\r\nvar sheetGridConfig = configModule.SheetGridConfig\r\n\r\nvar SheetGrid = function () {\r\n\tthis.height = sheetGridConfig.height\r\n\tthis.width = sheetGridConfig.width\r\n\r\n\tthis.headWidth = sheetGridConfig.headWidth\r\n\tthis.headHeight = sheetGridConfig.headHeight\r\n\r\n\tthis.rowNum = sheetGridConfig.rowNum\r\n\tthis.colNum = sheetGridConfig.colNum\r\n\r\n\tthis.cells = {}\r\n}\r\n\r\nmodule.exports.SheetGrid = SheetGrid\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetGrid.js\n// module id = 7\n// module chunks = 0","/**\r\n * Created by Ian on 17/6/7.\r\n */\r\n\r\nvar configModule = require('config')\r\n\r\nvar sheetToolConfig = configModule.SheetToolConfig\r\n\r\nvar SheetTool = function () {\r\n\tthis.width = sheetToolConfig.width\r\n\tthis.height = sheetToolConfig.height\r\n}\r\n\r\nmodule.exports.SheetTool = SheetTool\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/SheetTool.js\n// module id = 8\n// module chunks = 0","/**\r\n * Created by cty on 17/6/12.\r\n */\r\n\r\n\r\nvar UndoStack = function () {\r\n\r\n    this.tos=-1\r\n    this.maxRedo=0\r\n    this.maxUndo=50\r\n    this.stack=[]\r\n\r\n}\r\nUndoStack.prototype.setStack=function(command,type){\r\n    var stack={\r\n        command : command,\r\n        type: type\r\n    }\r\n    this.stack.push(stack)\r\n    this.tos++\r\n}\r\nUndoStack.prototype.reDo=function(){\r\n\r\n}\r\nUndoStack.prototype.unDo=function(){\r\n\r\n}\r\nmodule.exports.UndoStack = UndoStack\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./component/UndoStack.js\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}